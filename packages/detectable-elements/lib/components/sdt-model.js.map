{"version":3,"sources":["components/sdt-model.js"],"names":["SDTModel","color","attribute","type","String","reflect","distributions","Boolean","threshold","unequal","sensitivity","bias","variance","histogram","d","Number","c","s","far","hr","binWidth","trials","Array","width","height","rem","colors","signals","responses","NaN","muN","muS","l","hS","binRange","h","m","fa","cr","firstUpdate","drag","alignState","trialNumber","signal","duration","wait","iti","trial","new","paused","evidence","jStat","normal","sample","alignTrial","push","requestUpdate","trueEvidence","response","outcome","SDTMath","dc2far","dc2hr","d2muN","d2muS","c2l","s2h","i","length","html","SDTElement","svgFilters","dispatchEvent","CustomEvent","detail","bubbles","parseFloat","getComputedStyleValue","getComputedStyle","document","documentElement","getPropertyValue","window","addEventListener","getDimensions","bind","removeEventListener","changedProperties","setTimeout","isNaN","hostWidth","hostHeight","hostAspectRatio","elementAspectRatio","elementWidth","elementHeight","margin","top","bottom","left","right","transitionDuration","parseInt","xScale","d3","scaleLinear","domain","range","yScale","strokeWidth","y2Scale","dragThreshold","subject","x","y","on","datum","index","elements","element","select","classed","invert","event","l2c","sendEvent","dragNoise","muN2d","dragSignal","startX","startY","startHS","startMuS","interactive","sourceEvent","shiftKey","Math","abs","h2s","muS2d","line","e","p","svgUpdate","renderRoot","selectAll","data","svgEnter","enter","append","svgMerge","merge","attr","plotEnter","plotMerge","underlayerEnter","underlayerMerge","axisXMerge","call","axisBottom","text","axisYUpdate","axisYEnter","axisYMerge","axisLeft","ticks","exit","remove","titleYUpdate","titleYEnter","axisY2Update","axisY2Enter","axisY2Merge","axisRight","titleY2Update","titleY2Enter","contentMerge","signalNoiseUpdate","signalNoiseEnter","signalNoiseMerge","noiseEnter","noiseMerge","includes","key","preventDefault","has","transition","ease","easeCubicOut","attrTween","interpolateD","interpolate","undefined","interpolateC","interpolateS","time","correctRejections","map","pdf","falseAlarms","noise","signalEnter","signalMerge","misses","hits","dUpdate","dEnter","dLabel","dMerge","dLabelTransition","tween","toFixed","cUpdate","cEnter","cLabel","cMerge","cLabelTransition","sUpdate","sEnter","sLabel","sMerge","sLabelTransition","thresholdUpdate","thresholdEnter","thresholdMerge","histogramUpdate","histogramEnter","histogramMerge","value","thresholds","hist","binCountLeft","binCountRight","j","binValue","x0","binCount","trialUpdate","trialEnter","trialMerge","trialMergeNewActive","filter","empty","easeTime","scaleIn","scaleOutGenerator","easeFunction","floor","interpolator","interpolateRgb","getAttribute","easeCubicIn","removeAttribute","stimulus","nr","trialMergeNewPaused","easeLinear","overlayerEnter","overlayerMerge","trialNew","interrupt","css","customElements","define"],"mappings":"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","sourcesContent":["\nimport {html, css} from 'lit-element';\nimport * as d3 from 'd3';\nimport * as jStat from 'jstat';\n\nimport SDTMath from '@decidable/detectable-math';\n\nimport SDTElement from '../sdt-element';\n\n/*\n  SDTModel element\n  <sdt-model>\n\n  Attributes:\n    d'; C;\n    FAR; HR; zFAR; zHR;\n\n    draggable: d'; C;\n    highlight: H; M; CR; FA;\n\n    Styles:\n      ??\n*/\nexport default class SDTModel extends SDTElement {\n  static get properties() {\n    return {\n      color: {\n        attribute: 'color',\n        type: String,\n        reflect: true,\n      },\n      distributions: {\n        attribute: 'distributions',\n        type: Boolean,\n        reflect: true,\n      },\n      threshold: {\n        attribute: 'threshold',\n        type: Boolean,\n        reflect: true,\n      },\n      unequal: {\n        attribute: 'unequal',\n        type: Boolean,\n        reflect: true,\n      },\n      sensitivity: {\n        attribute: 'sensitivity',\n        type: Boolean,\n        reflect: true,\n      },\n      bias: {\n        attribute: 'bias',\n        type: Boolean,\n        reflect: true,\n      },\n      variance: {\n        attribute: 'variance',\n        type: Boolean,\n        reflect: true,\n      },\n      histogram: {\n        attribute: 'histogram',\n        type: Boolean,\n        reflect: true,\n      },\n      d: {\n        attribute: 'd',\n        type: Number,\n        reflect: true,\n      },\n      c: {\n        attribute: 'c',\n        type: Number,\n        reflect: true,\n      },\n      s: {\n        attribute: 's',\n        type: Number,\n        reflect: true,\n      },\n\n      far: {\n        attribute: false,\n        type: Number,\n        reflect: false,\n      },\n      hr: {\n        attribute: false,\n        type: Number,\n        reflect: false,\n      },\n      binWidth: {\n        attribute: false,\n        type: Number,\n        reflect: false,\n      },\n      trials: {\n        attribute: false,\n        type: Array,\n        reflect: false,\n      },\n\n      width: {\n        attribute: false,\n        type: Number,\n        reflect: false,\n      },\n      height: {\n        attribute: false,\n        type: Number,\n        reflect: false,\n      },\n      rem: {\n        attribute: false,\n        type: Number,\n        reflect: false,\n      },\n    };\n  }\n\n\n  constructor() {\n    super();\n\n    // Attributes\n    this.colors = ['outcome', 'response', 'stimulus', 'none']; // Allowable values of 'color'\n    this.color = 'outcome'; // How to color distributions and trials\n    this.distributions = false; // Show distributions?\n    this.threshold = false; // Show threshold?\n    this.unequal = false; // Allow unequal variance?\n    this.sensitivity = false; // Show d'?\n    this.bias = false; // Show c?\n    this.variance = false; // Show variance?\n    this.histogram = false; // Show histogram?\n\n    this.d = 1; // Sensitivity\n    this.c = 0; // Bias\n    this.s = 1; // Variance\n\n    // Properties\n    this.binWidth = 0.25; // Histogram bin width in units of evidence\n    this.signals = ['present', 'absent']; // Allowable values of trial.signal\n    this.responses = ['present', 'absent']; // Allowable values of trial.response\n    this.trials = []; // Array of simulated trials\n\n    this.width = NaN; // Width of component in pixels\n    this.height = NaN; // Height of component in pixels\n    this.rem = NaN; // Pixels per rem for component\n\n    // Private\n    this.muN = NaN; // Mean of noise distribution\n    this.muS = NaN; // Mean of signal distribution\n    this.l = NaN; // lambda (threshold location)\n    this.hS = NaN; // Height of signal distribution\n\n    this.binRange = [-3.0, 3.0]; // Range of histogram\n    this.h = 0; // Hits\n    this.m = 0; // Misses\n    this.fa = 0; // False alarms\n    this.cr = 0; // Correct rejections\n\n    this.firstUpdate = true; // Are we waiting for the first update?\n    this.drag = false; // Are we currently dragging?\n\n    this.alignState();\n  }\n\n  reset() {\n    this.trials = [];\n    this.h = 0;\n    this.m = 0;\n    this.fa = 0;\n    this.cr = 0;\n  }\n\n  trial(trialNumber, signal, duration, wait, iti) {\n    const trial = {};\n    trial.new = true;\n    trial.paused = false;\n    trial.trial = trialNumber;\n    trial.signal = signal;\n    trial.duration = duration;\n    trial.wait = wait;\n    trial.iti = iti;\n    trial.evidence = jStat.normal.sample(0, 1);\n\n    this.alignTrial(trial);\n\n    this.trials.push(trial);\n\n    this.requestUpdate();\n  }\n\n  alignTrial(trial) {\n    if (trial.signal === 'present') {\n      trial.trueEvidence = trial.evidence * this.s + this.muS;\n      trial.response = (trial.trueEvidence > this.l) ? 'present' : 'absent';\n      trial.outcome = (trial.response === 'present') ? 'h' : 'm';\n    } else { // trial.signal == 'absent'\n      trial.trueEvidence = trial.evidence + this.muN;\n      trial.response = (trial.trueEvidence > this.l) ? 'present' : 'absent';\n      trial.outcome = (trial.response === 'present') ? 'fa' : 'cr';\n    }\n    if (!trial.new) this[trial.outcome] += 1;\n    return trial;\n  }\n\n  alignState() {\n    this.far = SDTMath.dc2far(this.d, this.c, this.s);\n    this.hr = SDTMath.dc2hr(this.d, this.c, this.s);\n\n    this.muN = SDTMath.d2muN(this.d, this.s);\n    this.muS = SDTMath.d2muS(this.d, this.s);\n    this.l = SDTMath.c2l(this.c, this.s);\n    this.hS = SDTMath.s2h(this.s);\n\n    this.h = 0;\n    this.m = 0;\n    this.fa = 0;\n    this.cr = 0;\n    for (let i = 0; i < this.trials.length; i += 1) {\n      this.alignTrial(this.trials[i]);\n    }\n  }\n\n  static get styles() {\n    return [\n      super.styles,\n      css`\n        :host {\n          display: inline-block;\n        }\n\n        .main {\n          width: 100%;\n          height: 100%;\n        }\n\n        text {\n          /* stylelint-disable property-no-vendor-prefix */\n          -webkit-user-select: none;\n          -moz-user-select: none;\n          -ms-user-select: none;\n          user-select: none;\n        }\n\n        .tick {\n          font-size: 0.75rem;\n        }\n\n        .axis-x path,\n        .axis-x line,\n        .axis-y path,\n        .axis-y line,\n        .axis-y2 path,\n        .axis-y2 line {\n          stroke: var(---color-element-border);\n        }\n\n        .noise.interactive,\n        .signal.interactive,\n        .threshold.interactive {\n          cursor: ew-resize;\n\n          filter: url(\"#shadow-2\");\n          outline: none;\n        }\n\n        .signal.unequal {\n          cursor: ns-resize;\n\n          filter: url(\"#shadow-2\");\n          outline: none;\n        }\n\n        .signal.interactive.unequal {\n          cursor: move;\n        }\n\n        .noise.interactive:hover,\n        .signal.interactive:hover,\n        .signal.unequal:hover,\n        .threshold.interactive:hover {\n          filter: url(\"#shadow-4\");\n\n          /* HACK: This gets Safari to correctly apply the filter! */\n          transform: translateX(0);\n        }\n\n        .noise.interactive:hover,\n        .signal.interactive:hover,\n        .signal.unequal:hover,\n        .threshold.interactive:active {\n          filter: url(\"#shadow-8\");\n\n          /* HACK: This gets Safari to correctly apply the filter! */\n          transform: translateY(0);\n        }\n\n        :host(.keyboard) .noise.interactive:focus,\n        :host(.keyboard) .signal.interactive:focus,\n        :host(.keyboard) .signal.unequal:focus,\n        :host(.keyboard) .threshold.interactive:focus {\n          filter: url(\"#shadow-8\");\n\n          /* HACK: This gets Safari to correctly apply the filter! */\n          transform: translateZ(0);\n        }\n\n        .underlayer .background {\n          fill: var(---color-element-background);\n          stroke: none;\n        }\n\n        .overlayer .background {\n          fill: none;\n          stroke: var(---color-element-border);\n          stroke-width: 1;\n          shape-rendering: crispEdges;\n        }\n\n        .title-x,\n        .title-y,\n        .title-y2 {\n          font-weight: 600;\n\n          fill: currentColor;\n        }\n\n        .curve-cr,\n        .curve-fa,\n        .curve-m,\n        .curve-h {\n          fill-opacity: 0.5;\n          stroke: none;\n\n          transition: fill var(---transition-duration) ease;\n        }\n\n        .curve-cr {\n          fill: var(---color-cr);\n        }\n\n        .curve-fa {\n          fill: var(---color-fa);\n        }\n\n        .curve-m {\n          fill: var(---color-m);\n        }\n\n        .curve-h {\n          fill: var(---color-h);\n        }\n\n        :host([color=\"accuracy\"]) .curve-h,\n        :host([color=\"accuracy\"]) .curve-cr {\n          fill: var(---color-correct);\n        }\n\n        :host([color=\"accuracy\"]) .curve-m,\n        :host([color=\"accuracy\"]) .curve-fa {\n          fill: var(---color-error);\n        }\n\n        :host([color=\"stimulus\"]) .curve-cr,\n        :host([color=\"stimulus\"]) .curve-fa {\n          fill: var(---color-far);\n        }\n\n        :host([color=\"stimulus\"]) .curve-m,\n        :host([color=\"stimulus\"]) .curve-h {\n          fill: var(---color-hr);\n        }\n\n        :host([color=\"response\"]) .curve-cr,\n        :host([color=\"response\"]) .curve-m {\n          fill: var(---color-absent);\n        }\n\n        :host([color=\"response\"]) .curve-fa,\n        :host([color=\"response\"]) .curve-h {\n          fill: var(---color-present);\n        }\n\n        :host([color=\"none\"]) .curve-cr,\n        :host([color=\"none\"]) .curve-fa,\n        :host([color=\"none\"]) .curve-m,\n        :host([color=\"none\"]) .curve-h {\n          fill: var(---color-element-enabled);\n        }\n\n        .curve-noise,\n        .curve-signal {\n          fill: none;\n          stroke: var(---color-element-emphasis);\n          stroke-width: 2;\n        }\n\n        .measure-d,\n        .measure-c,\n        .measure-s {\n          pointer-events: none;\n        }\n\n        .threshold .line {\n          stroke: var(---color-element-emphasis);\n          stroke-width: 2;\n        }\n\n        .threshold .handle {\n          fill: var(---color-element-emphasis);\n\n          /* r: 6; HACK: Firefox does not support CSS SVG Geometry Properties */\n        }\n\n        /* Make a larger target for touch users */\n        @media (pointer: coarse) {\n          .threshold.interactive .handle {\n            stroke: #000000;\n            stroke-opacity: 0;\n            stroke-width: 12px;\n          }\n        }\n\n        .measure-d .line,\n        .measure-d .cap-left,\n        .measure-d .cap-right {\n          stroke: var(---color-d);\n          stroke-width: 2;\n          shape-rendering: crispEdges;\n        }\n\n        .measure-d .label {\n          font-size: 0.75rem;\n\n          text-anchor: start;\n          fill: currentColor;\n        }\n\n        .measure-c .line,\n        .measure-c .cap-zero {\n          stroke: var(---color-c);\n          stroke-width: 2;\n          shape-rendering: crispEdges;\n        }\n\n        .measure-c .label {\n          font-size: 0.75rem;\n\n          fill: currentColor;\n        }\n\n        .measure-s .line,\n        .measure-s .cap-left,\n        .measure-s .cap-right {\n          stroke: var(---color-s);\n          stroke-width: 2;\n          shape-rendering: crispEdges;\n        }\n\n        .measure-s .label {\n          font-size: 0.75rem;\n\n          text-anchor: middle;\n          fill: currentColor;\n        }\n      `,\n    ];\n  }\n\n  render() { // eslint-disable-line class-methods-use-this\n    return html`\n      ${SDTElement.svgFilters}\n    `;\n  }\n\n  sendEvent() {\n    this.dispatchEvent(new CustomEvent('sdt-model-change', {\n      detail: {\n        d: this.d,\n        c: this.c,\n        s: this.s,\n        far: this.far,\n        hr: this.hr,\n        h: this.h,\n        m: this.m,\n        fa: this.fa,\n        cr: this.cr,\n      },\n      bubbles: true,\n    }));\n  }\n\n  getDimensions() {\n    this.width = parseFloat(this.getComputedStyleValue('width'), 10);\n    this.height = parseFloat(this.getComputedStyleValue('height'), 10);\n    this.rem = parseFloat(getComputedStyle(document.documentElement).getPropertyValue('font-size'), 10);\n    // console.log(`sdt-model: width = ${this.width}, height = ${this.height}, rem = ${this.rem}`);\n  }\n\n  connectedCallback() {\n    super.connectedCallback();\n    window.addEventListener('resize', this.getDimensions.bind(this));\n  }\n\n  disconnectedCallback() {\n    window.removeEventListener('resize', this.getDimensions.bind(this));\n    super.disconnectedCallback();\n  }\n\n  firstUpdated(changedProperties) {\n    super.firstUpdated(changedProperties);\n\n    // Get the width and height after initial render/update has occurred\n    // HACK Edge: Edge doesn't have width/height until after a 0ms timeout\n    window.setTimeout(this.getDimensions.bind(this), 0);\n  }\n\n  update(changedProperties) {\n    super.update(changedProperties);\n\n    this.alignState();\n\n    // Bail out if we can't get the width/height\n    if (Number.isNaN(this.width) || Number.isNaN(this.height) || Number.isNaN(this.rem)) {\n      return;\n    }\n\n    const hostWidth = this.width;\n    const hostHeight = this.height;\n    const hostAspectRatio = hostWidth / hostHeight;\n\n    const elementAspectRatio = 1.8;\n    let elementWidth;\n    let elementHeight;\n\n    if (hostAspectRatio > elementAspectRatio) {\n      elementHeight = hostHeight;\n      elementWidth = elementHeight * elementAspectRatio;\n    } else {\n      elementWidth = hostWidth;\n      elementHeight = elementWidth / elementAspectRatio;\n    }\n\n    const margin = {\n      top: 2 * this.rem,\n      bottom: 3 * this.rem,\n      left: 3 * this.rem,\n      right: ((this.histogram && this.distributions) ? 3 : 0.75) * this.rem,\n    };\n    const height = elementHeight - (margin.top + margin.bottom);\n    const width = elementWidth - (margin.left + margin.right);\n\n    const transitionDuration = parseInt(this.getComputedStyleValue('---transition-duration'), 10);\n\n    // X Scale\n    const xScale = d3.scaleLinear()\n      .domain([-3, 3]) // Evidence // FIX - no hardcoding\n      .range([0, width]);\n\n    // Y Scale\n    const yScale = d3.scaleLinear()\n      .domain([0.5, 0]) // Probability // FIX - no hardcoding\n      .range([0, height]);\n\n    // 2nd Y Scale\n    const strokeWidth = 3; // FIX - no hardcoding\n    const binWidth = xScale(this.binWidth) - xScale(0);\n    const y2Scale = d3.scaleLinear()\n      .domain([height / binWidth, 0]) // Number of Stimuli\n      .range([0, height]);\n\n    // Threshold Drag behavior\n    const dragThreshold = d3.drag()\n      .subject((/* datum */) => {\n        return {x: xScale(this.l), y: 0};\n      })\n      .on('start', (datum, index, elements) => {\n        const element = elements[index];\n        d3.select(element).classed('dragging', true);\n      })\n      .on('drag', (/* datum */) => {\n        this.drag = true;\n        let l = xScale.invert(d3.event.x);\n        // Clamp lambda to stay visible\n        l = (l < xScale.domain()[0])\n          ? xScale.domain()[0]\n          : (l > xScale.domain()[1])\n            ? xScale.domain()[1]\n            : l;\n        this.c = SDTMath.l2c(l, this.s);\n        this.alignState();\n        this.sendEvent();\n      })\n      .on('end', (datum, index, elements) => {\n        const element = elements[index];\n        d3.select(element).classed('dragging', false);\n      });\n\n    // Noise Curve Drag behavior\n    const dragNoise = d3.drag()\n      .subject((/* datum */) => {\n        return {x: xScale(this.muN), y: 0};\n      })\n      .on('start', (datum, index, elements) => {\n        const element = elements[index];\n        d3.select(element).classed('dragging', true);\n      })\n      .on('drag', (/* datum */) => {\n        this.drag = true;\n        let muN = xScale.invert(d3.event.x);\n        // Clamp Noise Curve to stay visible\n        muN = (muN < xScale.domain()[0])\n          ? xScale.domain()[0]\n          : (muN > xScale.domain()[1])\n            ? xScale.domain()[1]\n            : muN;\n        this.d = SDTMath.muN2d(muN, this.s);\n        this.alignState();\n        this.sendEvent();\n      })\n      .on('end', (datum, index, elements) => {\n        const element = elements[index];\n        d3.select(element).classed('dragging', false);\n      });\n\n    // Signal+Noise Curve Drag behavior\n    const dragSignal = d3.drag()\n      .subject((/* datum */) => {\n        return {x: xScale(this.muS), y: yScale(this.hS)};\n      })\n      .on('start', (datum, index, elements) => {\n        const element = elements[index];\n        d3.select(element).classed('dragging', true);\n        datum.startX = d3.event.x;\n        datum.startY = d3.event.y;\n        datum.startHS = this.hS;\n        datum.startMuS = this.muS;\n      })\n      .on('drag', (datum) => {\n        this.drag = true;\n        let muS = this.muS; // eslint-disable-line prefer-destructuring\n        if (this.interactive) {\n          muS = xScale.invert(d3.event.x);\n          // Clamp Signal Curve to stay visible\n          muS = (muS < xScale.domain()[0])\n            ? xScale.domain()[0]\n            : (muS > xScale.domain()[1])\n              ? xScale.domain()[1]\n              : muS;\n        }\n        let hS = this.hS; // eslint-disable-line prefer-destructuring\n        if (this.unequal) {\n          hS = yScale.invert(d3.event.y);\n          // Clamp Signal Curve to stay visible\n          hS = (hS < 0.01)\n            ? 0.01\n            : (hS > yScale.domain()[0])\n              ? yScale.domain()[0]\n              : hS;\n        }\n        if (this.interactive && this.unequal) {\n          // Use shift key as modifier for single dimension\n          if (d3.event.sourceEvent.shiftKey) {\n            if (Math.abs(d3.event.x - datum.startX) > Math.abs(d3.event.y - datum.startY)) {\n              hS = datum.startHS;\n            } else {\n              muS = datum.startMuS;\n            }\n          }\n        }\n        if (this.unequal) {\n          this.s = SDTMath.h2s(hS);\n          this.c = SDTMath.l2c(this.l, this.s);\n        }\n        this.d = SDTMath.muS2d(muS, this.s);\n        this.alignState();\n        this.sendEvent();\n      })\n      .on('end', (datum, index, elements) => {\n        const element = elements[index];\n        d3.select(element).classed('dragging', false);\n      });\n\n    // Line for Evidence/Probability Space\n    const line = d3.line()\n      .x((datum) => { return xScale(datum.e); })\n      .y((datum) => { return yScale(datum.p); });\n\n    // Svg\n    //  DATA-JOIN\n    const svgUpdate = d3.select(this.renderRoot).selectAll('.main')\n      .data([{\n        width: this.width,\n        height: this.height,\n        rem: this.rem,\n      }]);\n    // ENTER\n    const svgEnter = svgUpdate.enter().append('svg')\n      .classed('main', true);\n    // MERGE\n    const svgMerge = svgEnter.merge(svgUpdate)\n      .attr('viewBox', `0 0 ${elementWidth} ${elementHeight}`);\n\n    // Plot\n    //  ENTER\n    const plotEnter = svgEnter.append('g')\n      .classed('plot', true);\n    //  MERGE\n    const plotMerge = svgMerge.select('.plot')\n      .attr('transform', `translate(${margin.left}, ${margin.top})`);\n\n    // Underlayer\n    //  ENTER\n    const underlayerEnter = plotEnter.append('g')\n      .classed('underlayer', true);\n    // MERGE\n    const underlayerMerge = plotMerge.select('.underlayer');\n\n    // Background\n    //  ENTER\n    underlayerEnter.append('rect')\n      .classed('background', true);\n    //  MERGE\n    underlayerMerge.select('.background')\n      .attr('height', height)\n      .attr('width', width);\n\n    // X Axis\n    //  ENTER\n    underlayerEnter.append('g')\n      .classed('axis-x', true);\n    //  MERGE\n    const axisXMerge = underlayerMerge.select('.axis-x')\n      .attr('transform', `translate(0, ${height})`)\n      .call(d3.axisBottom(xScale))\n      .attr('font-size', null)\n      .attr('font-family', null);\n    axisXMerge.selectAll('line, path')\n      .attr('stroke', null);\n\n    // X Axis Title\n    //  ENTER\n    underlayerEnter.append('text')\n      .classed('title-x', true)\n      .attr('text-anchor', 'middle')\n      .text('Evidence');\n    //  MERGE\n    underlayerMerge.select('.title-x')\n      .attr('transform', `translate(${width / 2}, ${height + (2.25 * this.rem)})`);\n\n    // Y Axis\n    //  DATA-JOIN\n    const axisYUpdate = underlayerMerge.selectAll('.axis-y')\n      .data(this.distributions ? [{}] : []);\n    //  ENTER\n    const axisYEnter = axisYUpdate.enter().append('g')\n      .classed('axis-y', true);\n    //  MERGE\n    const axisYMerge = axisYEnter.merge(axisYUpdate)\n      .call(d3.axisLeft(yScale).ticks(5))\n      .attr('font-size', null)\n      .attr('font-family', null);\n    axisYMerge.selectAll('line, path')\n      .attr('stroke', null);\n    //  EXIT\n    axisYUpdate.exit().remove();\n\n    // Y Axis Title\n    //  DATA-JOIN\n    const titleYUpdate = underlayerMerge.selectAll('.title-y')\n      .data(this.distributions ? [{}] : []);\n    //  ENTER\n    const titleYEnter = titleYUpdate.enter().append('text')\n      .classed('title-y', true)\n      .attr('text-anchor', 'middle')\n      .text('Probability');\n    //  MERGE\n    titleYEnter.merge(titleYUpdate)\n      .attr('transform', `translate(${-2 * this.rem}, ${height / 2})rotate(-90)`);\n    //  EXIT\n    titleYUpdate.exit().remove();\n\n    // 2nd Y Axis\n    //  DATA-JOIN\n    const axisY2Update = underlayerMerge.selectAll('.axis-y2')\n      .data(this.histogram ? [{}] : []);\n    //  ENTER\n    const axisY2Enter = axisY2Update.enter().append('g')\n      .classed('axis-y2', true);\n    //  MERGE\n    const axisY2Merge = axisY2Enter.merge(axisY2Update)\n      .attr('transform', this.distributions ? `translate(${width}, 0)` : '')\n      .call(this.distributions ? d3.axisRight(y2Scale).ticks(10) : d3.axisLeft(y2Scale).ticks(10))\n      .attr('font-size', null)\n      .attr('font-family', null);\n    axisY2Merge.selectAll('line, path')\n      .attr('stroke', null);\n    //  EXIT\n    axisY2Update.exit().remove();\n\n    // 2nd Y Axis Title\n    //  DATA-JOIN\n    const titleY2Update = underlayerMerge.selectAll('.title-y2')\n      .data(this.histogram ? [{}] : []);\n    //  ENTER\n    const titleY2Enter = titleY2Update.enter().append('text')\n      .classed('title-y2', true)\n      .attr('text-anchor', 'middle')\n      .text('Count');\n    //  MERGE\n    titleY2Enter.merge(titleY2Update)\n      .attr('transform', this.distributions\n        ? `translate(${width + (1.5 * this.rem)}, ${height / 2})rotate(90)`\n        : `translate(${-1.5 * this.rem}, ${height / 2})rotate(-90)`);\n    //  EXIT\n    titleY2Update.exit().remove();\n\n    // Plot Content\n    plotEnter.append('g')\n      .classed('content', true);\n    //  MERGE\n    const contentMerge = plotMerge.select('.content');\n\n    // Noise & Signal + Noise Distributions\n    //  DATA-JOIN\n    const signalNoiseUpdate = contentMerge.selectAll('.signal-noise')\n      .data(this.distributions ? [{}] : []);\n    //  ENTER\n    const signalNoiseEnter = signalNoiseUpdate.enter().append('g')\n      .classed('signal-noise', true);\n    //  MERGE\n    const signalNoiseMerge = signalNoiseEnter.merge(signalNoiseUpdate);\n    //  EXIT\n    signalNoiseUpdate.exit().remove();\n\n    // Noise Distribution\n    //  ENTER\n    const noiseEnter = signalNoiseEnter.append('g')\n      .classed('noise', true);\n    //  MERGE\n    const noiseMerge = signalNoiseMerge.selectAll('.noise')\n      .attr('tabindex', this.interactive ? 0 : null)\n      .classed('interactive', this.interactive)\n      .on('keydown', this.interactive\n        ? (/* datum */) => {\n          if (['ArrowRight', 'ArrowLeft'].includes(d3.event.key)) {\n            let muN = this.muN; // eslint-disable-line prefer-destructuring\n            switch (d3.event.key) {\n              case 'ArrowRight':\n                muN += d3.event.shiftKey ? 0.01 : 0.1;\n                break;\n              case 'ArrowLeft':\n                muN -= d3.event.shiftKey ? 0.01 : 0.1;\n                break;\n              default:\n            }\n            // Clamp C to visible extent\n            muN = (muN < xScale.domain()[0])\n              ? xScale.domain()[0]\n              : (muN > xScale.domain()[1])\n                ? xScale.domain()[1]\n                : muN;\n            if (muN !== this.muN) {\n              this.d = SDTMath.muN2d(muN, this.s);\n              this.alignState();\n              this.sendEvent();\n            }\n            d3.event.preventDefault();\n          }\n        }\n        : null);\n    if (\n      this.firstUpdate\n      || changedProperties.has('interactive')\n    ) {\n      if (this.interactive) {\n        noiseMerge.call(dragNoise);\n      } else {\n        noiseMerge.on('.drag', null);\n      }\n    }\n\n    // CR Curve\n    //  ENTER\n    noiseEnter.append('path')\n      .classed('curve-cr', true);\n    //  MERGE\n    noiseMerge.select('.curve-cr').transition()\n      .duration(this.drag ? 0 : transitionDuration)\n      .ease(d3.easeCubicOut)\n      .attrTween('d', (datum, index, elements) => {\n        const element = elements[index];\n        const interpolateD = d3.interpolate(\n          (element.d !== undefined) ? element.d : this.d,\n          this.d,\n        );\n        const interpolateC = d3.interpolate(\n          (element.c !== undefined) ? element.c : this.c,\n          this.c,\n        );\n        const interpolateS = d3.interpolate(\n          (element.s !== undefined) ? element.s : this.s,\n          this.s,\n        );\n        return (time) => {\n          element.d = interpolateD(time);\n          element.c = interpolateC(time);\n          element.s = interpolateS(time);\n          const correctRejections = d3.range(\n            xScale.domain()[0],\n            SDTMath.c2l(element.c, element.s),\n            0.05,\n          ).map((e) => {\n            return {\n              e: e,\n              p: jStat.normal.pdf(e, SDTMath.d2muN(element.d, element.s), 1),\n            };\n          });\n          correctRejections.push({\n            e: SDTMath.c2l(element.c, element.s),\n            p: jStat.normal.pdf(\n              SDTMath.c2l(element.c, element.s),\n              SDTMath.d2muN(element.d, element.s),\n              1,\n            ),\n          });\n          correctRejections.push({\n            e: SDTMath.c2l(element.c, element.s),\n            p: 0,\n          });\n          correctRejections.push({\n            e: xScale.domain()[0],\n            p: 0,\n          });\n          return line(correctRejections);\n        };\n      });\n\n    // FA Curve\n    //  ENTER\n    noiseEnter.append('path')\n      .classed('curve-fa', true);\n    //  MERGE\n    noiseMerge.select('.curve-fa').transition()\n      .duration(this.drag ? 0 : transitionDuration)\n      .ease(d3.easeCubicOut)\n      .attrTween('d', (datum, index, elements) => {\n        const element = elements[index];\n        const interpolateD = d3.interpolate(\n          (element.d !== undefined) ? element.d : this.d,\n          this.d,\n        );\n        const interpolateC = d3.interpolate(\n          (element.c !== undefined) ? element.c : this.c,\n          this.c,\n        );\n        const interpolateS = d3.interpolate(\n          (element.s !== undefined) ? element.s : this.s,\n          this.s,\n        );\n        return (time) => {\n          element.d = interpolateD(time);\n          element.c = interpolateC(time);\n          element.s = interpolateS(time);\n          const falseAlarms = d3.range(\n            SDTMath.c2l(element.c, element.s),\n            xScale.domain()[1],\n            0.05,\n          ).map((e) => {\n            return {\n              e: e,\n              p: jStat.normal.pdf(e, SDTMath.d2muN(element.d, element.s), 1),\n            };\n          });\n          falseAlarms.push({\n            e: xScale.domain()[1],\n            p: jStat.normal.pdf(xScale.domain()[1], SDTMath.d2muN(element.d, element.s), 1),\n          });\n          falseAlarms.push({\n            e: xScale.domain()[1],\n            p: 0,\n          });\n          falseAlarms.push({\n            e: SDTMath.c2l(element.c, element.s),\n            p: 0,\n          });\n          return line(falseAlarms);\n        };\n      });\n\n    // Noise Curve\n    //  ENTER\n    noiseEnter.append('path')\n      .classed('curve-noise', true);\n    //  MERGE\n    noiseMerge.select('.curve-noise').transition()\n      .duration(this.drag ? 0 : transitionDuration)\n      .ease(d3.easeCubicOut)\n      .attrTween('d', (datum, index, elements) => {\n        const element = elements[index];\n        const interpolateD = d3.interpolate(\n          (element.d !== undefined) ? element.d : this.d,\n          this.d,\n        );\n        const interpolateS = d3.interpolate(\n          (element.s !== undefined) ? element.s : this.s,\n          this.s,\n        );\n        return (time) => {\n          element.d = interpolateD(time);\n          element.s = interpolateS(time);\n          const noise = d3.range(\n            xScale.domain()[0],\n            xScale.domain()[1],\n            0.05,\n          ).map((e) => {\n            return {\n              e: e,\n              p: jStat.normal.pdf(e, SDTMath.d2muN(element.d, element.s), 1),\n            };\n          });\n          noise.push({\n            e: xScale.domain()[1],\n            p: jStat.normal.pdf(xScale.domain()[1], SDTMath.d2muN(element.d, element.s), 1),\n          });\n          return line(noise);\n        };\n      });\n\n    // Signal + Noise Distribution\n    //  ENTER\n    const signalEnter = signalNoiseEnter.append('g')\n      .classed('signal', true);\n    //  MERGE\n    const signalMerge = signalNoiseMerge.selectAll('.signal')\n      .attr('tabindex', (this.interactive || this.unequal) ? 0 : null)\n      .classed('interactive', this.interactive)\n      .classed('unequal', this.unequal)\n      .on('keydown.sensitivity', this.interactive\n        ? (/* datum */) => {\n          if (['ArrowRight', 'ArrowLeft'].includes(d3.event.key)) {\n            let muS = this.muS; // eslint-disable-line prefer-destructuring\n            switch (d3.event.key) {\n              case 'ArrowRight':\n                muS += d3.event.shiftKey ? 0.01 : 0.1;\n                break;\n              case 'ArrowLeft':\n                muS -= d3.event.shiftKey ? 0.01 : 0.1;\n                break;\n              default:\n            }\n            // Clamp C to visible extent\n            muS = (muS < xScale.domain()[0])\n              ? xScale.domain()[0]\n              : (muS > xScale.domain()[1])\n                ? xScale.domain()[1]\n                : muS;\n            if (muS !== this.muS) {\n              this.d = SDTMath.muS2d(muS, this.s);\n              this.alignState();\n              this.sendEvent();\n            }\n            d3.event.preventDefault();\n          }\n        }\n        : null)\n      .on('keydown.variance', this.unequal\n        ? (/* datum */) => {\n          if (['ArrowUp', 'ArrowDown'].includes(d3.event.key)) {\n            let hS = this.hS; // eslint-disable-line prefer-destructuring\n            switch (d3.event.key) {\n              case 'ArrowUp':\n                hS += d3.event.shiftKey ? 0.002 : 0.02;\n                break;\n              case 'ArrowDown':\n                hS -= d3.event.shiftKey ? 0.002 : 0.02;\n                break;\n              default:\n            }\n            // Clamp s so distribution stays visible\n            hS = (hS < 0.01)\n              ? 0.01\n              : (hS > yScale.domain()[0])\n                ? yScale.domain()[0]\n                : hS;\n            if (hS !== this.hS) {\n              this.s = SDTMath.h2s(hS);\n              this.d = SDTMath.muN2d(this.muN, this.s);\n              this.c = SDTMath.l2c(this.l, this.s);\n              this.alignState();\n              this.sendEvent();\n            }\n            d3.event.preventDefault();\n          }\n        }\n        : null);\n    if (\n      this.firstUpdate\n      || changedProperties.has('interactive')\n      || changedProperties.has('unequal')\n    ) {\n      if (this.interactive || this.unequal) {\n        signalMerge.call(dragSignal);\n      } else {\n        signalMerge.on('.drag', null);\n      }\n    }\n\n    // M Curve\n    //  ENTER\n    signalEnter.append('path')\n      .classed('curve-m', true);\n    //  MERGE\n    signalMerge.select('.curve-m').transition()\n      .duration(this.drag ? 0 : transitionDuration)\n      .ease(d3.easeCubicOut)\n      .attrTween('d', (datum, index, elements) => {\n        const element = elements[index];\n        const interpolateD = d3.interpolate(\n          (element.d !== undefined) ? element.d : this.d,\n          this.d,\n        );\n        const interpolateC = d3.interpolate(\n          (element.c !== undefined) ? element.c : this.c,\n          this.c,\n        );\n        const interpolateS = d3.interpolate(\n          (element.s !== undefined) ? element.s : this.s,\n          this.s,\n        );\n        return (time) => {\n          element.d = interpolateD(time);\n          element.c = interpolateC(time);\n          element.s = interpolateS(time);\n          const misses = d3.range(\n            xScale.domain()[0],\n            SDTMath.c2l(element.c, element.s),\n            0.05,\n          ).map((e) => {\n            return {\n              e: e,\n              p: jStat.normal.pdf(e, SDTMath.d2muS(element.d, element.s), element.s),\n            };\n          });\n          misses.push({\n            e: SDTMath.c2l(element.c, element.s),\n            p: jStat.normal.pdf(\n              SDTMath.c2l(element.c, element.s),\n              SDTMath.d2muS(element.d, element.s),\n              element.s,\n            ),\n          });\n          misses.push({\n            e: SDTMath.c2l(element.c, element.s),\n            p: 0,\n          });\n          misses.push({\n            e: xScale.domain()[0],\n            p: 0,\n          });\n          return line(misses);\n        };\n      });\n\n    // H Curve\n    //  ENTER\n    signalEnter.append('path')\n      .classed('curve-h', true);\n    //  MERGE\n    signalMerge.select('.curve-h').transition()\n      .duration(this.drag ? 0 : transitionDuration)\n      .ease(d3.easeCubicOut)\n      .attrTween('d', (datum, index, elements) => {\n        const element = elements[index];\n        const interpolateD = d3.interpolate(\n          (element.d !== undefined) ? element.d : this.d,\n          this.d,\n        );\n        const interpolateC = d3.interpolate(\n          (element.c !== undefined) ? element.c : this.c,\n          this.c,\n        );\n        const interpolateS = d3.interpolate(\n          (element.s !== undefined) ? element.s : this.s,\n          this.s,\n        );\n        return (time) => {\n          element.d = interpolateD(time);\n          element.c = interpolateC(time);\n          element.s = interpolateS(time);\n          const hits = d3.range(\n            SDTMath.c2l(element.c, element.s),\n            xScale.domain()[1],\n            0.05,\n          ).map((e) => {\n            return {\n              e: e,\n              p: jStat.normal.pdf(e, SDTMath.d2muS(element.d, element.s), element.s),\n            };\n          });\n          hits.push({\n            e: xScale.domain()[1],\n            p: jStat.normal.pdf(\n              xScale.domain()[1],\n              SDTMath.d2muS(element.d, element.s),\n              element.s,\n            ),\n          });\n          hits.push({\n            e: xScale.domain()[1],\n            p: 0,\n          });\n          hits.push({\n            e: SDTMath.c2l(element.c, element.s),\n            p: 0,\n          });\n          return line(hits);\n        };\n      });\n\n    // Signal Curve\n    //  ENTER\n    signalEnter.append('path')\n      .classed('curve-signal', true);\n    //  MERGE\n    signalMerge.select('.curve-signal').transition()\n      .duration(this.drag ? 0 : transitionDuration)\n      .ease(d3.easeCubicOut)\n      .attrTween('d', (datum, index, elements) => {\n        const element = elements[index];\n        const interpolateD = d3.interpolate(\n          (element.d !== undefined) ? element.d : this.d,\n          this.d,\n        );\n        const interpolateS = d3.interpolate(\n          (element.s !== undefined) ? element.s : this.s,\n          this.s,\n        );\n        return (time) => {\n          element.d = interpolateD(time);\n          element.s = interpolateS(time);\n          const signal = d3.range(\n            xScale.domain()[0],\n            xScale.domain()[1],\n            0.05,\n          ).map((e) => {\n            return {\n              e: e,\n              p: jStat.normal.pdf(e, SDTMath.d2muS(element.d, element.s), element.s),\n            };\n          });\n          signal.push({\n            e: xScale.domain()[1],\n            p: jStat.normal.pdf(\n              xScale.domain()[1],\n              SDTMath.d2muS(element.d, element.s),\n              element.s,\n            ),\n          });\n          return line(signal);\n        };\n      });\n\n    // d' Measure\n    //  DATA-JOIN\n    const dUpdate = contentMerge.selectAll('.measure-d')\n      .data(this.sensitivity ? [{}] : []);\n    //  ENTER\n    const dEnter = dUpdate.enter().append('g')\n      .classed('measure-d', true);\n    dEnter.append('line')\n      .classed('line', true);\n    dEnter.append('line')\n      .classed('cap-left', true);\n    dEnter.append('line')\n      .classed('cap-right', true);\n    const dLabel = dEnter.append('text')\n      .classed('label', true);\n    dLabel.append('tspan')\n      .classed('d math-var', true)\n      .text('d');\n    dLabel.append('tspan')\n      .classed('equals', true)\n      .text(' = ');\n    dLabel.append('tspan')\n      .classed('value', true);\n    //  MERGE\n    const dMerge = dEnter.merge(dUpdate);\n    dMerge.select('.line').transition()\n      .duration(this.drag ? 0 : transitionDuration)\n      .ease(d3.easeCubicOut)\n      .attr('x1', xScale(this.muN))\n      .attr('y1', yScale(0.43)) // FIX - no hardcoding\n      .attr('x2', xScale(this.muS))\n      .attr('y2', yScale(0.43)); // FIX - no hardcoding\n    dMerge.select('.cap-left').transition()\n      .duration(this.drag ? 0 : transitionDuration)\n      .ease(d3.easeCubicOut)\n      .attr('x1', xScale(this.muN))\n      .attr('y1', yScale(0.43) + 5) // FIX - no hardcoding\n      .attr('x2', xScale(this.muN))\n      .attr('y2', yScale(0.43) - 5); // FIX - no hardcoding\n    dMerge.select('.cap-right').transition()\n      .duration(this.drag ? 0 : transitionDuration)\n      .ease(d3.easeCubicOut)\n      .attr('x1', xScale(this.muS))\n      .attr('y1', yScale(0.43) + 5) // FIX - no hardcoding\n      .attr('x2', xScale(this.muS))\n      .attr('y2', yScale(0.43) - 5); // FIX - no hardcoding\n    const dLabelTransition = dMerge.select('.label').transition()\n      .duration(this.drag ? 0 : transitionDuration)\n      .ease(d3.easeCubicOut)\n      .attr('x', xScale((this.muN > this.muS) ? this.muN : this.muS) + 5)\n      .attr('y', yScale(0.43) + 3); // FIX - no hardcoding\n    dLabelTransition.select('.value')\n      .tween('text', (datum, index, elements) => {\n        const element = elements[index];\n        const interpolateD = d3.interpolate(\n          (element.d !== undefined) ? element.d : this.d,\n          this.d,\n        );\n        return (time) => {\n          element.d = interpolateD(time);\n          d3.select(element).text(+(element.d).toFixed(3));\n        };\n      });\n    //  EXIT\n    dUpdate.exit().remove();\n\n    // c Measure\n    //  DATA-JOIN\n    const cUpdate = contentMerge.selectAll('.measure-c')\n      .data(this.bias ? [{}] : []);\n    //  ENTER\n    const cEnter = cUpdate.enter().append('g')\n      .classed('measure-c', true);\n    cEnter.append('line')\n      .classed('line', true);\n    cEnter.append('line')\n      .classed('cap-zero', true);\n    const cLabel = cEnter.append('text')\n      .classed('label', true);\n    cLabel.append('tspan')\n      .classed('c math-var', true)\n      .text('c');\n    cLabel.append('tspan')\n      .classed('equals', true)\n      .text(' = ');\n    cLabel.append('tspan')\n      .classed('value', true);\n    //  MERGE\n    const cMerge = cEnter.merge(cUpdate);\n    cMerge.select('.line').transition()\n      .duration(this.drag ? 0 : transitionDuration)\n      .ease(d3.easeCubicOut)\n      .attr('x1', xScale(this.l))\n      .attr('y1', yScale(0.47)) // FIX - no hardcoding\n      .attr('x2', xScale(0))\n      .attr('y2', yScale(0.47)); // FIX - no hardcoding\n    cMerge.select('.cap-zero').transition()\n      .duration(this.drag ? 0 : transitionDuration)\n      .ease(d3.easeCubicOut)\n      .attr('x1', xScale(0))\n      .attr('y1', yScale(0.47) + 5) // FIX - no hardcoding\n      .attr('x2', xScale(0))\n      .attr('y2', yScale(0.47) - 5); // FIX - no hardcoding\n    const cLabelTransition = cMerge.select('.label').transition()\n      .duration(this.drag ? 0 : transitionDuration)\n      .ease(d3.easeCubicOut)\n      .attr('x', xScale(0) + ((this.l < 0) ? 5 : -5))\n      .attr('y', yScale(0.47) + 3) // FIX - no hardcoding\n      .attr('text-anchor', (this.c < 0) ? 'start' : 'end');\n    cLabelTransition.select('.value')\n      .tween('text', (datum, index, elements) => {\n        const element = elements[index];\n        const interpolateC = d3.interpolate(\n          (element.c !== undefined) ? element.c : this.c,\n          this.c,\n        );\n        return (time) => {\n          element.c = interpolateC(time);\n          d3.select(element).text(+(element.c).toFixed(3));\n        };\n      });\n    //  EXIT\n    cUpdate.exit().remove();\n\n    // s Measure\n    //  DATA-JOIN\n    const sUpdate = contentMerge.selectAll('.measure-s')\n      .data(this.variance ? [{}] : []);\n    //  ENTER\n    const sEnter = sUpdate.enter().append('g')\n      .classed('measure-s', true);\n    sEnter.append('line')\n      .classed('line', true);\n    sEnter.append('line')\n      .classed('cap-left', true);\n    sEnter.append('line')\n      .classed('cap-right', true);\n    const sLabel = sEnter.append('text')\n      .classed('label', true);\n    sLabel.append('tspan')\n      .classed('s math-var', true)\n      .text('');\n    sLabel.append('tspan')\n      .classed('equals', true)\n      .text(' = ');\n    sLabel.append('tspan')\n      .classed('value', true);\n    //  MERGE\n    const sMerge = sEnter.merge(sUpdate);\n    sMerge.select('.line').transition()\n      .duration(this.drag ? 0 : transitionDuration)\n      .ease(d3.easeCubicOut)\n      .attr('x1', xScale(this.muS - this.s))\n      .attr('y1', yScale(jStat.normal.pdf(this.s, 0, this.s)) + (10 / this.s)) // FIX - no hardcoding\n      .attr('x2', xScale(this.muS + this.s))\n      .attr('y2', yScale(jStat.normal.pdf(this.s, 0, this.s)) + (10 / this.s)); // FIX - no hardcoding\n    sMerge.select('.cap-left').transition()\n      .duration(this.drag ? 0 : transitionDuration)\n      .ease(d3.easeCubicOut)\n      .attr('x1', xScale(this.muS - this.s))\n      .attr('y1', yScale(jStat.normal.pdf(this.s, 0, this.s)) + (10 / this.s) + 5) // FIX - no hardcoding\n      .attr('x2', xScale(this.muS - this.s))\n      .attr('y2', yScale(jStat.normal.pdf(this.s, 0, this.s)) + (10 / this.s) - 5); // FIX - no hardcoding\n    sMerge.select('.cap-right').transition()\n      .duration(this.drag ? 0 : transitionDuration)\n      .ease(d3.easeCubicOut)\n      .attr('x1', xScale(this.muS + this.s))\n      .attr('y1', yScale(jStat.normal.pdf(this.s, 0, this.s)) + (10 / this.s) + 5) // FIX - no hardcoding\n      .attr('x2', xScale(this.muS + this.s))\n      .attr('y2', yScale(jStat.normal.pdf(this.s, 0, this.s)) + (10 / this.s) - 5); // FIX - no hardcoding\n    const sLabelTransition = sMerge.select('.label').transition()\n      .duration(this.drag ? 0 : transitionDuration)\n      .ease(d3.easeCubicOut)\n      .attr('x', xScale(this.muS))\n      .attr('y', yScale(jStat.normal.pdf(this.s, 0, this.s)) + (10 / this.s) - 3); // FIX - no hardcoding\n    sLabelTransition.select('.value')\n      .tween('text', (datum, index, elements) => {\n        const element = elements[index];\n        const interpolateS = d3.interpolate(\n          (element.s !== undefined) ? element.s : this.s,\n          this.s,\n        );\n        return (time) => {\n          element.s = interpolateS(time);\n          d3.select(element).text(+(element.s).toFixed(3));\n        };\n      });\n    //  EXIT\n    sUpdate.exit().remove();\n\n    // Threshold Line\n    //  DATA-JOIN\n    const thresholdUpdate = contentMerge.selectAll('.threshold')\n      .data(this.threshold ? [{}] : []);\n    //  ENTER\n    const thresholdEnter = thresholdUpdate.enter().append('g')\n      .classed('threshold', true);\n    thresholdEnter.append('line')\n      .classed('line', true);\n    thresholdEnter.append('circle')\n      .classed('handle', true)\n      .attr('r', 6); /* HACK: Firefox does not support CSS SVG Geometry Properties */\n    //  MERGE\n    const thresholdMerge = thresholdEnter.merge(thresholdUpdate)\n      .attr('tabindex', this.interactive ? 0 : null)\n      .classed('interactive', this.interactive);\n    if (\n      this.firstUpdate\n      || changedProperties.has('interactive')\n    ) {\n      if (this.interactive) {\n        thresholdMerge\n          .call(dragThreshold)\n          .on('keydown', (/* datum */) => {\n            if (['ArrowRight', 'ArrowLeft'].includes(d3.event.key)) {\n              let l = this.l; // eslint-disable-line prefer-destructuring\n              switch (d3.event.key) {\n                case 'ArrowRight':\n                  l += d3.event.shiftKey ? 0.01 : 0.1;\n                  break;\n                case 'ArrowLeft':\n                  l -= d3.event.shiftKey ? 0.01 : 0.1;\n                  break;\n                default:\n              }\n              // Clamp C to visible extent\n              l = (l < xScale.domain()[0])\n                ? xScale.domain()[0]\n                : (l > xScale.domain()[1])\n                  ? xScale.domain()[1]\n                  : l;\n              if (l !== this.l) {\n                this.c = SDTMath.l2c(l, this.s);\n                this.alignState();\n                this.sendEvent();\n              }\n              d3.event.preventDefault();\n            }\n          });\n      } else {\n        thresholdMerge\n          .on('drag', null)\n          .on('keydown', null);\n      }\n    }\n    thresholdMerge.select('.line').transition()\n      .duration(this.drag ? 0 : transitionDuration)\n      .ease(d3.easeCubicOut)\n      .attr('x1', xScale(this.l))\n      .attr('y1', yScale(0))\n      .attr('x2', xScale(this.l))\n      .attr('y2', yScale(0.54));\n    thresholdMerge.select('.handle').transition()\n      .duration(this.drag ? 0 : transitionDuration)\n      .ease(d3.easeCubicOut)\n      .attr('cx', xScale(this.l))\n      .attr('cy', yScale(0.54));\n    //  EXIT\n    thresholdUpdate.exit().remove();\n\n    // Histogram\n    //  DATA-JOIN\n    const histogramUpdate = contentMerge.selectAll('.histogram')\n      .data(this.histogram ? [{}] : []);\n    //  ENTER\n    const histogramEnter = histogramUpdate.enter().append('g')\n      .classed('histogram', true);\n    //  MERGE\n    const histogramMerge = histogramEnter.merge(histogramUpdate);\n    //  EXIT\n    histogramUpdate.exit().remove();\n\n    // Trials\n    if (this.histogram) {\n      const histogram = d3.histogram()\n        .value((datum) => { return datum.trueEvidence; })\n        .domain(xScale.domain())\n        .thresholds(d3.range(this.binRange[0], this.binRange[1], this.binWidth));\n      const hist = histogram(this.trials);\n      let binCountLeft = -1;\n      let binCountRight = -1;\n      for (let i = 0; i < hist.length; i += 1) {\n        for (let j = 0; j < hist[i].length; j += 1) {\n          hist[i][j].binValue = hist[i].x0;\n          hist[i][j].binCount = j;\n          if (i === 0) binCountLeft = j;\n          if (i === hist.length - 1) binCountRight = j;\n        }\n      }\n      // Put out-of-range values in extreme left/right bins\n      for (let i = 0; i < this.trials.length; i += 1) {\n        if (this.trials[i].trueEvidence < this.binRange[0]) {\n          binCountLeft += 1;\n          this.trials[i].binCount = binCountLeft;\n          this.trials[i].binValue = hist[0].x0;\n        }\n        if (this.trials[i].trueEvidence > this.binRange[1]) {\n          binCountRight += 1;\n          this.trials[i].binCount = binCountRight;\n          this.trials[i].binValue = hist[hist.length - 1].x0;\n        }\n      }\n      //  DATA-JOIN\n      const trialUpdate = histogramMerge.selectAll('.trial')\n        .data(this.trials, (datum) => { return datum.trial; });\n      //  ENTER\n      const trialEnter = trialUpdate.enter().append('rect')\n        .attr('stroke-width', strokeWidth)\n        .attr('data-new-trial-ease-time', 0) // use 'data-trial-enter'\n        .attr('stroke', this.getComputedStyleValue('---color-acc'))\n        .attr('fill', this.getComputedStyleValue('---color-acc-light'));\n      //  MERGE\n      const trialMerge = trialEnter.merge(trialUpdate)\n        .attr('class', (datum) => { return `trial ${datum.outcome}`; })\n        .attr('width', binWidth - strokeWidth)\n        .attr('height', binWidth - strokeWidth);\n      //  MERGE - Active New Trials\n      const trialMergeNewActive = trialMerge.filter((datum) => {\n        return (datum.new && !datum.paused);\n      });\n      if (!trialMergeNewActive.empty()) {\n        const easeTime = trialMergeNewActive.attr('data-new-trial-ease-time');\n        const scaleIn = (time) => {\n          return d3.scaleLinear().domain([0, 1]).range([easeTime, 1])(time);\n        };\n        const scaleOutGenerator = (easeFunction) => {\n          return (time) => {\n            return d3.scaleLinear()\n              .domain([easeFunction(easeTime), 1]).range([0, 1])(easeFunction(time));\n          };\n        };\n        trialMergeNewActive.transition('new')\n          .duration((datum) => {\n            return Math.floor((datum.duration * 0.75 + datum.wait * 0.25) * (1 - easeTime));\n          })\n          .ease(scaleIn)\n          .attr('data-new-trial-ease-time', 1)\n          .attrTween('stroke', (datum, index, elements) => {\n            const element = elements[index];\n            const interpolator = d3.interpolateRgb(\n              element.getAttribute('stroke'),\n              (this.color === 'stimulus')\n                ? (datum.signal === 'present')\n                  ? this.getComputedStyleValue('---color-hr')\n                  : this.getComputedStyleValue('---color-far')\n                : (this.color === 'response')\n                  ? this.getComputedStyleValue(`---color-${datum.response}`)\n                  : (this.color === 'outcome')\n                    ? this.getComputedStyleValue(`---color-${datum.outcome}`)\n                    : this.getComputedStyleValue('---color-acc'),\n            );\n            return (time) => { return interpolator(scaleOutGenerator(d3.easeCubicIn)(time)); };\n          })\n          .attrTween('fill', (datum, index, elements) => {\n            const element = elements[index];\n            const interpolator = d3.interpolateRgb(\n              element.getAttribute('fill'),\n              (this.color === 'stimulus')\n                ? (datum.signal === 'present')\n                  ? this.getComputedStyleValue('---color-hr-light')\n                  : this.getComputedStyleValue('---color-far-light')\n                : (this.color === 'response')\n                  ? this.getComputedStyleValue(`---color-${datum.response}-light`)\n                  : (this.color === 'outcome')\n                    ? this.getComputedStyleValue(`---color-${datum.outcome}-light`)\n                    : this.getComputedStyleValue('---color-acc-light'),\n            );\n            return (time) => { return interpolator(scaleOutGenerator(d3.easeCubicIn)(time)); };\n          })\n          .attrTween('x', (datum, index, elements) => {\n            const element = elements[index];\n            const interpolator = d3.interpolate(\n              element.getAttribute('x'),\n              xScale(datum.binValue) + (strokeWidth / 2),\n            );\n            return (time) => { return interpolator(scaleOutGenerator(d3.easeCubicOut)(time)); };\n          })\n          .attrTween('y', (datum, index, elements) => {\n            const element = elements[index];\n            const interpolator = d3.interpolate(\n              element.getAttribute('y'),\n              yScale(0) + (strokeWidth / 2) - ((datum.binCount + 1) * binWidth),\n            );\n            return (time) => { return interpolator(scaleOutGenerator(d3.easeCubicIn)(time)); };\n          })\n          .on('end', (datum, index, elements) => {\n            const element = elements[index];\n            element.removeAttribute('data-new-trial-ease-time');\n            datum.new = false;\n            this.alignTrial(datum);\n            this.dispatchEvent(new CustomEvent('sdt-response', {\n              detail: {\n                stimulus: datum.signal,\n                response: datum.response,\n                outcome: datum.outcome,\n                h: this.h,\n                m: this.m,\n                fa: this.fa,\n                cr: this.cr,\n                nr: 0,\n              },\n              bubbles: true,\n            }));\n          });\n      }\n      // MERGE - Paused New Trials\n      const trialMergeNewPaused = trialMerge.filter((datum) => {\n        return (datum.new && datum.paused);\n      });\n      if (!trialMergeNewPaused.empty()) {\n        const easeTime = trialMergeNewPaused.attr('data-new-trial-ease-time');\n        trialMergeNewPaused.transition()\n          .duration(transitionDuration)\n          .ease(d3.easeCubicOut)\n          .attr('x', (datum) => {\n            const interpolator = d3.interpolate(\n              0,\n              xScale(datum.binValue) + (strokeWidth / 2),\n            );\n            return interpolator(d3.easeCubicOut(easeTime));\n          })\n          .attr('y', (datum) => {\n            const interpolator = d3.interpolate(\n              0,\n              yScale(0) + (strokeWidth / 2) - ((datum.binCount + 1) * binWidth),\n            );\n            return interpolator(d3.easeCubicIn(easeTime));\n          })\n          .attr('stroke', (datum) => {\n            const interpolator = d3.interpolateRgb(\n              this.getComputedStyleValue('---color-acc'),\n              (this.color === 'stimulus')\n                ? (datum.signal === 'present')\n                  ? this.getComputedStyleValue('---color-hr')\n                  : this.getComputedStyleValue('---color-far')\n                : (this.color === 'response')\n                  ? this.getComputedStyleValue(`---color-${datum.response}`)\n                  : (this.color === 'outcome')\n                    ? this.getComputedStyleValue(`---color-${datum.outcome}`)\n                    : this.getComputedStyleValue('---color-acc'),\n            );\n            return interpolator(d3.easeCubicIn(easeTime));\n          })\n          .attr('fill', (datum) => {\n            const interpolator = d3.interpolateRgb(\n              this.getComputedStyleValue('---color-acc-light'),\n              (this.color === 'stimulus')\n                ? (datum.signal === 'present')\n                  ? this.getComputedStyleValue('---color-hr-light')\n                  : this.getComputedStyleValue('---color-far-light')\n                : (this.color === 'response')\n                  ? this.getComputedStyleValue(`---color-${datum.response}-light`)\n                  : (this.color === 'outcome')\n                    ? this.getComputedStyleValue(`---color-${datum.outcome}-light`)\n                    : this.getComputedStyleValue('---color-acc-light'),\n            );\n            return interpolator(d3.easeCubicIn(easeTime));\n          });\n      }\n      //  MERGE - Old Trials\n      trialMerge.filter((datum) => { return !datum.new; }).transition()\n        .duration(transitionDuration)\n        .ease(d3.easeCubicOut)\n        .attr('x', (datum) => {\n          return xScale(datum.binValue) + (strokeWidth / 2);\n        })\n        .attr('y', (datum) => {\n          return yScale(0) + (strokeWidth / 2) - ((datum.binCount + 1) * binWidth);\n        })\n        .attr('stroke', (datum) => {\n          return (this.color === 'stimulus')\n            ? (datum.signal === 'present')\n              ? this.getComputedStyleValue('---color-hr')\n              : this.getComputedStyleValue('---color-far')\n            : (this.color === 'response')\n              ? this.getComputedStyleValue(`---color-${datum.response}`)\n              : (this.color === 'outcome')\n                ? this.getComputedStyleValue(`---color-${datum.outcome}`)\n                : this.getComputedStyleValue('---color-acc');\n        })\n        .attr('fill', (datum) => {\n          return (this.color === 'stimulus')\n            ? (datum.signal === 'present')\n              ? this.getComputedStyleValue('---color-hr-light')\n              : this.getComputedStyleValue('---color-far-light')\n            : (this.color === 'response')\n              ? this.getComputedStyleValue(`---color-${datum.response}-light`)\n              : (this.color === 'outcome')\n                ? this.getComputedStyleValue(`---color-${datum.outcome}-light`)\n                : this.getComputedStyleValue('---color-acc-light');\n        });\n      //  EXIT\n      trialUpdate.exit().transition()\n        .duration(transitionDuration)\n        .ease(d3.easeLinear)\n        .attrTween('stroke', (datum, index, elements) => {\n          const element = elements[index];\n          const interpolator = d3.interpolateRgb(\n            element.getAttribute('stroke'),\n            this.getComputedStyleValue('---color-acc'),\n          );\n          return (time) => { return interpolator(d3.easeCubicIn(time)); };\n        })\n        .attrTween('fill', (datum, index, elements) => {\n          const element = elements[index];\n          const interpolator = d3.interpolateRgb(\n            element.getAttribute('fill'),\n            this.getComputedStyleValue('---color-acc-light'),\n          );\n          return (time) => { return interpolator(d3.easeCubicIn(time)); };\n        })\n        .attrTween('x', (datum, index, elements) => {\n          const element = elements[index];\n          const interpolator = d3.interpolate(element.getAttribute('x'), 0);\n          return (time) => { return interpolator(d3.easeCubicIn(time)); };\n        })\n        .attrTween('y', (datum, index, elements) => {\n          const element = elements[index];\n          const interpolator = d3.interpolate(element.getAttribute('y'), 0);\n          return (time) => { return interpolator(d3.easeCubicOut(time)); };\n        })\n        .remove();\n    }\n\n    // Overlayer\n    //  ENTER\n    const overlayerEnter = plotEnter.append('g')\n      .classed('overlayer', true);\n    // MERGE\n    const overlayerMerge = plotMerge.select('.overlayer');\n\n    // Background\n    //  ENTER\n    overlayerEnter.append('rect')\n      .classed('background', true);\n    //  MERGE\n    overlayerMerge.select('.background')\n      .attr('height', height)\n      .attr('width', width);\n\n    this.drag = false;\n    this.firstUpdate = false;\n  }\n\n  // Called to pause trial animations!\n  pauseTrial() {\n    const trialNew = d3.select(this.renderRoot).select('.trial[data-new-trial-ease-time]');\n    trialNew.interrupt('new');\n    trialNew.datum((datum) => {\n      datum.paused = true;\n      return datum;\n    });\n  }\n\n  // Called to resume trial animations!\n  resumeTrial() {\n    const trialNew = d3.select(this.renderRoot).select('.trial[data-new-trial-ease-time]');\n    trialNew.datum((datum) => {\n      datum.paused = false;\n      return datum;\n    });\n    this.requestUpdate();\n  }\n}\n\ncustomElements.define('sdt-model', SDTModel);\n"],"file":"sdt-model.js"}