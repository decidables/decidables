{"version":3,"sources":["components/roc-space.js"],"names":["ROCSpace","contour","attribute","type","String","reflect","point","isoD","isoC","zRoc","Boolean","far","Number","hr","d","c","s","width","height","rem","firstUpdate","drag","sdt","contours","undefined","points","isoDs","isoCs","label","locations","name","pointArray","isoDArray","isoCArray","NaN","alignState","SDTMath","hrFar2D","hrFar2C","forEach","item","index","push","location","find","requestUpdate","dC2Hr","dC2Far","html","SDTElement","svgFilters","parseFloat","getComputedStyleValue","getComputedStyle","document","documentElement","getPropertyValue","window","addEventListener","getDimensions","bind","removeEventListener","changedProperties","setTimeout","isNaN","elementWidth","elementHeight","elementSize","Math","min","margin","top","bottom","left","right","transitionDuration","parseInt","xScale","d3","scaleLinear","domain","range","yScale","subject","datum","x","far2Zfar","y","hr2Zhr","on","elements","element","select","classed","zfar2Far","invert","event","zhr2Hr","dispatchEvent","CustomEvent","detail","bubbles","line","svgUpdate","renderRoot","selectAll","data","svgEnter","enter","append","svgMerge","merge","attr","plotEnter","plotMerge","underlayerEnter","underlayerMerge","has","n","contourValues","j","k","i","hrFar2Acc","contourThresholds","size","thresholds","contourColorStart","contourColorEnd","contourColor","extent","interpolate","interpolateRgb","contourPlotUpdate","contourPlotEnter","contourPlotMerge","contoursUpdate","contoursEnter","transition","duration","ease","easeCubicOut","geoPath","geoIdentity","scale","value","exit","remove","contourTitleUpdate","contourTitleEnter","text","l","contourLegendValues","legendContours","legendScale","contourLegendUpdate","contourLegendEnter","contourLegendMerge","call","axisLeft","ticks","tickSize","legendContoursUpdate","legendContoursEnter","axisXMerge","axisXTransition","axisBottom","titleXEnter","titleXMerge","axisYTransition","titleYEnter","titleYMerge","contentMerge","isoDUpdate","isoDEnter","isoDMerge","map","dFar2Hr","attrTween","interpolateD","interpolateS","time","interpolateHr","interpolateFar","isoCUpdate","isoCEnter","isoCMerge","cFar2Hr","interpolateC","pointUpdate","pointEnter","pointMerge","interactive","includes","key","shiftKey","preventDefault","css","customElements","define"],"mappings":"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","sourcesContent":["\nimport {html, css} from 'lit-element';\nimport * as d3 from 'd3';\n\nimport SDTMath from '@decidable/detectable-math';\n\nimport SDTElement from '../sdt-element';\n\n/*\n  ROCSpace element\n  <roc-space>\n\n  Attributes:\n    FAR; HR;\n    d'; C; zFAR; zHR\n\n    draggable: yes/no\n\n    scale: FAR/HR; zFAR/zHR; d'/C\n    grid: FAR/HR; zFAR/zHR; d'/C\n    isos: d'; C; FAR; HR\n\n  Styles:\n    ??\n*/\nexport default class ROCSpace extends SDTElement {\n  static get properties() {\n    return {\n      contour: {\n        attribute: 'contour',\n        type: String,\n        reflect: true,\n      },\n      point: {\n        attribute: 'point',\n        type: String,\n        reflect: true,\n      },\n      isoD: {\n        attribute: 'iso-d',\n        type: String,\n        reflect: true,\n      },\n      isoC: {\n        attribute: 'iso-c',\n        type: String,\n        reflect: true,\n      },\n\n      zRoc: {\n        attribute: 'z-roc',\n        type: Boolean,\n        reflect: true,\n      },\n\n      far: {\n        attribute: 'far',\n        type: Number,\n        reflect: true,\n      },\n      hr: {\n        attribute: 'hr',\n        type: Number,\n        reflect: true,\n      },\n\n      d: {\n        attribute: false,\n        type: Number,\n        reflect: false,\n      },\n      c: {\n        attribute: false,\n        type: Number,\n        reflect: false,\n      },\n      s: {\n        attribute: false,\n        type: Number,\n        reflect: false,\n      },\n\n      width: {\n        attribute: false,\n        type: Number,\n        reflect: false,\n      },\n      height: {\n        attribute: false,\n        type: Number,\n        reflect: false,\n      },\n      rem: {\n        attribute: false,\n        type: Number,\n        reflect: false,\n      },\n    };\n  }\n\n  constructor() {\n    super();\n\n    this.firstUpdate = true;\n    this.drag = false;\n    this.sdt = false;\n\n    this.contours = ['sensitivity', 'bias', 'accuracy'];\n    this.contour = undefined;\n    this.points = ['all', 'first', 'rest', 'none'];\n    this.point = 'all';\n    this.isoDs = ['all', 'first', 'rest', 'none'];\n    this.isoD = 'first';\n    this.isoCs = ['all', 'first', 'rest', 'none'];\n    this.isoC = 'first';\n\n    this.zRoc = false;\n\n    this.far = 0.25;\n    this.hr = 0.75;\n\n    this.s = 1;\n\n    this.label = '';\n\n    this.locations = [\n      {\n        name: 'default',\n        far: this.far,\n        hr: this.hr,\n        s: this.s,\n        label: '',\n      },\n    ];\n\n    this.pointArray = [];\n    this.isoDArray = [];\n    this.isoCArray = [];\n\n    this.width = NaN;\n    this.height = NaN;\n    this.rem = NaN;\n\n    this.alignState();\n  }\n\n  alignState() {\n    this.locations[0].hr = this.hr;\n    this.locations[0].far = this.far;\n    this.locations[0].s = this.s;\n    this.locations[0].label = this.label;\n\n    this.d = SDTMath.hrFar2D(this.hr, this.far, this.s);\n    this.c = SDTMath.hrFar2C(this.hr, this.far, this.s);\n\n    this.pointArray = [];\n    this.isoDArray = [];\n    this.isoCArray = [];\n    this.locations.forEach((item, index) => {\n      item.d = SDTMath.hrFar2D(item.hr, item.far, item.s);\n      item.c = SDTMath.hrFar2C(item.hr, item.far, item.s);\n\n      if ((index === 0) && (this.point === 'first' || this.point === 'all')) {\n        this.pointArray.push(item);\n      } else if ((index > 0) && (this.point === 'rest' || this.point === 'all')) {\n        this.pointArray.push(item);\n      }\n\n      if ((index === 0) && (this.isoD === 'first' || this.isoD === 'all')) {\n        this.isoDArray.push(item);\n      } else if ((index > 0) && (this.isoD === 'rest' || this.isoD === 'all')) {\n        this.isoDArray.push(item);\n      }\n\n      if ((index === 0) && (this.isoC === 'first' || this.isoC === 'all')) {\n        this.isoCArray.push(item);\n      } else if ((index > 0) && (this.isoC === 'rest' || this.isoC === 'all')) {\n        this.isoCArray.push(item);\n      }\n    });\n  }\n\n  set(hr, far, name = 'default', label = '', s = 1) {\n    if (name === 'default') {\n      this.hr = hr;\n      this.far = far;\n      this.s = s;\n      this.label = label;\n    }\n    const location = this.locations.find((item) => {\n      return (item.name === name);\n    });\n    if (location === undefined) {\n      this.locations.push({\n        name: name,\n        far: far,\n        hr: hr,\n        s: s,\n        label: label,\n      });\n    } else {\n      location.hr = hr;\n      location.far = far;\n      location.s = s;\n      location.label = label;\n    }\n\n    this.requestUpdate();\n  }\n\n  setWithSDT(d, c, name = 'default', label = '', s = 1) {\n    if (name === 'default') {\n      this.hr = SDTMath.dC2Hr(d, c, s);\n      this.far = SDTMath.dC2Far(d, c, s);\n      this.s = s;\n      this.label = label;\n    }\n    const location = this.locations.find((item) => {\n      return (item.name === name);\n    });\n    if (location === undefined) {\n      this.locations.push({\n        name: name,\n        far: SDTMath.dC2Far(d, c, s),\n        hr: SDTMath.dC2Hr(d, c, s),\n        s: s,\n        label: label,\n      });\n    } else {\n      location.hr = SDTMath.dC2Hr(d, c, s);\n      location.far = SDTMath.dC2Far(d, c, s);\n      location.s = s;\n      location.label = label;\n    }\n\n    this.sdt = true;\n    this.requestUpdate();\n  }\n\n  static get styles() {\n    return [\n      super.styles,\n      css`\n        :host {\n          display: inline-block;\n        }\n\n        .main {\n          width: 100%;\n          height: 100%;\n        }\n\n        .plot-contour,\n        .legend-contour .contour {\n          stroke: var(---color-background);\n          stroke-width: 0.5;\n        }\n\n        text {\n          /* stylelint-disable property-no-vendor-prefix */\n          -webkit-user-select: none;\n          -moz-user-select: none;\n          -ms-user-select: none;\n          user-select: none;\n        }\n\n        .point.interactive {\n          cursor: move;\n\n          filter: url(\"#shadow-2\");\n          outline: none;\n\n          /* HACK: This gets Safari to correctly apply the filter! */\n          /* https://github.com/emilbjorklund/svg-weirdness/issues/27 */\n          stroke: #000000;\n          stroke-opacity: 0;\n          stroke-width: 0;\n        }\n\n        /* Make a larger target for touch users */\n        @media (pointer: coarse) {\n          .point.interactive .circle {\n            stroke: #000000;\n            stroke-opacity: 0;\n            stroke-width: 12px;\n          }\n        }\n\n        .point.interactive:hover {\n          filter: url(\"#shadow-4\");\n\n          /* HACK: This gets Safari to correctly apply the filter! */\n          stroke: #ff0000;\n        }\n\n        .point.interactive:active {\n          filter: url(\"#shadow-8\");\n\n          /* HACK: This gets Safari to correctly apply the filter! */\n          stroke: #00ff00;\n        }\n\n        :host(.keyboard) .point.interactive:focus {\n          filter: url(\"#shadow-8\");\n\n          /* HACK: This gets Safari to correctly apply the filter! */\n          stroke: #0000ff;\n        }\n\n        .background {\n          fill: var(---color-element-background);\n          stroke: var(---color-element-border);\n          stroke-width: 1;\n          shape-rendering: crispEdges;\n        }\n\n        .title-x,\n        .title-y,\n        .title-contour {\n          font-weight: 600;\n\n          fill: currentColor;\n        }\n\n        .tick {\n          font-size: 0.75rem;\n        }\n\n        .axis-x path,\n        .axis-x line,\n        .axis-y path,\n        .axis-y line {\n          stroke: var(---color-element-border);\n        }\n\n        .axis-contour .domain {\n          stroke: none;\n        }\n\n        .diagonal {\n          stroke: var(---color-element-border);\n          stroke-dasharray: 4;\n          stroke-width: 1;\n        }\n\n        .curve-iso-d {\n          fill: none;\n          stroke: var(---color-d);\n          stroke-width: 2;\n        }\n\n        .curve-iso-c {\n          fill: none;\n          stroke: var(---color-c);\n          stroke-width: 2;\n        }\n\n        .point .circle {\n          fill: var(---color-element-emphasis);\n\n          /* r: 6; HACK: Firefox does not support CSS SVG Geometry Properties */\n        }\n\n        .point .label {\n          font-size: 0.75rem;\n\n          dominant-baseline: middle;\n          text-anchor: middle;\n\n          fill: var(---color-text-inverse);\n        }\n      `,\n    ];\n  }\n\n  render() { // eslint-disable-line class-methods-use-this\n    return html`\n      ${SDTElement.svgFilters}\n    `;\n  }\n\n  getDimensions() {\n    this.width = parseFloat(this.getComputedStyleValue('width'), 10);\n    this.height = parseFloat(this.getComputedStyleValue('height'), 10);\n    this.rem = parseFloat(getComputedStyle(document.documentElement).getPropertyValue('font-size'), 10);\n    // console.log(`roc-space: width = ${this.width}, height = ${this.height}, rem = ${this.rem}`);\n  }\n\n  connectedCallback() {\n    super.connectedCallback();\n    window.addEventListener('resize', this.getDimensions.bind(this));\n  }\n\n  disconnectedCallback() {\n    window.removeEventListener('resize', this.getDimensions.bind(this));\n    super.disconnectedCallback();\n  }\n\n  firstUpdated(changedProperties) {\n    super.firstUpdated(changedProperties);\n\n    // Get the width and height after initial render/update has occurred\n    // HACK Edge: Edge doesn't have width/height until after a 0ms timeout\n    window.setTimeout(this.getDimensions.bind(this), 0);\n  }\n\n  update(changedProperties) {\n    super.update(changedProperties);\n\n    this.alignState();\n\n    // Bail out if we can't get the width/height/rem\n    if (Number.isNaN(this.width) || Number.isNaN(this.height) || Number.isNaN(this.rem)) {\n      return;\n    }\n\n    const elementWidth = this.width;\n    const elementHeight = this.height;\n    const elementSize = Math.min(elementWidth, elementHeight);\n\n    const margin = {\n      top: 2 * this.rem,\n      bottom: 3 * this.rem,\n      left: 3 * this.rem,\n      right: 2 * this.rem,\n    };\n    const height = elementSize - (margin.top + margin.bottom);\n    const width = elementSize - (margin.left + margin.right);\n\n    const transitionDuration = parseInt(this.getComputedStyleValue('---transition-duration'), 10);\n\n    // X Scale\n    const xScale = d3.scaleLinear()\n      .domain(this.zRoc ? [-3, 3] : [0, 1]) // zFAR or FAR\n      .range([0, width]);\n    this.xScale = xScale;\n\n    // Y Scale\n    const yScale = d3.scaleLinear()\n      .domain(this.zRoc ? [3, -3] : [1, 0]) // zHR or HR\n      .range([0, height]);\n    this.yScale = yScale;\n\n    // Drag behavior\n    const drag = d3.drag()\n      .subject((datum) => {\n        return {\n          x: this.xScale(this.zRoc ? SDTMath.far2Zfar(datum.far) : datum.far),\n          y: this.yScale(this.zRoc ? SDTMath.hr2Zhr(datum.hr) : datum.hr),\n        };\n      })\n      .on('start', (datum, index, elements) => {\n        const element = elements[index];\n        d3.select(element).classed('dragging', true);\n      })\n      .on('drag', (datum) => {\n        this.drag = true;\n        const far = this.zRoc\n          ? SDTMath.zfar2Far(this.xScale.invert(d3.event.x))\n          : this.xScale.invert(d3.event.x);\n        const hr = this.zRoc\n          ? SDTMath.zhr2Hr(this.yScale.invert(d3.event.y))\n          : this.yScale.invert(d3.event.y);\n        // Clamp FAR and HR to ROC Space\n        datum.far = (far < 0.001)\n          ? 0.001\n          : ((far > 0.999)\n            ? 0.999\n            : far);\n        datum.hr = (hr <= 0.001)\n          ? 0.001\n          : (hr >= 0.999)\n            ? 0.999\n            : hr;\n        // console.log(`roc-space.drag: far = ${datum.far}, hr = ${datum.hr}`);\n        if (datum.name === 'default') {\n          this.far = datum.far;\n          this.hr = datum.hr;\n        }\n        this.alignState();\n        this.requestUpdate();\n        this.dispatchEvent(new CustomEvent('roc-point-change', {\n          detail: {\n            name: datum.name,\n            far: datum.far,\n            hr: datum.hr,\n            d: datum.d,\n            c: datum.c,\n            s: datum.s,\n            label: datum.label,\n          },\n          bubbles: true,\n        }));\n      })\n      .on('end', (datum, index, elements) => {\n        const element = elements[index];\n        d3.select(element).classed('dragging', false);\n      });\n\n    // Line for FAR/HR Space\n    const line = d3.line()\n      .x((datum) => { return xScale(this.zRoc ? SDTMath.far2Zfar(datum.far) : datum.far); })\n      .y((datum) => { return yScale(this.zRoc ? SDTMath.hr2Zhr(datum.hr) : datum.hr); });\n\n    // Svg\n    //  DATA-JOIN\n    const svgUpdate = d3.select(this.renderRoot).selectAll('.main')\n      .data([{\n        width: this.width,\n        height: this.height,\n        rem: this.rem,\n      }]);\n    //  ENTER\n    const svgEnter = svgUpdate.enter().append('svg')\n      .classed('main', true);\n    //  MERGE\n    const svgMerge = svgEnter.merge(svgUpdate)\n      .attr('viewBox', `0 0 ${elementSize} ${elementSize}`);\n\n    // Plot\n    //  ENTER\n    const plotEnter = svgEnter.append('g')\n      .classed('plot', true);\n    //  MERGE\n    const plotMerge = svgMerge.select('.plot')\n      .attr('transform', `translate(${margin.left}, ${margin.top})`);\n\n    // Clippath\n    //  ENTER\n    plotEnter.append('clipPath')\n      .attr('id', 'clip-roc-space')\n      .append('rect');\n    //  MERGE\n    plotMerge.select('clipPath rect')\n      .attr('height', height + 1)\n      .attr('width', width + 1);\n\n    // Underlayer\n    //  ENTER\n    const underlayerEnter = plotEnter.append('g')\n      .classed('underlayer', true);\n    // MERGE\n    const underlayerMerge = plotMerge.select('.underlayer');\n\n    // Background\n    //  ENTER\n    underlayerEnter.append('rect')\n      .classed('background', true);\n    //  MERGE\n    underlayerMerge.select('.background')\n      .attr('height', height)\n      .attr('width', width);\n\n    // Contour Plotting\n    //  Handles: Bias, Sensitivity, & Accuracy\n    if (\n      this.firstUpdate\n      || changedProperties.has('contour')\n      || changedProperties.has('zRoc')\n      || changedProperties.has('width')\n      || changedProperties.has('height')\n      || changedProperties.has('rem')\n      || changedProperties.has('s')\n    ) {\n      if (this.contour !== undefined) {\n        // Contour Plot\n        const n = 100; // Resolution\n        const contourValues = [];\n        for (let j = 0.5, k = 0; j < n; j += 1) {\n          for (let i = 0.5; i < n; i += 1, k += 1) {\n            const hr = this.zRoc\n              ? SDTMath.zhr2Hr(((i / n) * 6) - 3)\n              : i / n;\n            const far = this.zRoc\n              ? SDTMath.zfar2Far(((1 - j / n) * 6) - 3)\n              : (1 - j / n);\n            contourValues[k] = (this.contour === 'bias')\n              ? SDTMath.hrFar2C(hr, far, this.s)\n              : (this.contour === 'sensitivity')\n                ? SDTMath.hrFar2D(hr, far, this.s)\n                : (this.contour === 'accuracy')\n                  ? SDTMath.hrFar2Acc(hr, far)\n                  : null;\n          }\n        }\n        const contourThresholds = (this.contour === 'bias')\n          ? d3.range(-3, 3, 0.25)\n          : (this.contour === 'sensitivity')\n            ? d3.range(-6, 6, 0.5)\n            : (this.contour === 'accuracy')\n              ? d3.range(0, 1, 0.05)\n              : null;\n        const contours = d3.contours()\n          .size([n, n])\n          .thresholds(contourThresholds);\n        const contourColorStart = this.getComputedStyleValue((this.contour === 'bias')\n          ? '---color-element-background'\n          : (this.contour === 'sensitivity')\n            ? '---color-d'\n            : (this.contour === 'accuracy')\n              ? '---color-acc-dark'\n              : null);\n        const contourColorEnd = this.getComputedStyleValue((this.contour === 'bias')\n          ? '---color-c'\n          : (this.contour === 'sensitivity')\n            ? '---color-element-background'\n            : (this.contour === 'accuracy')\n              ? '---color-element-background'\n              : null);\n        const contourColor = d3.scaleLinear()\n          .domain(d3.extent(contourThresholds))\n          .interpolate(() => { return d3.interpolateRgb(contourColorStart, contourColorEnd); });\n        //  DATA-JOIN\n        const contourPlotUpdate = underlayerMerge.selectAll('.plot-contour')\n          .data([this.contour]);\n        //  ENTER\n        const contourPlotEnter = contourPlotUpdate.enter().append('g')\n          .classed('plot-contour', true);\n        //  MERGE\n        const contourPlotMerge = contourPlotEnter.merge(contourPlotUpdate);\n\n        // Contour Plot Contours\n        //  DATA-JOIN\n        const contoursUpdate = contourPlotMerge.selectAll('.contour')\n          .data(contours(contourValues));\n        //  ENTER\n        const contoursEnter = contoursUpdate.enter().append('path')\n          .classed('contour', true);\n        //  MERGE\n        contoursEnter.merge(contoursUpdate).transition()\n          .duration(transitionDuration * 2) // Extra long transition!\n          .ease(d3.easeCubicOut)\n          .attr('d', d3.geoPath(d3.geoIdentity().scale(width / n))) // ????\n          .attr('fill', (datum) => { return contourColor(datum.value); });\n        //  EXIT\n        contoursUpdate.exit().remove();\n\n        // Contour Title\n        //  DATA-JOIN\n        const contourTitleUpdate = underlayerMerge.selectAll('.title-contour')\n          .data([this.contour]);\n        //  ENTER\n        const contourTitleEnter = contourTitleUpdate.enter().append('text')\n          .classed('title-contour', true)\n          .attr('text-anchor', 'middle');\n        //  MERGE\n        contourTitleEnter.merge(contourTitleUpdate)\n          .classed('math-var', (this.contour === 'bias') || (this.contour === 'sensitivity'))\n          .attr('transform', (this.contour === 'bias')\n            ? `translate(${(width + (1.25 * this.rem))}, ${this.rem})`\n            : (this.contour === 'sensitivity')\n              ? `translate(${(width + (1.25 * this.rem))}, ${this.rem})`\n              : (this.contour === 'accuracy')\n                ? `translate(${(width + (1.125 * this.rem))}, ${this.rem})`\n                : null)\n          .text((this.contour === 'bias')\n            ? 'c'\n            : (this.contour === 'sensitivity')\n              ? 'd′'\n              : (this.contour === 'accuracy')\n                ? 'Acc'\n                : null);\n\n        // Contour Legend\n        const l = 100;\n        const contourLegendValues = []; // new Array(4 * l);\n        for (let i = 0.5, k = 0; i < l; i += 1, k += 4) {\n          contourLegendValues[k] = (this.contour === 'bias')\n            ? -(((i / n) * 6) - 3)\n            : (this.contour === 'sensitivity')\n              ? ((i / n) * 12) - 6\n              : (this.contour === 'accuracy')\n                ? (i / n)\n                : null;\n          contourLegendValues[k + 1] = contourLegendValues[k];\n          contourLegendValues[k + 2] = contourLegendValues[k];\n          contourLegendValues[k + 3] = contourLegendValues[k];\n        }\n        const legendContours = d3.contours()\n          .size([4, l])\n          .thresholds(contourThresholds);\n        const legendScale = d3.scaleLinear()\n          .domain((this.contour === 'bias')\n            ? [3, -3]\n            : (this.contour === 'sensitivity')\n              ? [6, -6]\n              : (this.contour === 'accuracy')\n                ? [1, 0]\n                : null)\n          .range([0, (10 * this.rem)]);\n        //  DATA-JOIN\n        const contourLegendUpdate = underlayerMerge.selectAll('.legend-contour')\n          .data([this.contour]);\n        //  ENTER\n        const contourLegendEnter = contourLegendUpdate.enter().append('g')\n          .classed('legend-contour', true);\n        //  MERGE\n        const contourLegendMerge = contourLegendEnter.merge(contourLegendUpdate)\n          .attr('transform', (this.contour === 'bias')\n            ? `translate(${(width + (1.25 * this.rem))}, ${(1.5 * this.rem)})`\n            : (this.contour === 'sensitivity')\n              ? `translate(${(width + (1.25 * this.rem))}, ${(1.5 * this.rem)})`\n              : (this.contour === 'accuracy')\n                ? `translate(${(width + (1.5 * this.rem))}, ${(1.5 * this.rem)})`\n                : null);\n        //  EXIT\n        contourLegendUpdate.exit().remove();\n\n        // Contour Legend Axis\n        //  ENTER\n        contourLegendEnter.append('g')\n          .classed('axis-contour', true);\n        //  MERGE\n        contourLegendMerge.select('.axis-contour')\n          .call(d3.axisLeft(legendScale).ticks(7).tickSize(0))\n          .attr('font-size', null)\n          .attr('font-family', null);\n\n        // Contour Legend Contours\n        //  DATA-JOIN\n        const legendContoursUpdate = contourLegendMerge.selectAll('.contour')\n          .data(legendContours(contourLegendValues));\n        //  ENTER\n        const legendContoursEnter = legendContoursUpdate.enter().append('path')\n          .classed('contour', true);\n        //  MERGE\n        legendContoursEnter.merge(legendContoursUpdate)\n          .attr('d', d3.geoPath(d3.geoIdentity().scale((10 * this.rem) / l))) // ????\n          .attr('fill', (datum) => { return contourColor(datum.value); });\n        //  EXIT\n        legendContoursUpdate.exit().remove();\n      } else {\n        // Contour Plot\n        //  DATA-JOIN\n        const contourPlotUpdate = underlayerMerge.selectAll('.plot-contour')\n          .data([]);\n        //  EXIT\n        contourPlotUpdate.exit().remove();\n\n        // Contour Title\n        //  DATA-JOIN\n        const contourTitleUpdate = underlayerMerge.selectAll('.title-contour')\n          .data([]);\n        //  EXIT\n        contourTitleUpdate.exit().remove();\n\n        // Contour Legend\n        //  DATA-JOIN\n        const contourLegendUpdate = underlayerMerge.selectAll('.legend-contour')\n          .data([]);\n        //  EXIT\n        contourLegendUpdate.exit().remove();\n      }\n    }\n\n    // X Axis\n    //  ENTER\n    underlayerEnter.append('g')\n      .classed('axis-x', true);\n    //  MERGE\n    const axisXMerge = underlayerMerge.select('.axis-x')\n      .attr('transform', `translate(0, ${height})`);\n    const axisXTransition = axisXMerge.transition()\n      .duration(transitionDuration * 2) // Extra long transition!\n      .ease(d3.easeCubicOut)\n      .call(d3.axisBottom(xScale))\n      .attr('font-size', null)\n      .attr('font-family', null);\n    axisXTransition.selectAll('line, path')\n      .attr('stroke', null);\n\n    // X Axis Title\n    //  ENTER\n    const titleXEnter = underlayerEnter.append('text')\n      .classed('title-x', true)\n      .attr('text-anchor', 'middle');\n    titleXEnter.append('tspan')\n      .classed('z math-var', true);\n    titleXEnter.append('tspan')\n      .classed('name', true);\n    //  MERGE\n    const titleXMerge = underlayerMerge.select('.title-x')\n      .attr('transform', `translate(${(width / 2)}, ${(height + (2.25 * this.rem))})`);\n    titleXMerge.select('tspan.z')\n      .text(this.zRoc ? 'z' : '');\n    titleXMerge.select('tspan.name')\n      .text(this.zRoc ? '(False Alarm Rate)' : 'False Alarm Rate');\n\n    // Y Axis\n    //  ENTER\n    underlayerEnter.append('g')\n      .classed('axis-y', true);\n    // MERGE\n    const axisYTransition = underlayerMerge.select('.axis-y').transition()\n      .duration(transitionDuration * 2) // Extra long transition!\n      .ease(d3.easeCubicOut)\n      .call(d3.axisLeft(yScale))\n      .attr('font-size', null)\n      .attr('font-family', null);\n    axisYTransition.selectAll('line, path')\n      .attr('stroke', null);\n\n    // Y Axis Title\n    //  ENTER\n    const titleYEnter = underlayerEnter.append('text')\n      .classed('title-y', true)\n      .attr('text-anchor', 'middle');\n    titleYEnter.append('tspan')\n      .classed('z math-var', true);\n    titleYEnter.append('tspan')\n      .classed('name', true);\n    //  MERGE\n    const titleYMerge = underlayerMerge.select('.title-y')\n      .attr('transform', `translate(${-2 * this.rem}, ${(height / 2)})rotate(-90)`);\n    titleYMerge.select('tspan.z')\n      .text(this.zRoc ? 'z' : '');\n    titleYMerge.select('tspan.name')\n      .text(this.zRoc ? '(Hit Rate)' : 'Hit Rate');\n\n    // No-Information Line\n    //  ENTER\n    underlayerEnter.append('line')\n      .classed('diagonal', true);\n    //  MERGE\n    underlayerMerge.select('.diagonal')\n      .attr('x1', this.zRoc ? xScale(-3) : xScale(0))\n      .attr('y1', this.zRoc ? yScale(-3) : yScale(0))\n      .attr('x2', this.zRoc ? xScale(3) : xScale(1))\n      .attr('y2', this.zRoc ? yScale(3) : yScale(1));\n\n    // Content\n    //  ENTER\n    plotEnter.append('g')\n      .classed('content', true);\n    //  MERGE\n    const contentMerge = plotMerge.select('.content');\n\n    // Iso-sensitivity Curve\n    //  DATA-JOIN\n    const isoDUpdate = contentMerge.selectAll('.curve-iso-d')\n      .data(this.isoDArray, (datum) => { return datum.name; });\n    //  ENTER\n    const isoDEnter = isoDUpdate.enter().append('path')\n      .classed('curve-iso-d', true)\n      .attr('clip-path', 'url(#clip-roc-space)');\n    //  MERGE\n    const isoDMerge = isoDEnter.merge(isoDUpdate);\n    if (this.firstUpdate || changedProperties.has('zRoc')) {\n      isoDMerge.transition()\n        .duration(this.drag ? 0 : (transitionDuration * 2)) // Extra long transition!\n        .ease(d3.easeCubicOut)\n        .attr('d', (datum) => {\n          return line(d3.range(xScale.range()[0], xScale.range()[1] + 1, 1).map((x) => {\n            return {\n              far: (this.zRoc\n                ? SDTMath.zfar2Far(xScale.invert(x))\n                : xScale.invert(x)),\n              hr: (this.zRoc\n                ? SDTMath.dFar2Hr(datum.d, SDTMath.zfar2Far(xScale.invert(x)), datum.s)\n                : SDTMath.dFar2Hr(datum.d, xScale.invert(x), datum.s)),\n            };\n          }));\n        });\n    } else if (this.sdt) {\n      isoDMerge.transition()\n        .duration(this.drag ? 0 : transitionDuration)\n        .ease(d3.easeCubicOut)\n        .attrTween('d', (datum, index, elements) => {\n          const element = elements[index];\n          element.hr = undefined;\n          element.far = undefined;\n          const interpolateD = d3.interpolate(\n            (element.d !== undefined) ? element.d : datum.d,\n            datum.d,\n          );\n          const interpolateS = d3.interpolate(\n            (element.s !== undefined) ? element.s : datum.s,\n            datum.s,\n          );\n          return (time) => {\n            element.d = interpolateD(time);\n            element.s = interpolateS(time);\n            const isoD = d3.range(xScale.range()[0], xScale.range()[1] + 1, 1).map((x) => {\n              return {\n                far: (this.zRoc\n                  ? SDTMath.zfar2Far(xScale.invert(x))\n                  : xScale.invert(x)),\n                hr: (this.zRoc\n                  ? SDTMath.dFar2Hr(element.d, SDTMath.zfar2Far(xScale.invert(x)), element.s)\n                  : SDTMath.dFar2Hr(element.d, xScale.invert(x), element.s)),\n              };\n            });\n            return line(isoD);\n          };\n        });\n    } else {\n      isoDMerge.transition()\n        .duration(this.drag ? 0 : transitionDuration)\n        .ease(d3.easeCubicOut)\n        .attrTween('d', (datum, index, elements) => {\n          const element = elements[index];\n          element.d = undefined;\n          element.s = undefined;\n          const interpolateHr = d3.interpolate(\n            (element.hr !== undefined) ? element.hr : datum.hr,\n            datum.hr,\n          );\n          const interpolateFar = d3.interpolate(\n            (element.far !== undefined) ? element.far : datum.far,\n            datum.far,\n          );\n          return (time) => {\n            element.hr = interpolateHr(time);\n            element.far = interpolateFar(time);\n            const isoD = d3.range(xScale.range()[0], xScale.range()[1] + 1, 1).map((x) => {\n              return {\n                far: (this.zRoc\n                  ? SDTMath.zfar2Far(xScale.invert(x))\n                  : xScale.invert(x)),\n                hr: (this.zRoc\n                  ? SDTMath.dFar2Hr(\n                    SDTMath.hrFar2D(element.hr, element.far, datum.s),\n                    SDTMath.zfar2Far(xScale.invert(x)),\n                    datum.s,\n                  )\n                  : SDTMath.dFar2Hr(\n                    SDTMath.hrFar2D(element.hr, element.far, datum.s),\n                    xScale.invert(x),\n                    datum.s,\n                  )\n                ),\n              };\n            });\n            return line(isoD);\n          };\n        });\n    }\n    //  EXIT\n    // NOTE: Could add a transition here\n    isoDUpdate.exit().remove();\n\n    // Iso-bias Curve\n    //  DATA-JOIN\n    const isoCUpdate = contentMerge.selectAll('.curve-iso-c')\n      .data(this.isoCArray, (datum) => { return datum.name; });\n    //  ENTER\n    const isoCEnter = isoCUpdate.enter().append('path')\n      .classed('curve-iso-c', true)\n      .attr('clip-path', 'url(#clip-roc-space)');\n    //  MERGE\n    const isoCMerge = isoCEnter.merge(isoCUpdate);\n    if (this.firstUpdate || changedProperties.has('zRoc')) {\n      isoCMerge.transition()\n        .duration(this.drag ? 0 : (transitionDuration * 2)) // Extra long transition!\n        .ease(d3.easeCubicOut)\n        .attr('d', (datum) => {\n          return line(d3.range(xScale.range()[0], xScale.range()[1] + 1, 1).map((x) => {\n            return {\n              far: (this.zRoc\n                ? SDTMath.zfar2Far(xScale.invert(x))\n                : xScale.invert(x)),\n              hr: (this.zRoc\n                ? SDTMath.cFar2Hr(datum.c, SDTMath.zfar2Far(xScale.invert(x)), datum.s)\n                : SDTMath.cFar2Hr(datum.c, xScale.invert(x), datum.s)),\n            };\n          }));\n        });\n    } else if (this.sdt) {\n      isoCMerge.transition()\n        .duration(this.drag ? 0 : transitionDuration)\n        .ease(d3.easeCubicOut)\n        .attrTween('d', (datum, index, elements) => {\n          const element = elements[index];\n          element.hr = undefined;\n          element.far = undefined;\n          const interpolateC = d3.interpolate(\n            (element.c !== undefined) ? element.c : datum.c,\n            datum.c,\n          );\n          const interpolateS = d3.interpolate(\n            (element.s !== undefined) ? element.s : datum.s,\n            datum.s,\n          );\n          return (time) => {\n            element.c = interpolateC(time);\n            element.s = interpolateS(time);\n            const isoC = d3.range(xScale.range()[0], xScale.range()[1] + 1, 1).map((x) => {\n              return {\n                far: (this.zRoc\n                  ? SDTMath.zfar2Far(xScale.invert(x))\n                  : xScale.invert(x)),\n                hr: (this.zRoc\n                  ? SDTMath.cFar2Hr(element.c, SDTMath.zfar2Far(xScale.invert(x)), element.s)\n                  : SDTMath.cFar2Hr(element.c, xScale.invert(x), element.s)),\n              };\n            });\n            return line(isoC);\n          };\n        });\n    } else {\n      isoCMerge.transition()\n        .duration(this.drag ? 0 : transitionDuration)\n        .ease(d3.easeCubicOut)\n        .attrTween('d', (datum, index, elements) => {\n          const element = elements[index];\n          element.c = undefined;\n          element.s = undefined;\n          const interpolateHr = d3.interpolate(\n            (element.hr !== undefined) ? element.hr : datum.hr,\n            datum.hr,\n          );\n          const interpolateFar = d3.interpolate(\n            (element.far !== undefined) ? element.far : datum.far,\n            datum.far,\n          );\n          return (time) => {\n            element.hr = interpolateHr(time);\n            element.far = interpolateFar(time);\n            const isoC = d3.range(xScale.range()[0], xScale.range()[1] + 1, 1).map((x) => {\n              return {\n                far: (this.zRoc\n                  ? SDTMath.zfar2Far(xScale.invert(x))\n                  : xScale.invert(x)),\n                hr: (this.zRoc\n                  ? SDTMath.cFar2Hr(\n                    SDTMath.hrFar2C(element.hr, element.far, datum.s),\n                    SDTMath.zfar2Far(xScale.invert(x)),\n                    datum.s,\n                  )\n                  : SDTMath.cFar2Hr(\n                    SDTMath.hrFar2C(element.hr, element.far, datum.s),\n                    xScale.invert(x),\n                    datum.s,\n                  )\n                ),\n              };\n            });\n            return line(isoC);\n          };\n        });\n    }\n    //  EXIT\n    // NOTE: Could add a transition here\n    isoCUpdate.exit().remove();\n\n    // Point\n    //  DATA-JOIN\n    const pointUpdate = contentMerge.selectAll('.point')\n      .data(this.pointArray, (datum) => { return datum.name; });\n    //  ENTER\n    const pointEnter = pointUpdate.enter().append('g')\n      .classed('point', true);\n    pointEnter.append('circle')\n      .classed('circle', true)\n      .attr('r', 6); /* HACK: Firefox does not support CSS SVG Geometry Properties */\n    pointEnter.append('text')\n      .classed('label', true);\n    //  MERGE\n    const pointMerge = pointEnter.merge(pointUpdate);\n    pointMerge.select('text')\n      .text((datum) => { return datum.label; });\n    if (this.firstUpdate || changedProperties.has('interactive')) {\n      if (this.interactive) {\n        pointMerge\n          .attr('tabindex', 0)\n          .classed('interactive', true)\n          .call(drag)\n          .on('keydown', (datum) => {\n            if (['ArrowUp', 'ArrowDown', 'ArrowRight', 'ArrowLeft'].includes(d3.event.key)) {\n              let hr = this.zRoc ? SDTMath.hr2Zhr(datum.hr) : datum.hr;\n              let far = this.zRoc ? SDTMath.far2Zfar(datum.far) : datum.far;\n              switch (d3.event.key) {\n                case 'ArrowUp':\n                  hr += this.zRoc\n                    ? (d3.event.shiftKey ? 0.05 : 0.25)\n                    : (d3.event.shiftKey ? 0.01 : 0.05);\n                  break;\n                case 'ArrowDown':\n                  hr -= this.zRoc\n                    ? (d3.event.shiftKey ? 0.05 : 0.25)\n                    : (d3.event.shiftKey ? 0.01 : 0.05);\n                  break;\n                case 'ArrowRight':\n                  far += this.zRoc\n                    ? (d3.event.shiftKey ? 0.05 : 0.25)\n                    : (d3.event.shiftKey ? 0.01 : 0.05);\n                  break;\n                case 'ArrowLeft':\n                  far -= this.zRoc\n                    ? (d3.event.shiftKey ? 0.05 : 0.25)\n                    : (d3.event.shiftKey ? 0.01 : 0.05);\n                  break;\n                default:\n                  // no-op\n              }\n              hr = this.zRoc ? SDTMath.zhr2Hr(hr) : hr;\n              far = this.zRoc ? SDTMath.zfar2Far(far) : far;\n              // Clamp FAR and HR to ROC Space\n              hr = (hr < 0.001)\n                ? 0.001\n                : (hr > 0.999)\n                  ? 0.999\n                  : hr;\n              far = (far < 0.001)\n                ? 0.001\n                : (far > 0.999)\n                  ? 0.999\n                  : far;\n              if ((hr !== datum.hr) || (far !== datum.far)) {\n                datum.hr = hr;\n                datum.far = far;\n                if (datum.name === 'default') {\n                  this.hr = datum.hr;\n                  this.far = datum.far;\n                }\n                this.alignState();\n                this.requestUpdate();\n                this.dispatchEvent(new CustomEvent('roc-point-change', {\n                  detail: {\n                    name: datum.name,\n                    far: datum.far,\n                    hr: datum.hr,\n                    d: datum.d,\n                    c: datum.c,\n                    s: datum.s,\n                    label: datum.label,\n                  },\n                  bubbles: true,\n                }));\n              }\n              d3.event.preventDefault();\n            }\n          });\n      } else {\n        pointMerge\n          .attr('tabindex', null)\n          .classed('interactive', false)\n          .on('drag', null)\n          .on('keydown', null);\n      }\n    }\n    if (this.firstUpdate || changedProperties.has('zRoc')) {\n      pointMerge.transition()\n        .duration(this.drag ? 0 : (transitionDuration * 2)) // Extra long transition!\n        .ease(d3.easeCubicOut)\n        .attr('transform', (datum, index, elements) => {\n          const element = elements[index];\n          element.d = undefined;\n          element.c = undefined;\n          element.s = undefined;\n          return `translate(\n            ${xScale(this.zRoc ? SDTMath.far2Zfar(datum.far) : datum.far)},\n            ${yScale(this.zRoc ? SDTMath.hr2Zhr(datum.hr) : datum.hr)}\n          )`;\n        });\n    } else if (this.sdt) {\n      pointMerge.transition()\n        .duration(this.drag ? 0 : transitionDuration)\n        .ease(d3.easeCubicOut)\n        .attrTween('transform', (datum, index, elements) => {\n          const element = elements[index];\n          const interpolateD = d3.interpolate(\n            (element.d !== undefined) ? element.d : datum.d,\n            datum.d,\n          );\n          const interpolateC = d3.interpolate(\n            (element.c !== undefined) ? element.c : datum.c,\n            datum.c,\n          );\n          const interpolateS = d3.interpolate(\n            (element.s !== undefined) ? element.s : datum.s,\n            datum.s,\n          );\n          return (time) => {\n            element.d = interpolateD(time);\n            element.c = interpolateC(time);\n            element.s = interpolateS(time);\n            return `translate(\n              ${xScale(\n                this.zRoc\n                  ? SDTMath.far2Zfar(SDTMath.dC2Far(element.d, element.c, element.s))\n                  : SDTMath.dC2Far(element.d, element.c, element.s),\n              )},\n              ${yScale(\n                this.zRoc\n                  ? SDTMath.hr2Zhr(SDTMath.dC2Hr(element.d, element.c, element.s))\n                  : SDTMath.dC2Hr(element.d, element.c, element.s),\n              )}\n            )`;\n          };\n        });\n    } else {\n      pointMerge.transition()\n        .duration(this.drag ? 0 : transitionDuration)\n        .ease(d3.easeCubicOut)\n        .attr('transform', (datum, index, elements) => {\n          const element = elements[index];\n          element.d = undefined;\n          element.c = undefined;\n          element.s = undefined;\n          return `translate(\n            ${xScale(this.zRoc ? SDTMath.far2Zfar(datum.far) : datum.far)},\n            ${yScale(this.zRoc ? SDTMath.hr2Zhr(datum.hr) : datum.hr)}\n          )`;\n        });\n    }\n    //  EXIT\n    // NOTE: Could add a transition here\n    pointUpdate.exit().remove();\n\n    this.drag = false;\n    this.sdt = false;\n    this.firstUpdate = false;\n  }\n}\n\ncustomElements.define('roc-space', ROCSpace);\n"],"file":"roc-space.js"}