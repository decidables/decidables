!function(n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define([],n):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).detectableMath=n()}(function(){return function e(o,u,a){function i(r,n){if(!u[r]){if(!o[r]){var t="function"==typeof require&&require;if(!n&&t)return t(r,!0);if(f)return f(r,!0);throw(t=new Error("Cannot find module '"+r+"'")).code="MODULE_NOT_FOUND",t}t=u[r]={exports:{}},o[r][0].call(t.exports,function(n){return i(o[r][1][n]||n)},t,t.exports,e,o,u,a)}return u[r].exports}for(var f="function"==typeof require&&require,n=0;n<a.length;n++)i(a[n]);return i}({1:[function(n,r,t){"use strict";function e(n){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n})(n)}var o;o=function(){var d,p,x,q,g,h,i,f,o,r,c,l,s,u,t,m=function(i,f){var r=Array.prototype.concat,n=Array.prototype.slice,t=Object.prototype.toString;function c(n,r){r=r<n?n:r;return i.pow(10,17-~~(i.log(0<r?r:-r)*i.LOG10E))}var l=Array.isArray||function(n){return"[object Array]"===t.call(n)};function s(n){return"[object Function]"===t.call(n)}function m(n){return"number"==typeof n&&n-n==0}function d(){return new d._init(arguments)}function e(){return 0}function o(){return 1}function u(n,r){return n===r?1:0}function a(n,r,t,e){var o,u=[],a=n.length;if(r===f&&t===f&&e===f)return d.copy(n);if(e=e||1,(r=0<=(r=r||0)?r:a+r)===(t=0<=(t=t||n.length)?t:a+t)||0===e)return[];if(r<t&&e<0)return[];if(t<r&&0<e)return[];if(0<e)for(o=r;o<t;o+=e)u.push(n[o]);else for(o=r;t<o;o+=e)u.push(n[o]);return u}d.fn=d.prototype,(d._init=function(n){if(l(n[0]))if(l(n[0][0])){s(n[1])&&(n[0]=d.map(n[0],n[1]));for(var r=0;r<n[0].length;r++)this[r]=n[0][r];this.length=n[0].length}else this[0]=s(n[1])?d.map(n[0],n[1]):n[0],this.length=1;else if(m(n[0]))this[0]=d.seq.apply(null,n),this.length=1;else{if(n[0]instanceof d)return d(n[0].toArray());this[0]=[],this.length=1}return this}).prototype=d.prototype,(d._init.constructor=d).utils={calcRdx:c,isArray:l,isFunction:s,isNumber:m,toVector:function(n){return r.apply([],n)}},d._random_fn=i.random,d.setRandom=function(n){if("function"!=typeof n)throw new TypeError("fn is not a function");d._random_fn=n},d.extend=function(n){var r,t;if(1===arguments.length){for(t in n)d[t]=n[t];return this}for(r=1;r<arguments.length;r++)for(t in arguments[r])n[t]=arguments[r][t];return n},d.rows=function(n){return n.length||1},d.cols=function(n){return n[0].length||1},d.dimensions=function(n){return{rows:d.rows(n),cols:d.cols(n)}},d.row=function(r,n){return l(n)?n.map(function(n){return d.row(r,n)}):r[n]},d.rowa=function(n,r){return d.row(n,r)},d.col=function(e,n){if(l(n)){var o=d.arange(e.length).map(function(){return new Array(n.length)});return n.forEach(function(r,t){d.arange(e.length).forEach(function(n){o[n][t]=e[n][r]})}),o}for(var r=new Array(e.length),t=0;t<e.length;t++)r[t]=[e[t][n]];return r},d.cola=function(n,r){return d.col(n,r).map(function(n){return n[0]})},d.diag=function(n){for(var r=d.rows(n),t=new Array(r),e=0;e<r;e++)t[e]=[n[e][e]];return t},d.antidiag=function(n){for(var r=d.rows(n)-1,t=new Array(r),e=0;0<=r;r--,e++)t[e]=[n[e][r]];return t},d.transpose=function(n){for(var r,t,e=[],o=(n=!l(n[0])?[n]:n).length,u=n[0].length,a=0;a<u;a++){for(r=new Array(o),t=0;t<o;t++)r[t]=n[t][a];e.push(r)}return 1===e.length?e[0]:e},d.map=function(n,r,t){for(var e,o=(n=!l(n[0])?[n]:n).length,u=n[0].length,a=t?n:new Array(o),i=0;i<o;i++)for(a[i]||(a[i]=new Array(u)),e=0;e<u;e++)a[i][e]=r(n[i][e],i,e);return 1===a.length?a[0]:a},d.cumreduce=function(n,r,t){for(var e,o=(n=!l(n[0])?[n]:n).length,u=n[0].length,a=t?n:new Array(o),i=0;i<o;i++)for(a[i]||(a[i]=new Array(u)),0<u&&(a[i][0]=n[i][0]),e=1;e<u;e++)a[i][e]=r(a[i][e-1],n[i][e]);return 1===a.length?a[0]:a},d.alter=function(n,r){return d.map(n,r,!0)},d.create=function(n,r,t){var e,o,u=new Array(n);for(s(r)&&(t=r,r=n),e=0;e<n;e++)for(u[e]=new Array(r),o=0;o<r;o++)u[e][o]=t(e,o);return u},d.zeros=function(n,r){return m(r)||(r=n),d.create(n,r,e)},d.ones=function(n,r){return m(r)||(r=n),d.create(n,r,o)},d.rand=function(n,r){return m(r)||(r=n),d.create(n,r,d._random_fn)},d.identity=function(n,r){return m(r)||(r=n),d.create(n,r,u)},d.symmetric=function(n){var r,t,e=n.length;if(n.length!==n[0].length)return!1;for(r=0;r<e;r++)for(t=0;t<e;t++)if(n[t][r]!==n[r][t])return!1;return!0},d.clear=function(n){return d.alter(n,e)},d.seq=function(n,r,t,e){s(e)||(e=!1);for(var o=[],u=c(n,r),a=(r*u-n*u)/((t-1)*u),i=n,f=0;i<=r&&f<t;i=(n*u+a*u*++f)/u)o.push(e?e(i,f):i);return o},d.arange=function(n,r,t){var e,o=[];if(t=t||1,r===f&&(r=n,n=0),n===r||0===t)return[];if(n<r&&t<0)return[];if(r<n&&0<t)return[];if(0<t)for(e=n;e<r;e+=t)o.push(e);else for(e=n;r<e;e+=t)o.push(e);return o},d.slice=function(n,r){var t,e;return m((r=r||{}).row)?m(r.col)?n[r.row][r.col]:a(d.rowa(n,r.row),(t=r.col||{}).start,t.end,t.step):m(r.col)?a(d.cola(n,r.col),(e=r.row||{}).start,e.end,e.step):(e=r.row||{},t=r.col||{},a(n,e.start,e.end,e.step).map(function(n){return a(n,t.start,t.end,t.step)}))},d.sliceAssign=function(o,n,u){if(m(n.row)){if(m(n.col))return o[n.row][n.col]=u;n.col=n.col||{},n.col.start=n.col.start||0,n.col.end=n.col.end||o[0].length,n.col.step=n.col.step||1;var r=d.arange(n.col.start,i.min(o.length,n.col.end),n.col.step),t=n.row;return r.forEach(function(n,r){o[t][n]=u[r]}),o}if(m(n.col)){n.row=n.row||{},n.row.start=n.row.start||0,n.row.end=n.row.end||o.length,n.row.step=n.row.step||1;var e=d.arange(n.row.start,i.min(o[0].length,n.row.end),n.row.step),a=n.col;return e.forEach(function(n,r){o[n][a]=u[r]}),o}return u[0].length===f&&(u=[u]),n.row.start=n.row.start||0,n.row.end=n.row.end||o.length,n.row.step=n.row.step||1,n.col.start=n.col.start||0,n.col.end=n.col.end||o[0].length,n.col.step=n.col.step||1,e=d.arange(n.row.start,i.min(o.length,n.row.end),n.row.step),r=d.arange(n.col.start,i.min(o[0].length,n.col.end),n.col.step),e.forEach(function(t,e){r.forEach(function(n,r){o[t][n]=u[e][r]})}),o},d.diagonal=function(n){var t=d.zeros(n.length,n.length);return n.forEach(function(n,r){t[r][r]=n}),t},d.copy=function(n){return n.map(function(n){return m(n)?n:n.map(function(n){return n})})};var p=d.prototype;return p.length=0,p.push=Array.prototype.push,p.sort=Array.prototype.sort,p.splice=Array.prototype.splice,p.slice=Array.prototype.slice,p.toArray=function(){return 1<this.length?n.call(this):n.call(this)[0]},p.map=function(n,r){return d(d.map(this,n,r))},p.cumreduce=function(n,r){return d(d.cumreduce(this,n,r))},p.alter=function(n){return d.alter(this,n),this},function(n){for(var r=0;r<n.length;r++)!function(e){p[e]=function(n){var r,t=this;return n?(setTimeout(function(){n.call(t,p[e].call(t))}),this):(r=d[e](this),l(r)?d(r):r)}}(n[r])}("transpose clear symmetric rows cols dimensions diag antidiag".split(" ")),function(n){for(var r=0;r<n.length;r++)!function(e){p[e]=function(n,r){var t=this;return r?(setTimeout(function(){r.call(t,p[e].call(t,n))}),this):d(d[e](this,n))}}(n[r])}("row col".split(" ")),function(n){for(var r=0;r<n.length;r++)!function(n){p[n]=function(){return d(d[n].apply(null,arguments))}}(n[r])}("create zeros ones rand identity".split(" ")),d}(Math);function a(n,r,t,e){for(var o,u=0,a=1,i=1,f=1,c=0,l=0;q.abs((i-l)/i)>e;)a=f+(o=-(r+c)*(r+t+c)*n/(r+2*c)/(r+2*c+1))*a,i=(u=(l=i)+o*u)+(o=(c+=1)*(t-c)*n/(r+2*c-1)/(r+2*c))*i,u/=f=a+o*f,a/=f,i/=f,f=1;return i/r}function v(n,r,t){var e=[.9815606342467192,.9041172563704749,.7699026741943047,.5873179542866175,.3678314989981802,.1252334085114689],o=[.04717533638651183,.10693932599531843,.16007832854334622,.20316742672306592,.2334925365383548,.24914704581340277],u=.5*n;if(8<=u)return 1;for(var a=(a=2*x.normal.cdf(u,0,1,1,0)-1)>=q.exp(-50/t)?q.pow(a,t):0,i=3<n?2:3,f=u,c=(8-u)/i,l=f+c,s=0,m=t-1,d=1;d<=i;d++){for(var p=0,g=.5*(l+f),h=.5*(l-f),v=1;v<=12;v++){var y,w=6<v?e[(y=12-v+1)-1]:-e[(y=v)-1],b=g+h*w,w=b*b;if(60<w)break;b=.5*(2*x.normal.cdf(b,0,1,1,0))-.5*(2*x.normal.cdf(b,n,1,1,0));b>=q.exp(-30/m)&&(p+=o[y-1]*q.exp(-.5*w)*q.pow(b,m))}s+=p*=2*h*t/q.sqrt(2*q.PI),f=l,l+=c}return(a+=s)<=q.exp(-30/r)?0:1<=(a=q.pow(a,r))?1:a}function y(n){return r(n)||n instanceof g}function w(n,r,t,e){if(1<n||1<t||n<=0||t<=0)throw new Error("Proportions should be greater than 0 and less than 1");var o=(n*r+t*e)/(r+e);return(n-t)/l.sqrt(o*(1-o)*(1/r+1/e))}function b(n,r){var t=n.length,e=r[0].length-1,o=t-e-1,u=m.lstsq(r,n),a=m.multiply(r,u.map(function(n){return[n]})).map(function(n){return n[0]}),i=m.subtract(n,a),f=m.mean(n),c=m.sum(a.map(function(n){return Math.pow(n-f,2)})),l=m.sum(n.map(function(n,r){return Math.pow(n-a[r],2)})),s=c+l;return{exog:r,endog:n,nobs:t,df_model:e,df_resid:o,coef:u,predict:a,resid:i,ybar:f,SST:s,SSE:c,SSR:l,R2:c/s}}function _(r){var t,e,n=(t=r.exog,e=t[0].length,m.arange(e).map(function(r){var n=m.arange(e).filter(function(n){return n!==r});return b(m.col(t,r).map(function(n){return n[0]}),m.col(t,n))})),o=Math.sqrt(r.SSR/r.df_resid),u=n.map(function(n){var r=n.SST,n=n.R2;return o/Math.sqrt(r*(1-n))}),a=r.coef.map(function(n,r){return+n/u[r]}),i=a.map(function(n){n=m.studentt.cdf(n,r.df_resid);return 2*(.5<n?1-n:n)}),f=m.studentt.inv(.975,r.df_resid),n=r.coef.map(function(n,r){r=f*u[r];return[n-r,n+r]});return{se:u,t:a,p:i,sigmaHat:o,interval95:n}}return function(f,l){var c=f.utils.isFunction;function s(n,r){return n-r}function m(n,r,t){return l.max(r,l.min(n,t))}f.sum=function(n){for(var r=0,t=n.length;0<=--t;)r+=n[t];return r},f.sumsqrd=function(n){for(var r=0,t=n.length;0<=--t;)r+=n[t]*n[t];return r},f.sumsqerr=function(n){for(var r,t=f.mean(n),e=0,o=n.length;0<=--o;)e+=(r=n[o]-t)*r;return e},f.sumrow=function(n){for(var r=0,t=n.length;0<=--t;)r+=n[t];return r},f.product=function(n){for(var r=1,t=n.length;0<=--t;)r*=n[t];return r},f.min=function(n){for(var r=n[0],t=0;++t<n.length;)n[t]<r&&(r=n[t]);return r},f.max=function(n){for(var r=n[0],t=0;++t<n.length;)n[t]>r&&(r=n[t]);return r},f.unique=function(n){for(var r={},t=[],e=0;e<n.length;e++)r[n[e]]||(r[n[e]]=!0,t.push(n[e]));return t},f.mean=function(n){return f.sum(n)/n.length},f.meansqerr=function(n){return f.sumsqerr(n)/n.length},f.geomean=function(n){return l.pow(f.product(n),1/n.length)},f.median=function(n){var r=n.length,n=n.slice().sort(s);return 1&r?n[r/2|0]:(n[r/2-1]+n[r/2])/2},f.cumsum=function(n){return f.cumreduce(n,function(n,r){return n+r})},f.cumprod=function(n){return f.cumreduce(n,function(n,r){return n*r})},f.diff=function(n){for(var r=[],t=n.length,e=1;e<t;e++)r.push(n[e]-n[e-1]);return r},f.rank=function(n){for(var r=[],t={},e=0;e<n.length;e++)t[i=n[e]]?t[i]++:(t[i]=1,r.push(i));var o=r.sort(s),u={},a=1;for(e=0;e<o.length;e++){var i,f=t[i=o[e]],c=a;u[i]=(c+(a+f-1))/2,a+=f}return n.map(function(n){return u[n]})},f.mode=function(n){for(var r=n.length,t=n.slice().sort(s),e=1,o=0,u=0,a=[],i=0;i<r;i++)t[i]===t[i+1]?e++:(o<e?(a=[t[i]],o=e,u=0):e===o&&(a.push(t[i]),u++),e=1);return 0===u?a[0]:a},f.range=function(n){return f.max(n)-f.min(n)},f.variance=function(n,r){return f.sumsqerr(n)/(n.length-(r?1:0))},f.pooledvariance=function(n){return n.reduce(function(n,r){return n+f.sumsqerr(r)},0)/(n.reduce(function(n,r){return n+r.length},0)-n.length)},f.deviation=function(n){for(var r=f.mean(n),t=n.length,e=new Array(t),o=0;o<t;o++)e[o]=n[o]-r;return e},f.stdev=function(n,r){return l.sqrt(f.variance(n,r))},f.pooledstdev=function(n){return l.sqrt(f.pooledvariance(n))},f.meandev=function(n){for(var r=f.mean(n),t=[],e=n.length-1;0<=e;e--)t.push(l.abs(n[e]-r));return f.mean(t)},f.meddev=function(n){for(var r=f.median(n),t=[],e=n.length-1;0<=e;e--)t.push(l.abs(n[e]-r));return f.median(t)},f.coeffvar=function(n){return f.stdev(n)/f.mean(n)},f.quartiles=function(n){var r=n.length,n=n.slice().sort(s);return[n[l.round(r/4)-1],n[l.round(r/2)-1],n[l.round(3*r/4)-1]]},f.quantiles=function(n,r,t,e){var o,u,a,i=n.slice().sort(s),f=[r.length],c=n.length;for(void 0===t&&(t=3/8),void 0===e&&(e=3/8),o=0;o<r.length;o++)u=r[o],u=l.floor(m(a=c*u+(t+u*(1-t-e)),1,c-1)),a=m(a-u,0,1),f[o]=(1-a)*i[u-1]+a*i[u];return f},f.percentile=function(n,r,t){n=n.slice().sort(s),r=r*(n.length+(t?1:-1))+(t?0:1),t=parseInt(r);return t+1<n.length?n[t-1]+(r-t)*(n[t]-n[t-1]):n[t-1]},f.percentileOfScore=function(n,r,t){for(var e,o=0,u=n.length,a="strict"===t?!0:!1,i=0;i<u;i++)e=n[i],(a&&e<r||!a&&e<=r)&&o++;return o/u},f.histogram=function(n,r){r=r||4;for(var t=f.min(n),e=(f.max(n)-t)/r,o=n.length,u=[],a=0;a<r;a++)u[a]=0;for(a=0;a<o;a++)u[l.min(l.floor((n[a]-t)/e),r-1)]+=1;return u},f.covariance=function(n,r){for(var t=f.mean(n),e=f.mean(r),o=n.length,u=new Array(o),a=0;a<o;a++)u[a]=(n[a]-t)*(r[a]-e);return f.sum(u)/(o-1)},f.corrcoeff=function(n,r){return f.covariance(n,r)/f.stdev(n,1)/f.stdev(r,1)},f.spearmancoeff=function(n,r){return n=f.rank(n),r=f.rank(r),f.corrcoeff(n,r)},f.stanMoment=function(n,r){for(var t=f.mean(n),e=f.stdev(n),o=n.length,u=0,a=0;a<o;a++)u+=l.pow((n[a]-t)/e,r);return u/n.length},f.skewness=function(n){return f.stanMoment(n,3)},f.kurtosis=function(n){return f.stanMoment(n,4)-3};var d=f.prototype;!function(n){for(var r=0;r<n.length;r++)!function(u){d[u]=function(n,r){var t=[],e=0,o=this;if(c(n)&&(r=n,n=!1),r)return setTimeout(function(){r.call(o,d[u].call(o,n))}),this;if(1<this.length){for(o=!0===n?this:this.transpose();e<o.length;e++)t[e]=f[u](o[e]);return t}return f[u](this[0],n)}}(n[r])}("cumsum cumprod".split(" ")),function(n){for(var r=0;r<n.length;r++)!function(u){d[u]=function(n,r){var t=[],e=0,o=this;if(c(n)&&(r=n,n=!1),r)return setTimeout(function(){r.call(o,d[u].call(o,n))}),this;if(1<this.length){for("sumrow"!==u&&(o=!0===n?this:this.transpose());e<o.length;e++)t[e]=f[u](o[e]);return!0===n?f[u](f.utils.toVector(t)):t}return f[u](this[0],n)}}(n[r])}("sum sumsqrd sumsqerr sumrow product min max unique mean meansqerr geomean median diff rank mode range variance deviation stdev meandev meddev coeffvar quartiles histogram skewness kurtosis".split(" ")),function(n){for(var r=0;r<n.length;r++)!function(i){d[i]=function(){var n=[],r=0,t=this,e=Array.prototype.slice.call(arguments);if(c(e[e.length-1])){var o=e[e.length-1],u=e.slice(0,e.length-1);return setTimeout(function(){o.call(t,d[i].apply(t,u))}),this}o=void 0;var a=function(n){return f[i].apply(t,[n].concat(e))};if(1<this.length){for(t=t.transpose();r<t.length;r++)n[r]=a(t[r]);return n}return a(this[0])}}(n[r])}("quantiles percentileOfScore".split(" "))}(m,Math),d=m,p=Math,d.gammaln=function(n){var r,t,e=0,o=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],u=1.000000000190015,n=(t=r=n)+5.5;for(n-=(r+.5)*p.log(n);e<6;e++)u+=o[e]/++t;return p.log(2.5066282746310007*u/r)-n},d.loggam=function(n){var r,t,e,o,u,a=[.08333333333333333,-.002777777777777778,.0007936507936507937,-.0005952380952380952,.0008417508417508418,-.001917526917526918,.00641025641025641,-.02955065359477124,.1796443723688307,-1.3924322169059],i=n,f=0;if(1==n||2==n)return 0;for(r=1/((i=n<=7?n+(f=p.floor(7-n)):i)*i),t=2*p.PI,o=a[9],u=8;0<=u;u--)o*=r,o+=a[u];if(e=o/i+.5*p.log(t)+(i-.5)*p.log(i)-i,n<=7)for(u=1;u<=f;u++)e-=p.log(i-1),--i;return e},d.gammafn=function(n){var r,t,e,o=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],u=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535],a=!1,i=0,f=0,c=0,l=n;if(171.6243769536076<n)return 1/0;if(l<=0){if(!(e=l%1+36e-17))return 1/0;a=(1&l?-1:1)*p.PI/p.sin(p.PI*e),l=1-l}for(t=(n=l)<1?l++:(l-=i=(0|l)-1)-1,r=0;r<8;++r)c=(c+o[r])*t,f=f*t+u[r];if(e=c/f+1,n<l)e/=n;else if(l<n)for(r=0;r<i;++r)e*=l,l++;return e=a?a/e:e},d.gammap=function(n,r){return d.lowRegGamma(n,r)*d.gammafn(n)},d.lowRegGamma=function(n,r){var t,e=d.gammaln(n),o=n,u=1/n,a=u,i=r+1-n,f=1/1e-30,c=1/i,l=c,s=1,m=-~(8.5*p.log(1<=n?n:1/n)+.4*n+17);if(r<0||n<=0)return NaN;if(r<n+1){for(;s<=m;s++)u+=a*=r/++o;return u*p.exp(-r+n*p.log(r)-e)}for(;s<=m;s++)l*=(c=1/(c=(t=-s*(s-n))*c+(i+=2)))*(f=i+t/f);return 1-l*p.exp(-r+n*p.log(r)-e)},d.factorialln=function(n){return n<0?NaN:d.gammaln(n+1)},d.factorial=function(n){return n<0?NaN:d.gammafn(n+1)},d.combination=function(n,r){return 170<n||170<r?p.exp(d.combinationln(n,r)):d.factorial(n)/d.factorial(r)/d.factorial(n-r)},d.combinationln=function(n,r){return d.factorialln(n)-d.factorialln(r)-d.factorialln(n-r)},d.permutation=function(n,r){return d.factorial(n)/d.factorial(n-r)},d.betafn=function(n,r){if(!(n<=0||r<=0))return 170<n+r?p.exp(d.betaln(n,r)):d.gammafn(n)*d.gammafn(r)/d.gammafn(n+r)},d.betaln=function(n,r){return d.gammaln(n)+d.gammaln(r)-d.gammaln(n+r)},d.betacf=function(n,r,t){for(var e,o,u=1e-30,a=1,i=r+t,f=r+1,c=r-1,l=1,s=1-i*n/f,m=s=1/(s=p.abs(s)<u?u:s);a<=100&&(m*=(s=1/(s=p.abs(s=1+(o=a*(t-a)*n/((c+(e=2*a))*(r+e)))*s)<u?u:s))*(l=p.abs(l=1+o/l)<u?u:l),m*=o=(s=1/(s=p.abs(s=1+(o=-(r+a)*(i+a)*n/((r+e)*(f+e)))*s)<u?u:s))*(l=p.abs(l=1+o/l)<u?u:l),!(p.abs(o-1)<3e-7));a++);return m},d.gammapinv=function(n,r){var t,e,o,u,a,i=0,f=r-1,c=d.gammaln(r);if(1<=n)return p.max(100,r+100*p.sqrt(r));if(n<=0)return 0;for(t=1<r?(u=p.log(f),a=p.exp(f*(u-1)-c),t=(2.30753+.27061*(e=p.sqrt(-2*p.log(n<.5?n:1-n))))/(1+e*(.99229+.04481*e))-e,p.max(.001,r*p.pow(1-1/(9*r)-(t=n<.5?-t:t)/(3*p.sqrt(r)),3))):n<(e=1-r*(.253+.12*r))?p.pow(n/e,1/r):1-p.log(1-(n-e)/(1-e));i<12;i++){if(t<=0)return 0;if((t-=e=(o=(d.lowRegGamma(r,t)-n)/(e=1<r?a*p.exp(-(t-f)+f*(p.log(t)-u)):p.exp(-t+f*p.log(t)-c)))/(1-.5*p.min(1,o*((r-1)/t-1))))<=0&&(t=.5*(t+e)),p.abs(e)<1e-8*t)break}return t},d.erf=function(n){var r,t,e,o=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,1.5626441722e-8,-8.5238095915e-8,6.529054439e-9,5.059343495e-9,-9.91364156e-10,-2.27365122e-10,96467911e-18,2394038e-18,-6886027e-18,894487e-18,313092e-18,-112708e-18,381e-18,7106e-18,-1523e-18,-94e-18,121e-18,-28e-18],u=o.length-1,a=!1,i=0,f=0;for(n<0&&(n=-n,a=!0),t=4*(r=2/(2+n))-2;0<u;u--)i=t*(e=i)-f+o[u],f=e;return n=r*p.exp(-n*n+.5*(o[0]+t*i)-f),a?n-1:1-n},d.erfc=function(n){return 1-d.erf(n)},d.erfcinv=function(n){var r,t,e,o,u=0;if(2<=n)return-100;if(n<=0)return 100;for(r=-.70711*((2.30753+.27061*(e=p.sqrt(-2*p.log((o=n<1?n:2-n)/2))))/(1+e*(.99229+.04481*e))-e);u<2;u++)r+=(t=d.erfc(r)-o)/(1.1283791670955126*p.exp(-r*r)-r*t);return n<1?r:-r},d.ibetainv=function(n,r,t){var e,o,u,a,i,f,c,l=r-1,s=t-1,m=0;if(n<=0)return 0;if(1<=n)return 1;for(u=1<=r&&1<=t?(u=(2.30753+.27061*(e=p.sqrt(-2*p.log(n<.5?n:1-n))))/(1+e*(.99229+.04481*e))-e,f=(u=n<.5?-u:u)*p.sqrt((a=(u*u-3)/6)+(i=2/(1/(2*r-1)+1/(2*t-1))))/i-(1/(2*t-1)-1/(2*r-1))*(a+5/6-2/(3*i)),r/(r+t*p.exp(2*f))):(a=p.log(r/(r+t)),i=p.log(t/(r+t)),n<(e=p.exp(r*a)/r)/(f=e+(o=p.exp(t*i)/t))?p.pow(r*f*n,1/r):1-p.pow(t*f*(1-n),1/t)),c=-d.gammaln(r)-d.gammaln(t)+d.gammaln(r+t);m<10;m++){if(0===u||1===u)return u;if(1<=(u=(u-=e=(o=(d.ibeta(u,r,t)-n)/(e=p.exp(l*p.log(u)+s*p.log(1-u)+c)))/(1-.5*p.min(1,o*(l/u-s/(1-u)))))<=0?.5*(u+e):u)&&(u=.5*(u+e+1)),p.abs(e)<1e-8*u&&0<m)break}return u},d.ibeta=function(n,r,t){var e=0===n||1===n?0:p.exp(d.gammaln(r+t)-d.gammaln(r)-d.gammaln(t)+r*p.log(n)+t*p.log(1-n));return!(n<0||1<n)&&(n<(r+1)/(r+t+2)?e*d.betacf(n,r,t)/r:1-e*d.betacf(1-n,t,r)/t)},d.randn=function(n,r){var t,e,o,u;if(r=r||n,n)return d.create(n,r,function(){return d.randn()});for(;t=d._random_fn(),e=1.7156*(d._random_fn()-.5),.27597<(u=(u=t-.449871)*u+(o=p.abs(e)+.386595)*(.196*o-.25472*u))&&(.27846<u||e*e>-4*p.log(t)*t*t););return e/t},d.randg=function(n,r,t){var e,o,u,a,i,f=n;if(t=t||r,n=n||1,r)return(t=d.zeros(r,t)).alter(function(){return d.randg(n)}),t;n<1&&(n+=1),e=n-1/3,o=1/p.sqrt(9*e);do{for(;(a=1+o*(i=d.randn()))<=0;);}while(a*=a*a,(u=d._random_fn())>1-.331*p.pow(i,4)&&p.log(u)>.5*i*i+e*(1-a+p.log(a)));if(n==f)return e*a;for(;0===(u=d._random_fn()););return p.pow(u,1/f)*e*a},function(n){for(var r=0;r<n.length;r++)!function(r){d.fn[r]=function(){return d(d.map(this,function(n){return d[r](n)}))}}(n[r])}("gammaln gammafn factorial factorialln".split(" ")),function(n){for(var r=0;r<n.length;r++)!function(n){d.fn[n]=function(){return d(d[n].apply(null,arguments))}}(n[r])}("randn".split(" ")),x=m,q=Math,function(n){for(var r=0;r<n.length;r++)!function(u){x[u]=function n(r,t,e){return this instanceof n?(this._a=r,this._b=t,this._c=e,this):new n(r,t,e)},x.fn[u]=function(n,r,t){t=x[u](n,r,t);return t.data=this,t},x[u].prototype.sample=function(n){var r=this._a,t=this._b,e=this._c;return n?x.alter(n,function(){return x[u].sample(r,t,e)}):x[u].sample(r,t,e)},function(n){for(var r=0;r<n.length;r++)!function(o){x[u].prototype[o]=function(n){var r=this._a,t=this._b,e=this._c;return"number"!=typeof(n=!n&&0!==n?this.data:n)?x.fn.map.call(n,function(n){return x[u][o](n,r,t,e)}):x[u][o](n,r,t,e)}}(n[r])}("pdf cdf inv".split(" ")),function(n){for(var r=0;r<n.length;r++)!function(n){x[u].prototype[n]=function(){return x[u][n](this._a,this._b,this._c)}}(n[r])}("mean median mode variance".split(" "))}(n[r])}("beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy laplace lognormal noncentralt normal pareto studentt weibull uniform binomial negbin hypgeom poisson triangular tukey arcsine".split(" ")),x.extend(x.beta,{pdf:function(n,r,t){return 1<n||n<0?0:1==r&&1==t?1:r<512&&t<512?q.pow(n,r-1)*q.pow(1-n,t-1)/x.betafn(r,t):q.exp((r-1)*q.log(n)+(t-1)*q.log(1-n)-x.betaln(r,t))},cdf:function(n,r,t){return 1<n||n<0?+(1<n):x.ibeta(n,r,t)},inv:function(n,r,t){return x.ibetainv(n,r,t)},mean:function(n,r){return n/(n+r)},median:function(n,r){return x.ibetainv(.5,n,r)},mode:function(n,r){return(n-1)/(n+r-2)},sample:function(n,r){n=x.randg(n);return n/(n+x.randg(r))},variance:function(n,r){return n*r/(q.pow(n+r,2)*(n+r+1))}}),x.extend(x.centralF,{pdf:function(n,r,t){return n<0?0:r<=2?0===n&&r<2?1/0:0===n&&2===r?1:1/x.betafn(r/2,t/2)*q.pow(r/t,r/2)*q.pow(n,r/2-1)*q.pow(1+r/t*n,-(r+t)/2):r*(t/(t+n*r))/2*x.binomial.pdf((r-2)/2,(r+t-2)/2,r*n/(t+n*r))},cdf:function(n,r,t){return n<0?0:x.ibeta(r*n/(r*n+t),r/2,t/2)},inv:function(n,r,t){return t/(r*(1/x.ibetainv(n,r/2,t/2)-1))},mean:function(n,r){return 2<r?r/(r-2):void 0},mode:function(n,r){return 2<n?r*(n-2)/(n*(r+2)):void 0},sample:function(n,r){return 2*x.randg(n/2)/n/(2*x.randg(r/2)/r)},variance:function(n,r){if(!(r<=4))return 2*r*r*(n+r-2)/(n*(r-2)*(r-2)*(r-4))}}),x.extend(x.cauchy,{pdf:function(n,r,t){return t<0?0:t/(q.pow(n-r,2)+q.pow(t,2))/q.PI},cdf:function(n,r,t){return q.atan((n-r)/t)/q.PI+.5},inv:function(n,r,t){return r+t*q.tan(q.PI*(n-.5))},median:function(n){return n},mode:function(n){return n},sample:function(n,r){return x.randn()*q.sqrt(1/(2*x.randg(.5)))*r+n}}),x.extend(x.chisquare,{pdf:function(n,r){return n<0?0:0===n&&2===r?.5:q.exp((r/2-1)*q.log(n)-n/2-r/2*q.log(2)-x.gammaln(r/2))},cdf:function(n,r){return n<0?0:x.lowRegGamma(r/2,n/2)},inv:function(n,r){return 2*x.gammapinv(n,.5*r)},mean:function(n){return n},median:function(n){return n*q.pow(1-2/(9*n),3)},mode:function(n){return 0<n-2?n-2:0},sample:function(n){return 2*x.randg(n/2)},variance:function(n){return 2*n}}),x.extend(x.exponential,{pdf:function(n,r){return n<0?0:r*q.exp(-r*n)},cdf:function(n,r){return n<0?0:1-q.exp(-r*n)},inv:function(n,r){return-q.log(1-n)/r},mean:function(n){return 1/n},median:function(n){return 1/n*q.log(2)},mode:function(){return 0},sample:function(n){return-1/n*q.log(x._random_fn())},variance:function(n){return q.pow(n,-2)}}),x.extend(x.gamma,{pdf:function(n,r,t){return n<0?0:0===n&&1===r?1/t:q.exp((r-1)*q.log(n)-n/t-x.gammaln(r)-r*q.log(t))},cdf:function(n,r,t){return n<0?0:x.lowRegGamma(r,n/t)},inv:function(n,r,t){return x.gammapinv(n,r)*t},mean:function(n,r){return n*r},mode:function(n,r){if(1<n)return(n-1)*r},sample:function(n,r){return x.randg(n)*r},variance:function(n,r){return n*r*r}}),x.extend(x.invgamma,{pdf:function(n,r,t){return n<=0?0:q.exp(-(r+1)*q.log(n)-t/n-x.gammaln(r)+r*q.log(t))},cdf:function(n,r,t){return n<=0?0:1-x.lowRegGamma(r,t/n)},inv:function(n,r,t){return t/x.gammapinv(1-n,r)},mean:function(n,r){return 1<n?r/(n-1):void 0},mode:function(n,r){return r/(n+1)},sample:function(n,r){return r/x.randg(n)},variance:function(n,r){if(!(n<=2))return r*r/((n-1)*(n-1)*(n-2))}}),x.extend(x.kumaraswamy,{pdf:function(n,r,t){return 0===n&&1===r?t:1===n&&1===t?r:q.exp(q.log(r)+q.log(t)+(r-1)*q.log(n)+(t-1)*q.log(1-q.pow(n,r)))},cdf:function(n,r,t){return n<0?0:1<n?1:1-q.pow(1-q.pow(n,r),t)},inv:function(n,r,t){return q.pow(1-q.pow(1-n,1/t),1/r)},mean:function(n,r){return r*x.gammafn(1+1/n)*x.gammafn(r)/x.gammafn(1+1/n+r)},median:function(n,r){return q.pow(1-q.pow(2,-1/r),1/n)},mode:function(n,r){if(1<=n&&1<=r&&1!==n&&1!==r)return q.pow((n-1)/(n*r-1),1/n)},variance:function(){throw new Error("variance not yet implemented")}}),x.extend(x.lognormal,{pdf:function(n,r,t){return n<=0?0:q.exp(-q.log(n)-.5*q.log(2*q.PI)-q.log(t)-q.pow(q.log(n)-r,2)/(2*t*t))},cdf:function(n,r,t){return n<0?0:.5+.5*x.erf((q.log(n)-r)/q.sqrt(2*t*t))},inv:function(n,r,t){return q.exp(-1.4142135623730951*t*x.erfcinv(2*n)+r)},mean:function(n,r){return q.exp(n+r*r/2)},median:function(n){return q.exp(n)},mode:function(n,r){return q.exp(n-r*r)},sample:function(n,r){return q.exp(x.randn()*r+n)},variance:function(n,r){return(q.exp(r*r)-1)*q.exp(2*n+r*r)}}),x.extend(x.noncentralt,{pdf:function(n,r,t){return q.abs(t)<1e-14?x.studentt.pdf(n,r):q.abs(n)<1e-14?q.exp(x.gammaln((r+1)/2)-t*t/2-.5*q.log(q.PI*r)-x.gammaln(r/2)):r/n*(x.noncentralt.cdf(n*q.sqrt(1+2/r),r+2,t)-x.noncentralt.cdf(n,r,t))},cdf:function(n,r,t){var e=1e-14;if(q.abs(t)<e)return x.studentt.cdf(n,r);var o=!1;n<0&&(o=!0,t=-t);for(var u=x.normal.cdf(-t,0,1),a=1+e,i=a,f=n*n/(n*n+r),c=0,l=q.exp(-t*t/2),s=q.exp(-t*t/2-.5*q.log(2)-x.gammaln(1.5))*t;c<200||e<i||e<a;)i=a,0<c&&(l*=t*t/(2*c),s*=t*t/(2*(c+.5))),u+=.5*(a=l*x.beta.cdf(f,c+.5,r/2)+s*x.beta.cdf(f,c+1,r/2)),c++;return o?1-u:u}}),x.extend(x.normal,{pdf:function(n,r,t){return q.exp(-.5*q.log(2*q.PI)-q.log(t)-q.pow(n-r,2)/(2*t*t))},cdf:function(n,r,t){return.5*(1+x.erf((n-r)/q.sqrt(2*t*t)))},inv:function(n,r,t){return-1.4142135623730951*t*x.erfcinv(2*n)+r},mean:function(n){return n},median:function(n){return n},mode:function(n){return n},sample:function(n,r){return x.randn()*r+n},variance:function(n,r){return r*r}}),x.extend(x.pareto,{pdf:function(n,r,t){return n<r?0:t*q.pow(r,t)/q.pow(n,t+1)},cdf:function(n,r,t){return n<r?0:1-q.pow(r/n,t)},inv:function(n,r,t){return r/q.pow(1-n,1/t)},mean:function(n,r){if(!(r<=1))return r*q.pow(n,r)/(r-1)},median:function(n,r){return n*(r*q.SQRT2)},mode:function(n){return n},variance:function(n,r){if(!(r<=2))return n*n*r/(q.pow(r-1,2)*(r-2))}}),x.extend(x.studentt,{pdf:function(n,r){return 1/(q.sqrt(r=1e100<r?1e100:r)*x.betafn(.5,r/2))*q.pow(1+n*n/r,-(r+1)/2)},cdf:function(n,r){var t=r/2;return x.ibeta((n+q.sqrt(n*n+r))/(2*q.sqrt(n*n+r)),t,t)},inv:function(n,r){var t=x.ibetainv(2*q.min(n,1-n),.5*r,.5),t=q.sqrt(r*(1-t)/t);return.5<n?t:-t},mean:function(n){return 1<n?0:void 0},median:function(){return 0},mode:function(){return 0},sample:function(n){return x.randn()*q.sqrt(n/(2*x.randg(n/2)))},variance:function(n){return 2<n?n/(n-2):1<n?1/0:void 0}}),x.extend(x.weibull,{pdf:function(n,r,t){return n<0||r<0||t<0?0:t/r*q.pow(n/r,t-1)*q.exp(-q.pow(n/r,t))},cdf:function(n,r,t){return n<0?0:1-q.exp(-q.pow(n/r,t))},inv:function(n,r,t){return r*q.pow(-q.log(1-n),1/t)},mean:function(n,r){return n*x.gammafn(1+1/r)},median:function(n,r){return n*q.pow(q.log(2),1/r)},mode:function(n,r){return r<=1?0:n*q.pow((r-1)/r,1/r)},sample:function(n,r){return n*q.pow(-q.log(x._random_fn()),1/r)},variance:function(n,r){return n*n*x.gammafn(1+2/r)-q.pow(x.weibull.mean(n,r),2)}}),x.extend(x.uniform,{pdf:function(n,r,t){return n<r||t<n?0:1/(t-r)},cdf:function(n,r,t){return n<r?0:n<t?(n-r)/(t-r):1},inv:function(n,r,t){return r+n*(t-r)},mean:function(n,r){return.5*(n+r)},median:function(n,r){return x.mean(n,r)},mode:function(){throw new Error("mode is not yet implemented")},sample:function(n,r){return n/2+r/2+(r/2-n/2)*(2*x._random_fn()-1)},variance:function(n,r){return q.pow(r-n,2)/12}}),x.extend(x.binomial,{pdf:function(n,r,t){return 0===t||1===t?r*t===n?1:0:x.combination(r,n)*q.pow(t,n)*q.pow(1-t,r-n)},cdf:function(n,r,t){var e=1e-10;if(n<0)return 0;if(r<=n)return 1;if(t<0||1<t||r<=0)return NaN;var o=t,u=(n=q.floor(n))+1,t=r-n,r=u+t,n=q.exp(x.gammaln(r)-x.gammaln(t)-x.gammaln(u)+u*q.log(o)+t*q.log(1-o)),e=o<(u+1)/(r+2)?n*a(o,u,t,e):1-n*a(1-o,t,u,e);return q.round(1e10*(1-e))/1e10}}),x.extend(x.negbin,{pdf:function(n,r,t){return n===n>>>0&&(n<0?0:x.combination(n+r-1,r-1)*q.pow(1-t,n)*q.pow(t,r))},cdf:function(n,r,t){var e=0,o=0;if(n<0)return 0;for(;o<=n;o++)e+=x.negbin.pdf(o,r,t);return e}}),x.extend(x.hypgeom,{pdf:function(n,r,t,e){if(n!=n|0)return!1;if(n<0||n<t-(r-e))return 0;if(e<n||t<n)return 0;if(r<2*t)return r<2*e?x.hypgeom.pdf(r-t-e+n,r,r-t,r-e):x.hypgeom.pdf(e-n,r,r-t,e);if(r<2*e)return x.hypgeom.pdf(t-n,r,t,r-e);if(t<e)return x.hypgeom.pdf(n,r,e,t);for(var o=1,u=0,a=0;a<n;a++){for(;1<o&&u<e;)o*=1-t/(r-u),u++;o*=(e-a)*(t-a)/((a+1)*(r-t-e+a+1))}for(;u<e;u++)o*=1-t/(r-u);return q.min(1,q.max(0,o))},cdf:function(n,r,t,e){if(n<0||n<t-(r-e))return 0;if(e<=n||t<=n)return 1;if(r<2*t)return r<2*e?x.hypgeom.cdf(r-t-e+n,r,r-t,r-e):1-x.hypgeom.cdf(e-n-1,r,r-t,e);if(r<2*e)return 1-x.hypgeom.cdf(t-n-1,r,t,r-e);if(t<e)return x.hypgeom.cdf(n,r,e,t);for(var o=1,u=1,a=0,i=0;i<n;i++){for(;1<o&&a<e;){var f=1-t/(r-a);u*=f,o*=f,a++}o+=u*=(e-i)*(t-i)/((i+1)*(r-t-e+i+1))}for(;a<e;a++)o*=1-t/(r-a);return q.min(1,q.max(0,o))}}),x.extend(x.poisson,{pdf:function(n,r){return r<0||n%1!=0||n<0?0:q.pow(r,n)*q.exp(-r)/x.factorial(n)},cdf:function(n,r){var t=[],e=0;if(n<0)return 0;for(;e<=n;e++)t.push(x.poisson.pdf(e,r));return x.sum(t)},mean:function(n){return n},variance:function(n){return n},sampleSmall:function(n){for(var r=1,t=0,e=q.exp(-n);t++,e<(r*=x._random_fn()););return t-1},sampleLarge:function(n){for(var r,t,e,o=n,n=q.sqrt(o),u=q.log(o),a=.931+2.53*n,i=.02483*a-.059,f=1.1239+1.1328/(a-3.4),c=.9277-3.6224/(a-2);;){if(r=q.random()-.5,t=q.random(),e=.5-q.abs(r),r=q.floor((2*i/e+a)*r+o+.43),.07<=e&&t<=c)return r;if(!(r<0||e<.013&&e<t)&&q.log(t)+q.log(f)-q.log(i/(e*e)+a)<=r*u-o-x.loggam(r+1))return r}},sample:function(n){return n<10?this.sampleSmall(n):this.sampleLarge(n)}}),x.extend(x.triangular,{pdf:function(n,r,t,e){return t<=r||e<r||t<e?NaN:n<r||t<n?0:n<e?2*(n-r)/((t-r)*(e-r)):n===e?2/(t-r):2*(t-n)/((t-r)*(t-e))},cdf:function(n,r,t,e){return t<=r||e<r||t<e?NaN:n<=r?0:t<=n?1:n<=e?q.pow(n-r,2)/((t-r)*(e-r)):1-q.pow(t-n,2)/((t-r)*(t-e))},inv:function(n,r,t,e){return t<=r||e<r||t<e?NaN:n<=(e-r)/(t-r)?r+(t-r)*q.sqrt(n*((e-r)/(t-r))):r+(t-r)*(1-q.sqrt((1-n)*(1-(e-r)/(t-r))))},mean:function(n,r,t){return(n+r+t)/3},median:function(n,r,t){return t<=(n+r)/2?r-q.sqrt((r-n)*(r-t))/q.sqrt(2):(n+r)/2<t?n+q.sqrt((r-n)*(t-n))/q.sqrt(2):void 0},mode:function(n,r,t){return t},sample:function(n,r,t){var e=x._random_fn();return e<(t-n)/(r-n)?n+q.sqrt(e*(r-n)*(t-n)):r-q.sqrt((1-e)*(r-n)*(r-t))},variance:function(n,r,t){return(n*n+r*r+t*t-n*r-n*t-r*t)/18}}),x.extend(x.arcsine,{pdf:function(n,r,t){return t<=r?NaN:n<=r||t<=n?0:2/q.PI*q.pow(q.pow(t-r,2)-q.pow(2*n-r-t,2),-.5)},cdf:function(n,r,t){return n<r?0:n<t?2/q.PI*q.asin(q.sqrt((n-r)/(t-r))):1},inv:function(n,r,t){return r+(.5-.5*q.cos(q.PI*n))*(t-r)},mean:function(n,r){return r<=n?NaN:(n+r)/2},median:function(n,r){return r<=n?NaN:(n+r)/2},mode:function(){throw new Error("mode is not yet implemented")},sample:function(n,r){return(n+r)/2+(r-n)/2*q.sin(2*q.PI*x.uniform.sample(0,1))},variance:function(n,r){return r<=n?NaN:q.pow(r-n,2)/8}}),x.extend(x.laplace,{pdf:function(n,r,t){return t<=0?0:q.exp(-q.abs(n-r)/t)/(2*t)},cdf:function(n,r,t){return t<=0?0:n<r?.5*q.exp((n-r)/t):1-.5*q.exp(-(n-r)/t)},mean:function(n){return n},median:function(n){return n},mode:function(n){return n},variance:function(n,r){return 2*r*r},sample:function(n,r){var t=x._random_fn()-.5;return n-r*(t/q.abs(t))*q.log(1-2*q.abs(t))}}),x.extend(x.tukey,{cdf:function(n,r,t){var e=r,o=[.9894009349916499,.9445750230732326,.8656312023878318,.755404408355003,.6178762444026438,.45801677765722737,.2816035507792589,.09501250983763744],u=[.027152459411754096,.062253523938647894,.09515851168249279,.12462897125553388,.14959598881657674,.16915651939500254,.18260341504492358,.1894506104550685];if(n<=0)return 0;if(t<2||e<2)return NaN;if(!Number.isFinite(n))return 1;if(25e3<t)return v(n,1,e);var r=.5*t,a=r*q.log(t)-t*q.log(2)-x.gammaln(r),i=r-1,f=.25*t,c=t<=100?1:t<=800?.5:t<=5e3?.25:.125;a+=q.log(c);for(var l=0,s=1;s<=50;s++){for(var m=0,d=(2*s-1)*c,p=1;p<=16;p++){var g,h=8<p?a+i*q.log(d+o[g=p-8-1]*c)-(o[g]*c+d)*f:a+i*q.log(d-o[g=p-1]*c)+(o[g]*c-d)*f;-30<=h&&(m+=v(8<p?n*q.sqrt(.5*(o[g]*c+d)):n*q.sqrt(.5*(-o[g]*c+d)),1,e)*u[g]*q.exp(h))}if(1<=s*c&&m<=1e-14)break;l+=m}if(1e-14<m)throw new Error("tukey.cdf failed to converge");return l=1<l?1:l},inv:function(n,r,t){if(t<2||r<2)return NaN;if(n<0||1<n)return NaN;if(0===n)return 0;if(1===n)return 1/0;var e,o,u,a,i=(o=r,u=t,a=.5-.5*(e=n),a=(e=q.sqrt(q.log(1/(a*a))))+((((-453642210148e-16*e-.204231210125)*e-.342242088547)*e-1)*e+.322232421088)/((((.0038560700634*e+.10353775285)*e+.531103462366)*e+.588581570495)*e+.099348462606),u<120&&(a+=(a*a*a+a)/u/4),e=.8832-.2368*a,u<120&&(e+=-1.214/u+1.208*a/u),a*(e*q.log(o-1)+1.4142)),f=x.tukey.cdf(i,r,t)-n;m=0<f?q.max(0,i-1):i+1;for(var c,l=x.tukey.cdf(m,r,t)-n,s=1;s<50;s++){c=m-l*(m-i)/(l-f),f=l,i=m,c<0&&(c=0,l=-n);var l=x.tukey.cdf(c,r,t)-n,m=c;if(q.abs(m-i)<1e-4)return c}throw new Error("tukey.inv failed to converge")}}),g=m,h=Math,o=Array.prototype.push,r=g.utils.isArray,g.extend({add:function(n,e){return y(e)?(y(e[0])||(e=[e]),g.map(n,function(n,r,t){return n+e[r][t]})):g.map(n,function(n){return n+e})},subtract:function(n,e){return y(e)?(y(e[0])||(e=[e]),g.map(n,function(n,r,t){return n-e[r][t]||0})):g.map(n,function(n){return n-e})},divide:function(n,r){return y(r)?(y(r[0])||(r=[r]),g.multiply(n,g.inv(r))):g.map(n,function(n){return n/r})},multiply:function(n,r){var t,e,o,u,a,i,f,c;if(void 0===n.length&&void 0===r.length)return n*r;if(a=n.length,i=n[0].length,f=g.zeros(a,o=y(r)?r[0].length:i),c=0,y(r)){for(;c<o;c++)for(t=0;t<a;t++){for(e=u=0;e<i;e++)u+=n[t][e]*r[e][c];f[t][c]=u}return 1===a&&1===c?f[0][0]:f}return g.map(n,function(n){return n*r})},outer:function(n,r){return g.multiply(n.map(function(n){return[n]}),[r])},dot:function(n,r){y(n[0])||(n=[n]),y(r[0])||(r=[r]);for(var t,e,o=1===n[0].length&&1!==n.length?g.transpose(n):n,u=1===r[0].length&&1!==r.length?g.transpose(r):r,a=[],i=0,f=o.length,c=o[0].length;i<f;i++){for(a[i]=[],e=t=0;e<c;e++)t+=o[i][e]*u[i][e];a[i]=t}return 1===a.length?a[0]:a},pow:function(n,r){return g.map(n,function(n){return h.pow(n,r)})},exp:function(n){return g.map(n,function(n){return h.exp(n)})},log:function(n){return g.map(n,function(n){return h.log(n)})},abs:function(n){return g.map(n,function(n){return h.abs(n)})},norm:function(n,r){var t=0,e=0;for(isNaN(r)&&(r=2),y(n[0])&&(n=n[0]);e<n.length;e++)t+=h.pow(h.abs(n[e]),r);return h.pow(t,1/r)},angle:function(n,r){return h.acos(g.dot(n,r)/(g.norm(n)*g.norm(r)))},aug:function(n,r){for(var t=[],e=0;e<n.length;e++)t.push(n[e].slice());for(e=0;e<t.length;e++)o.apply(t[e],r[e]);return t},inv:function(n){for(var r,t=n.length,e=n[0].length,o=g.identity(t,e),u=g.gauss_jordan(n,o),a=[],i=0;i<t;i++)for(a[i]=[],r=e;r<u[0].length;r++)a[i][r-e]=u[i][r];return a},det:function(n){var r,t=n.length,e=2*t,o=new Array(e),u=t-1,a=e-1,i=u-t+1,f=a,c=0,l=0;if(2===t)return n[0][0]*n[1][1]-n[0][1]*n[1][0];for(;c<e;c++)o[c]=1;for(c=0;c<t;c++){for(r=0;r<t;r++)o[i<0?i+t:i]*=n[c][r],o[f<t?f+t:f]*=n[c][r],i++,f--;i=--u-t+1,f=--a}for(c=0;c<t;c++)l+=o[c];for(;c<e;c++)l-=o[c];return l},gauss_elimination:function(n,r){for(var t,e,o,u,a=0,i=0,f=n.length,c=n[0].length,l=0,s=[],m=(n=g.aug(n,r))[0].length,a=0;a<f;a++){for(e=n[a][a],u=(i=a)+1;u<c;u++)e<h.abs(n[u][a])&&(e=n[u][a],i=u);if(i!=a)for(u=0;u<m;u++)o=n[a][u],n[a][u]=n[i][u],n[i][u]=o;for(i=a+1;i<f;i++)for(t=n[i][a]/n[a][a],u=a;u<m;u++)n[i][u]=n[i][u]-t*n[a][u]}for(a=f-1;0<=a;a--){for(l=0,i=a+1;i<=f-1;i++)l+=s[i]*n[a][i];s[a]=(n[a][m-1]-l)/n[a][a]}return s},gauss_jordan:function(n,r){for(var t,e=g.aug(n,r),o=e.length,u=e[0].length,a=0,i=0;i<o;i++){for(var f=i,c=i+1;c<o;c++)h.abs(e[c][i])>h.abs(e[f][i])&&(f=c);var l=e[i];for(e[i]=e[f],e[f]=l,c=i+1;c<o;c++)for(a=e[c][i]/e[i][i],t=i;t<u;t++)e[c][t]-=e[i][t]*a}for(i=o-1;0<=i;i--){for(a=e[i][i],c=0;c<i;c++)for(t=u-1;i-1<t;t--)e[c][t]-=e[i][t]*e[c][i]/a;for(e[i][i]/=a,t=o;t<u;t++)e[i][t]/=a}return e},triaUpSolve:function(t,n){var e,o=t[0].length,u=g.zeros(1,o)[0],r=!1;return null!=n[0].length&&(n=n.map(function(n){return n[0]}),r=!0),g.arange(o-1,-1,-1).forEach(function(r){e=g.arange(r+1,o).map(function(n){return u[n]*t[r][n]}),u[r]=(n[r]-g.sum(e))/t[r][r]}),r?u.map(function(n){return[n]}):u},triaLowSolve:function(t,n){var e,r=t[0].length,o=g.zeros(1,r)[0],u=!1;return null!=n[0].length&&(n=n.map(function(n){return n[0]}),u=!0),g.arange(r).forEach(function(r){e=g.arange(r).map(function(n){return t[r][n]*o[n]}),o[r]=(n[r]-g.sum(e))/t[r][r]}),u?o.map(function(n){return[n]}):o},lu:function(e){var n,r=e.length,o=g.identity(r),u=g.zeros(e.length,e[0].length);return g.arange(r).forEach(function(n){u[0][n]=e[0][n]}),g.arange(1,r).forEach(function(t){g.arange(t).forEach(function(r){n=g.arange(r).map(function(n){return o[t][n]*u[n][r]}),o[t][r]=(e[t][r]-g.sum(n))/u[r][r]}),g.arange(t,r).forEach(function(r){n=g.arange(t).map(function(n){return o[t][n]*u[n][r]}),u[t][r]=e[n.length][r]-g.sum(n)})}),[o,u]},cholesky:function(n){var e,r=n.length,o=g.zeros(n.length,n[0].length);return g.arange(r).forEach(function(t){e=g.arange(t).map(function(n){return h.pow(o[t][n],2)}),o[t][t]=h.sqrt(n[t][t]-g.sum(e)),g.arange(t+1,r).forEach(function(r){e=g.arange(t).map(function(n){return o[t][n]*o[r][n]}),o[r][t]=(n[t][r]-g.sum(e))/o[t][t]})}),o},gauss_jacobi:function(n,r,t,e){for(var o,u,a,i,f=0,c=0,l=n.length,s=[],m=[],d=[];f<l;f++)for(s[f]=[],m[f]=[],d[f]=[],c=0;c<l;c++)c<f?(s[f][c]=n[f][c],m[f][c]=d[f][c]=0):f<c?(m[f][c]=n[f][c],s[f][c]=d[f][c]=0):(d[f][c]=n[f][c],s[f][c]=m[f][c]=0);for(a=g.multiply(g.multiply(g.inv(d),g.add(s,m)),-1),u=g.multiply(g.inv(d),r),i=g.add(g.multiply(a,o=t),u),f=2;h.abs(g.norm(g.subtract(i,o)))>e;)o=i,i=g.add(g.multiply(a,o),u),f++;return i},gauss_seidel:function(n,r,t,e){for(var o,u,a,i,f,c=0,l=n.length,s=[],m=[],d=[];c<l;c++)for(s[c]=[],m[c]=[],d[c]=[],o=0;o<l;o++)o<c?(s[c][o]=n[c][o],m[c][o]=d[c][o]=0):c<o?(m[c][o]=n[c][o],s[c][o]=d[c][o]=0):(d[c][o]=n[c][o],s[c][o]=m[c][o]=0);for(i=g.multiply(g.multiply(g.inv(g.add(d,s)),m),-1),a=g.multiply(g.inv(g.add(d,s)),r),f=g.add(g.multiply(i,u=t),a),c=2;h.abs(g.norm(g.subtract(f,u)))>e;)u=f,f=g.add(g.multiply(i,u),a),c+=1;return f},SOR:function(n,r,t,e,o){for(var u,a,i,f,c,l=0,s=n.length,m=[],d=[],p=[];l<s;l++)for(m[l]=[],d[l]=[],p[l]=[],u=0;u<s;u++)u<l?(m[l][u]=n[l][u],d[l][u]=p[l][u]=0):l<u?(d[l][u]=n[l][u],m[l][u]=p[l][u]=0):(p[l][u]=n[l][u],m[l][u]=d[l][u]=0);for(f=g.multiply(g.inv(g.add(p,g.multiply(m,o))),g.subtract(g.multiply(p,1-o),g.multiply(d,o))),i=g.multiply(g.multiply(g.inv(g.add(p,g.multiply(m,o))),r),o),c=g.add(g.multiply(f,a=t),i),l=2;h.abs(g.norm(g.subtract(c,a)))>e;)a=c,c=g.add(g.multiply(f,a),i),l++;return c},householder:function(n){for(var r,t,e,o,u,a=n.length,i=n[0].length,f=0,c=[];f<a-1;f++){for(t=0,u=f+1;u<i;u++)t+=n[u][f]*n[u][f];for(t=(0<n[f+1][f]?-1:1)*h.sqrt(t),e=h.sqrt((t*t-n[f+1][f]*t)/2),(c=g.zeros(a,1))[f+1][0]=(n[f+1][f]-t)/(2*e),o=f+2;o<a;o++)c[o][0]=n[o][f]/(2*e);r=g.subtract(g.identity(a,i),g.multiply(g.multiply(c,g.transpose(c)),2)),n=g.multiply(r,g.multiply(n,r))}return n},QR:(i=g.sum,f=g.arange,function(r){var n,t,e,o=r.length,u=r[0].length,a=g.zeros(u,u);for(r=g.copy(r),t=0;t<u;t++){for(a[t][t]=h.sqrt(i(f(o).map(function(n){return r[n][t]*r[n][t]}))),n=0;n<o;n++)r[n][t]=r[n][t]/a[t][t];for(e=t+1;e<u;e++)for(a[t][e]=i(f(o).map(function(n){return r[n][t]*r[n][e]})),n=0;n<o;n++)r[n][e]=r[n][e]-r[n][t]*a[t][e]}return[r,a]}),lstsq:function(n,r){var t=!1;void 0===r[0].length&&(r=r.map(function(n){return[n]}),t=!0);var u,a,e=(o=g.QR(n))[0],o=o[1],n=n[0].length,e=g.slice(e,{col:{end:n}}),n=g.slice(o,{row:{end:n}}),n=(u=n,n=(u=g.copy(u)).length,a=g.identity(n),g.arange(n-1,-1,-1).forEach(function(o){g.sliceAssign(a,{row:o},g.divide(g.slice(a,{row:o}),u[o][o])),g.sliceAssign(u,{row:o},g.divide(g.slice(u,{row:o}),u[o][o])),g.arange(o).forEach(function(n){var r=g.multiply(u[n][o],-1),t=g.slice(u,{row:n}),e=g.multiply(g.slice(u,{row:o}),r);g.sliceAssign(u,{row:n},g.add(t,e));e=g.slice(a,{row:n}),r=g.multiply(g.slice(a,{row:o}),r);g.sliceAssign(a,{row:n},g.add(e,r))})}),a);return void 0===(e=g.transpose(e))[0].length&&(e=[e]),void 0===(r=g.multiply(g.multiply(n,e),r)).length&&(r=[[r]]),t?r.map(function(n){return n[0]}):r},jacobi:function(n){for(var r,t,e,o,u,a,i,f=1,c=n.length,l=g.identity(c,c),s=[];1===f;){for(u=n[0][1],o=1,r=e=0;r<c;r++)for(t=0;t<c;t++)r!=t&&u<h.abs(n[r][t])&&(u=h.abs(n[r][t]),e=r,o=t);for(a=n[e][e]===n[o][o]?0<n[e][o]?h.PI/4:-h.PI/4:h.atan(2*n[e][o]/(n[e][e]-n[o][o]))/2,(i=g.identity(c,c))[e][e]=h.cos(a),i[e][o]=-h.sin(a),i[o][e]=h.sin(a),i[o][o]=h.cos(a),l=g.multiply(l,i),n=g.multiply(g.multiply(g.inv(i),n),i),f=0,r=1;r<c;r++)for(t=1;t<c;t++)r!=t&&.001<h.abs(n[r][t])&&(f=1)}for(r=0;r<c;r++)s.push(n[r][r]);return[l,s]},rungekutta:function(n,r,t,e,o,u){var a,i,f;if(2===u)for(;e<=t;)o=o+((a=r*n(e,o))+(i=r*n(e+r,o+a)))/2,e+=r;if(4===u)for(;e<=t;)o=o+((a=r*n(e,o))+2*(i=r*n(e+r/2,o+a/2))+2*(f=r*n(e+r/2,o+i/2))+r*n(e+r,o+f))/6,e+=r;return o},romberg:function(n,r,t,e){for(var o,u,a,i,f,c=0,l=(t-r)/2,s=[],m=[],d=[];c<e/2;){for(f=n(r),a=r,i=0;a<=t;a+=l,i++)s[i]=a;for(o=s.length,a=1;a<o-1;a++)f+=(a%2!=0?4:2)*n(s[a]);f=l/3*(f+n(t)),d[c]=f,l/=2,c++}for(u=d.length,o=1;1!==u;){for(a=0;a<u-1;a++)m[a]=(h.pow(4,o)*d[a+1]-d[a])/(h.pow(4,o)-1);u=m.length,d=m,m=[],o++}return d},richardson:function(n,r,t,e){function o(n,r){for(var t,e=0,o=n.length;e<o;e++)n[e]===r&&(t=e);return t}for(var u,a,i,f,c,l=h.abs(t-n[o(n,t)+1]),s=0,m=[],d=[];l<=e;)u=o(n,t+e),a=o(n,t),m[s]=(r[u]-2*r[a]+r[2*a-u])/(e*e),e/=2,s++;for(f=m.length,i=1;1!=f;){for(c=0;c<f-1;c++)d[c]=(h.pow(4,i)*m[c+1]-m[c])/(h.pow(4,i)-1);f=d.length,m=d,d=[],i++}return m},simpson:function(n,r,t,e){for(var o,u=(t-r)/e,a=n(r),i=[],f=r,c=0,l=1;f<=t;f+=u,c++)i[c]=f;for(o=i.length;l<o-1;l++)a+=(l%2!=0?4:2)*n(i[l]);return u/3*(a+n(t))},hermite:function(n,r,t,e){for(var o,u=n.length,a=0,i=0,f=[],c=[],l=[],s=[];i<u;i++){for(f[i]=1,o=0;o<u;o++)i!=o&&(f[i]*=(e-n[o])/(n[i]-n[o]));for(o=c[i]=0;o<u;o++)i!=o&&(c[i]+=1/(n[i]-n[o]));l[i]=(1-2*(e-n[i])*c[i])*(f[i]*f[i]),s[i]=(e-n[i])*(f[i]*f[i]),a+=l[i]*r[i]+s[i]*t[i]}return a},lagrange:function(n,r,t){for(var e,o,u=0,a=0,i=n.length;a<i;a++){for(o=r[a],e=0;e<i;e++)a!=e&&(o*=(t-n[e])/(n[a]-n[e]));u+=o}return u},cubic_spline:function(n,r,t){for(var e,o,u=n.length,a=0,i=[],f=[],c=[],l=[],s=[],m=[];a<u-1;a++)l[a]=n[a+1]-n[a];for(c[0]=0,a=1;a<u-1;a++)c[a]=3/l[a]*(r[a+1]-r[a])-3/l[a-1]*(r[a]-r[a-1]);for(a=1;a<u-1;a++)i[a]=[],f[a]=[],i[a][a-1]=l[a-1],i[a][a]=2*(l[a-1]+l[a]),i[a][a+1]=l[a],f[a][0]=c[a];for(o=g.multiply(g.inv(i),f),e=0;e<u-1;e++)s[e]=(r[e+1]-r[e])/l[e]-l[e]*(o[e+1][0]+2*o[e][0])/3,m[e]=(o[e+1][0]-o[e][0])/(3*l[e]);for(e=0;e<u&&!(n[e]>t);e++);return r[--e]+(t-n[e])*s[e]+g.sq(t-n[e])*o[e]+(t-n[e])*g.sq(t-n[e])*m[e]},gauss_quadrature:function(){throw new Error("gauss_quadrature not yet implemented")},PCA:function(n){for(var r,t,e,o,u,a=n.length,i=n[0].length,f=0,c=[],l=[],s=[],m=[],d=[],p=[],f=0;f<a;f++)c[f]=g.sum(n[f])/i;for(f=0;f<i;f++)for(m[f]=[],r=0;r<a;r++)m[f][r]=n[r][f]-c[r];for(m=g.transpose(m),f=0;f<a;f++)for(d[f]=[],r=0;r<a;r++)d[f][r]=g.dot([m[f]],[m[r]])/(i-1);for(u=(t=g.jacobi(d))[0],l=t[1],p=g.transpose(u),f=0;f<l.length;f++)for(r=f;r<l.length;r++)l[f]<l[r]&&(e=l[f],l[f]=l[r],l[r]=e,e=p[f],p[f]=p[r],p[r]=e);for(o=g.transpose(m),f=0;f<a;f++)for(s[f]=[],r=0;r<o.length;r++)s[f][r]=g.dot([p[f]],[o[r]]);return[n,l,p,s]}}),function(n){for(var r=0;r<n.length;r++)!function(e){g.fn[e]=function(n,r){var t=this;return r?(setTimeout(function(){r.call(t,g.fn[e].call(t,n))},15),this):"number"==typeof g[e](this,n)?g[e](this,n):g(g[e](this,n))}}(n[r])}("add divide multiply subtract dot pow exp log abs norm angle".split(" ")),c=m,l=Math,s=[].slice,u=c.utils.isNumber,t=c.utils.isArray,c.extend({zscore:function(){var n=s.call(arguments);return u(n[1])?(n[0]-n[1])/n[2]:(n[0]-c.mean(n[1]))/c.stdev(n[1],n[2])},ztest:function(){var n,r=s.call(arguments);return t(r[1])?(n=c.zscore(r[0],r[1],r[3]),1===r[2]?c.normal.cdf(-l.abs(n),0,1):2*c.normal.cdf(-l.abs(n),0,1)):2<r.length?(n=c.zscore(r[0],r[1],r[2]),1===r[3]?c.normal.cdf(-l.abs(n),0,1):2*c.normal.cdf(-l.abs(n),0,1)):(n=r[0],1===r[1]?c.normal.cdf(-l.abs(n),0,1):2*c.normal.cdf(-l.abs(n),0,1))}}),c.extend(c.fn,{zscore:function(n,r){return(n-this.mean())/this.stdev(r)},ztest:function(n,r,t){t=l.abs(this.zscore(n,t));return 1===r?c.normal.cdf(-t,0,1):2*c.normal.cdf(-t,0,1)}}),c.extend({tscore:function(){var n=s.call(arguments);return 4===n.length?(n[0]-n[1])/(n[2]/l.sqrt(n[3])):(n[0]-c.mean(n[1]))/(c.stdev(n[1],!0)/l.sqrt(n[1].length))},ttest:function(){var n,r=s.call(arguments);return 5===r.length?(n=l.abs(c.tscore(r[0],r[1],r[2],r[3])),1===r[4]?c.studentt.cdf(-n,r[3]-1):2*c.studentt.cdf(-n,r[3]-1)):u(r[1])?(n=l.abs(r[0]),1==r[2]?c.studentt.cdf(-n,r[1]-1):2*c.studentt.cdf(-n,r[1]-1)):(n=l.abs(c.tscore(r[0],r[1])),1==r[2]?c.studentt.cdf(-n,r[1].length-1):2*c.studentt.cdf(-n,r[1].length-1))}}),c.extend(c.fn,{tscore:function(n){return(n-this.mean())/(this.stdev(!0)/l.sqrt(this.cols()))},ttest:function(n,r){return 1===r?1-c.studentt.cdf(l.abs(this.tscore(n)),this.cols()-1):2*c.studentt.cdf(-l.abs(this.tscore(n)),this.cols()-1)}}),c.extend({anovafscore:function(){var n,r,t,e,o,u,a,i,f=s.call(arguments);if(1===f.length){for(o=new Array(f[0].length),a=0;a<f[0].length;a++)o[a]=f[0][a];f=o}for(r=new Array,a=0;a<f.length;a++)r=r.concat(f[a]);for(t=c.mean(r),a=n=0;a<f.length;a++)n+=f[a].length*l.pow(c.mean(f[a])-t,2);for(n/=f.length-1,a=u=0;a<f.length;a++)for(e=c.mean(f[a]),i=0;i<f[a].length;i++)u+=l.pow(f[a][i]-e,2);return n/(u/=r.length-f.length)},anovaftest:function(){var n=s.call(arguments);if(u(n[0]))return 1-c.centralF.cdf(n[0],n[1],n[2]);for(var r=c.anovafscore(n),t=n.length-1,e=0,o=0;o<n.length;o++)e+=n[o].length;return 1-c.centralF.cdf(r,t,e-t-1)},ftest:function(n,r,t){return 1-c.centralF.cdf(n,r,t)}}),c.extend(c.fn,{anovafscore:function(){return c.anovafscore(this.toArray())},anovaftes:function(){for(var n=0,r=0;r<this.length;r++)n+=this[r].length;return c.ftest(this.anovafscore(),this.length-1,n-this.length)}}),c.extend({qscore:function(){var n,r,t,e,o=s.call(arguments),o=u(o[0])?(n=o[0],r=o[1],t=o[2],e=o[3],o[4]):(n=c.mean(o[0]),r=c.mean(o[1]),t=o[0].length,e=o[1].length,o[2]);return l.abs(n-r)/(o*l.sqrt((1/t+1/e)/2))},qtest:function(){var n,r=s.call(arguments),t=(r=3===r.length?(n=r[0],r.slice(1)):7===r.length?(n=c.qscore(r[0],r[1],r[2],r[3],r[4]),r.slice(5)):(n=c.qscore(r[0],r[1],r[2]),r.slice(3)))[0],r=r[1];return 1-c.tukey.cdf(n,r,t-r)},tukeyhsd:function(n){for(var r=c.pooledstdev(n),t=n.map(function(n){return c.mean(n)}),e=n.reduce(function(n,r){return n+r.length},0),o=[],u=0;u<n.length;++u)for(var a=u+1;a<n.length;++a){var i=c.qtest(t[u],t[a],n[u].length,n[a].length,r,e,n.length);o.push([[u,a],i])}return o}}),c.extend({normalci:function(){var n=s.call(arguments),r=new Array(2),t=4===n.length?l.abs(c.normal.inv(n[1]/2,0,1)*n[2]/l.sqrt(n[3])):l.abs(c.normal.inv(n[1]/2,0,1)*c.stdev(n[2])/l.sqrt(n[2].length));return r[0]=n[0]-t,r[1]=n[0]+t,r},tci:function(){var n=s.call(arguments),r=new Array(2),t=4===n.length?l.abs(c.studentt.inv(n[1]/2,n[3]-1)*n[2]/l.sqrt(n[3])):l.abs(c.studentt.inv(n[1]/2,n[2].length-1)*c.stdev(n[2],!0)/l.sqrt(n[2].length));return r[0]=n[0]-t,r[1]=n[0]+t,r},significant:function(n,r){return n<r}}),c.extend(c.fn,{normalci:function(n,r){return c.normalci(n,r,this.toArray())},tci:function(n,r){return c.tci(n,r,this.toArray())}}),c.extend(c.fn,{oneSidedDifferenceOfProportions:function(n,r,t,e){e=w(n,r,t,e);return c.ztest(e,1)},twoSidedDifferenceOfProportions:function(n,r,t,e){e=w(n,r,t,e);return c.ztest(e,2)}}),m.models={ols:function(n,r){var t=b(n,r),e=_(t),n=(n=(o=t).R2/o.df_model/((1-o.R2)/o.df_resid),o=1-(r=o.df_model,o=o.df_resid,m.beta.cdf(n/(o/r+n),r/2,o/2)),{F_statistic:n,pvalue:o}),o=1-(1-t.R2)*((t.nobs-1)/t.df_resid);return t.t=e,t.f=n,t.adjust_R2=o,t}},m.extend({buildxmatrix:function(){for(var n=new Array(arguments.length),r=0;r<arguments.length;r++)n[r]=[1].concat(arguments[r]);return m(n)},builddxmatrix:function(){for(var n=new Array(arguments[0].length),r=0;r<arguments[0].length;r++)n[r]=[1].concat(arguments[0][r]);return m(n)},buildjxmatrix:function(n){for(var r=new Array(n.length),t=0;t<n.length;t++)r[t]=n[t];return m.builddxmatrix(r)},buildymatrix:function(n){return m(n).transpose()},buildjymatrix:function(n){return n.transpose()},matrixmult:function(n,r){var t,e,o,u,a;if(n.cols()==r.rows()){if(1<r.rows()){for(u=[],t=0;t<n.rows();t++)for(u[t]=[],e=0;e<r.cols();e++){for(o=a=0;o<n.cols();o++)a+=n.toArray()[t][o]*r.toArray()[o][e];u[t][e]=a}return m(u)}for(u=[],t=0;t<n.rows();t++)for(u[t]=[],e=0;e<r.cols();e++){for(o=a=0;o<n.cols();o++)a+=n.toArray()[t][o]*r.toArray()[e];u[t][e]=a}return m(u)}},regress:function(n,r){var t=m.xtranspxinv(n),n=n.transpose(),n=m.matrixmult(m(t),n);return m.matrixmult(n,r)},regresst:function(n,r,t){var e=m.regress(n,r),o={anova:{}},u=m.jMatYBar(n,e);o.yBar=u;var a=r.mean();o.anova.residuals=m.residuals(r,u),o.anova.ssr=m.ssr(u,a),o.anova.msr=o.anova.ssr/(n[0].length-1),o.anova.sse=m.sse(r,u),o.anova.mse=o.anova.sse/(r.length-(n[0].length-1)-1),o.anova.sst=m.sst(r,a),o.anova.mst=o.anova.sst/(r.length-1),o.anova.r2=1-o.anova.sse/o.anova.sst,o.anova.r2<0&&(o.anova.r2=0),o.anova.fratio=o.anova.msr/o.anova.mse,o.anova.pvalue=m.anovaftest(o.anova.fratio,n[0].length-1,r.length-(n[0].length-1)-1),o.anova.rmse=Math.sqrt(o.anova.mse),o.anova.r2adj=1-o.anova.mse/o.anova.mst,o.anova.r2adj<0&&(o.anova.r2adj=0),o.stats=new Array(n[0].length);for(var i,f,c,l=m.xtranspxinv(n),s=0;s<e.length;s++)i=Math.sqrt(o.anova.mse*Math.abs(l[s][s])),f=Math.abs(e[s]/i),c=m.ttest(f,r.length-n[0].length-1,t),o.stats[s]=[e[s],i,f,c];return o.regress=e,o},xtranspx:function(n){return m.matrixmult(n.transpose(),n)},xtranspxinv:function(n){n=m.matrixmult(n.transpose(),n);return m.inv(n)},jMatYBar:function(n,r){r=m.matrixmult(n,r);return new m(r)},residuals:function(n,r){return m.matrixsubtract(n,r)},ssr:function(n,r){for(var t=0,e=0;e<n.length;e++)t+=Math.pow(n[e]-r,2);return t},sse:function(n,r){for(var t=0,e=0;e<n.length;e++)t+=Math.pow(n[e]-r[e],2);return t},sst:function(n,r){for(var t=0,e=0;e<n.length;e++)t+=Math.pow(n[e]-r,2);return t},matrixsubtract:function(n,r){for(var t=new Array(n.length),e=0;e<n.length;e++){t[e]=new Array(n[e].length);for(var o=0;o<n[e].length;o++)t[e][o]=n[e][o]-r[e][o]}return m(t)}}),m.jStat=m},"object"===(void 0===t?"undefined":e(t))?r.exports=o():(void 0).jStat=o()},{}],2:[function(n,r,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;n=((n=n("./sdt-math"))&&n.__esModule?n:{default:n}).default;t.default=n},{"./sdt-math":3}],3:[function(n,r,t){"use strict";function a(n){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n})(n)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=function(n,r){if(!r&&n&&n.__esModule)return n;if(null===n||"object"!==a(n)&&"function"!=typeof n)return{default:n};r=i(r);if(r&&r.has(n))return r.get(n);var t,e={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(t in n){var u;"default"!==t&&Object.prototype.hasOwnProperty.call(n,t)&&((u=o?Object.getOwnPropertyDescriptor(n,t):null)&&(u.get||u.set)?Object.defineProperty(e,t,u):e[t]=n[t])}e.default=n,r&&r.set(n,e);return e}(n("jstat"));function i(n){if("function"!=typeof WeakMap)return null;var r=new WeakMap,t=new WeakMap;return(i=function(n){return n?t:r})(n)}function u(n,r){for(var t=0;t<r.length;t++){var e=r[t];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(n,e.key,e)}}t.default=function(){function n(){!function(n,r){if(!(n instanceof r))throw new TypeError("Cannot call a class as a function")}(this,n)}var r,t,e;return r=n,e=[{key:"hM2Hr",value:function(n,r){return 0===n&&0===r?0:n/(n+r)}},{key:"faCr2Far",value:function(n,r){return 0===n&&0===r?0:n/(n+r)}},{key:"hMFaCr2Acc",value:function(n,r,t,e){return 0===n&&0===r&&0===t&&0===e?0:(n+e)/(n+r+t+e)}},{key:"hrFar2Acc",value:function(n,r){return(n+(1-r))/2}},{key:"hFa2Ppv",value:function(n,r){return 0===n&&0===r?0:n/(n+r)}},{key:"mCr2Fomr",value:function(n,r){return 0===n&&0===r?0:n/(n+r)}},{key:"hrFar2D",value:function(n,r){var t=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1;return 1===t?o.normal.inv(n,0,1)-o.normal.inv(r,0,1):Math.sqrt(2/(t*t+1))*(t*o.normal.inv(n,0,1)-o.normal.inv(r,0,1))}},{key:"hrFar2C",value:function(n,r){var t=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1;return 1===t?-(o.normal.inv(n,0,1)+o.normal.inv(r,0,1))/2:Math.sqrt(2/(t*t+1))*(t/(t+1))*-(o.normal.inv(n,0,1)+o.normal.inv(r,0,1))}},{key:"dC2Hr",value:function(n,r){var t=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1;return 1===t?o.normal.cdf(n/2-r,0,1):o.normal.cdf(Math.sqrt((t*t+1)/2)*(n/(1+t)-r/t),0,1)}},{key:"dC2Far",value:function(n,r){var t=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1;return 1===t?o.normal.cdf(-(n/2+r),0,1):o.normal.cdf(Math.sqrt((t*t+1)/2)*-(n/(1+t)+r),0,1)}},{key:"dFar2Hr",value:function(n,r){var t=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1;return 1===t?o.normal.cdf(n+o.normal.inv(r,0,1),0,1):o.normal.cdf((Math.sqrt((t*t+1)/2)*n+o.normal.inv(r,0,1))/t,0,1)}},{key:"cFar2Hr",value:function(n,r){var t=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1;return 1===t?o.normal.cdf(-2*n-o.normal.inv(r,0,1),0,1):o.normal.cdf(-Math.sqrt((t*t+1)/2)*((t+1)/t)*n-o.normal.inv(r,0,1),0,1)}},{key:"d2MuN",value:function(n){var r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1;return 1===r?-n/2:-Math.sqrt((r*r+1)/2)*(1/(r+1))*n}},{key:"muN2D",value:function(n){var r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1;return 1===r?-2*n:-Math.sqrt(2/(r*r+1))*(r+1)*n}},{key:"d2MuS",value:function(n){var r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1;return 1===r?n/2:Math.sqrt((r*r+1)/2)*(r/(r+1))*n}},{key:"muS2D",value:function(n){var r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1;return 1===r?2*n:Math.sqrt(2/(r*r+1))*((r+1)/r)*n}},{key:"c2L",value:function(n){var r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1;return 1===r?n:Math.sqrt((r*r+1)/2)*n}},{key:"l2C",value:function(n){var r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1;return 1===r?n:Math.sqrt(2/(r*r+1))*n}},{key:"s2H",value:function(){return 1/((0<arguments.length&&void 0!==arguments[0]?arguments[0]:1)*Math.sqrt(2*Math.PI))}},{key:"h2S",value:function(n){return 1/(n*Math.sqrt(2*Math.PI))}},{key:"hr2Zhr",value:function(n){return o.normal.inv(n,0,1)}},{key:"far2Zfar",value:function(n){return o.normal.inv(n,0,1)}},{key:"zhr2Hr",value:function(n){return o.normal.cdf(n,0,1)}},{key:"zfar2Far",value:function(n){return o.normal.cdf(n,0,1)}}],(t=null)&&u(r.prototype,t),e&&u(r,e),Object.defineProperty(r,"prototype",{writable:!1}),n}()},{jstat:1}]},{},[2])(2)});
//# sourceMappingURL=index.js.map
