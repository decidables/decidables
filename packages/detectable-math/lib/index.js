!function(n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define([],n):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).detectableMath=n()}(function(){return function a(u,i,f){function c(r,n){if(!i[r]){if(!u[r]){var t="function"==typeof require&&require;if(!n&&t)return t(r,!0);if(l)return l(r,!0);var e=new Error("Cannot find module '"+r+"'");throw e.code="MODULE_NOT_FOUND",e}var o=i[r]={exports:{}};u[r][0].call(o.exports,function(n){return c(u[r][1][n]||n)},o,o.exports,a,u,i,f)}return i[r].exports}for(var l="function"==typeof require&&require,n=0;n<f.length;n++)c(f[n]);return c}({1:[function(n,r,t){"use strict";function e(n){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n})(n)}var o;o=function(){var h,v,_,A,y,g,i,f,o,r,c,l,s,u,t,m=function(i,f){var r=Array.prototype.concat,n=Array.prototype.slice,t=Object.prototype.toString;function c(n,r){var t=r<n?n:r;return i.pow(10,17-~~(i.log(0<t?t:-t)*i.LOG10E))}var l=Array.isArray||function(n){return"[object Array]"===t.call(n)};function s(n){return"[object Function]"===t.call(n)}function m(n){return"number"==typeof n&&n-n==0}function d(){return new d._init(arguments)}function e(){return 0}function o(){return 1}function a(n,r){return n===r?1:0}function u(n,r,t,e){var o,a=[],u=n.length;if(r===f&&t===f&&e===f)return d.copy(n);if(e=e||1,(r=0<=(r=r||0)?r:u+r)===(t=0<=(t=t||n.length)?t:u+t)||0===e)return[];if(r<t&&e<0)return[];if(t<r&&0<e)return[];if(0<e)for(o=r;o<t;o+=e)a.push(n[o]);else for(o=r;t<o;o+=e)a.push(n[o]);return a}d.fn=d.prototype,d._init=function(n){if(l(n[0]))if(l(n[0][0])){s(n[1])&&(n[0]=d.map(n[0],n[1]));for(var r=0;r<n[0].length;r++)this[r]=n[0][r];this.length=n[0].length}else this[0]=s(n[1])?d.map(n[0],n[1]):n[0],this.length=1;else if(m(n[0]))this[0]=d.seq.apply(null,n),this.length=1;else{if(n[0]instanceof d)return d(n[0].toArray());this[0]=[],this.length=1}return this},d._init.prototype=d.prototype,(d._init.constructor=d).utils={calcRdx:c,isArray:l,isFunction:s,isNumber:m,toVector:function(n){return r.apply([],n)}},d._random_fn=i.random,d.setRandom=function(n){if("function"!=typeof n)throw new TypeError("fn is not a function");d._random_fn=n},d.extend=function(n){var r,t;if(1===arguments.length){for(t in n)d[t]=n[t];return this}for(r=1;r<arguments.length;r++)for(t in arguments[r])n[t]=arguments[r][t];return n},d.rows=function(n){return n.length||1},d.cols=function(n){return n[0].length||1},d.dimensions=function(n){return{rows:d.rows(n),cols:d.cols(n)}},d.row=function(r,n){return l(n)?n.map(function(n){return d.row(r,n)}):r[n]},d.rowa=function(n,r){return d.row(n,r)},d.col=function(e,n){if(l(n)){var o=d.arange(e.length).map(function(){return new Array(n.length)});return n.forEach(function(r,t){d.arange(e.length).forEach(function(n){o[n][t]=e[n][r]})}),o}for(var r=new Array(e.length),t=0;t<e.length;t++)r[t]=[e[t][n]];return r},d.cola=function(n,r){return d.col(n,r).map(function(n){return n[0]})},d.diag=function(n){for(var r=d.rows(n),t=new Array(r),e=0;e<r;e++)t[e]=[n[e][e]];return t},d.antidiag=function(n){for(var r=d.rows(n)-1,t=new Array(r),e=0;0<=r;r--,e++)t[e]=[n[e][r]];return t},d.transpose=function(n){var r,t,e,o,a,u=[];for(l(n[0])||(n=[n]),t=n.length,e=n[0].length,a=0;a<e;a++){for(r=new Array(t),o=0;o<t;o++)r[o]=n[o][a];u.push(r)}return 1===u.length?u[0]:u},d.map=function(n,r,t){var e,o,a,u,i;for(l(n[0])||(n=[n]),o=n.length,a=n[0].length,u=t?n:new Array(o),e=0;e<o;e++)for(u[e]||(u[e]=new Array(a)),i=0;i<a;i++)u[e][i]=r(n[e][i],e,i);return 1===u.length?u[0]:u},d.cumreduce=function(n,r,t){var e,o,a,u,i;for(l(n[0])||(n=[n]),o=n.length,a=n[0].length,u=t?n:new Array(o),e=0;e<o;e++)for(u[e]||(u[e]=new Array(a)),0<a&&(u[e][0]=n[e][0]),i=1;i<a;i++)u[e][i]=r(u[e][i-1],n[e][i]);return 1===u.length?u[0]:u},d.alter=function(n,r){return d.map(n,r,!0)},d.create=function(n,r,t){var e,o,a=new Array(n);for(s(r)&&(t=r,r=n),e=0;e<n;e++)for(a[e]=new Array(r),o=0;o<r;o++)a[e][o]=t(e,o);return a},d.zeros=function(n,r){return m(r)||(r=n),d.create(n,r,e)},d.ones=function(n,r){return m(r)||(r=n),d.create(n,r,o)},d.rand=function(n,r){return m(r)||(r=n),d.create(n,r,d._random_fn)},d.identity=function(n,r){return m(r)||(r=n),d.create(n,r,a)},d.symmetric=function(n){var r,t,e=n.length;if(n.length!==n[0].length)return!1;for(r=0;r<e;r++)for(t=0;t<e;t++)if(n[t][r]!==n[r][t])return!1;return!0},d.clear=function(n){return d.alter(n,e)},d.seq=function(n,r,t,e){s(e)||(e=!1);for(var o=[],a=c(n,r),u=(r*a-n*a)/((t-1)*a),i=n,f=0;i<=r&&f<t;i=(n*a+u*a*++f)/a)o.push(e?e(i,f):i);return o},d.arange=function(n,r,t){var e,o=[];if(t=t||1,r===f&&(r=n,n=0),n===r||0===t)return[];if(n<r&&t<0)return[];if(r<n&&0<t)return[];if(0<t)for(e=n;e<r;e+=t)o.push(e);else for(e=n;r<e;e+=t)o.push(e);return o},d.slice=function(n,r){var t,e;return m((r=r||{}).row)?m(r.col)?n[r.row][r.col]:u(d.rowa(n,r.row),(t=r.col||{}).start,t.end,t.step):m(r.col)?u(d.cola(n,r.col),(e=r.row||{}).start,e.end,e.step):(e=r.row||{},t=r.col||{},u(n,e.start,e.end,e.step).map(function(n){return u(n,t.start,t.end,t.step)}))},d.sliceAssign=function(o,n,a){var r,t;if(m(n.row)){if(m(n.col))return o[n.row][n.col]=a;n.col=n.col||{},n.col.start=n.col.start||0,n.col.end=n.col.end||o[0].length,n.col.step=n.col.step||1,r=d.arange(n.col.start,i.min(o.length,n.col.end),n.col.step);var e=n.row;return r.forEach(function(n,r){o[e][n]=a[r]}),o}if(m(n.col)){n.row=n.row||{},n.row.start=n.row.start||0,n.row.end=n.row.end||o.length,n.row.step=n.row.step||1,t=d.arange(n.row.start,i.min(o[0].length,n.row.end),n.row.step);var u=n.col;return t.forEach(function(n,r){o[n][u]=a[r]}),o}return a[0].length===f&&(a=[a]),n.row.start=n.row.start||0,n.row.end=n.row.end||o.length,n.row.step=n.row.step||1,n.col.start=n.col.start||0,n.col.end=n.col.end||o[0].length,n.col.step=n.col.step||1,t=d.arange(n.row.start,i.min(o.length,n.row.end),n.row.step),r=d.arange(n.col.start,i.min(o[0].length,n.col.end),n.col.step),t.forEach(function(t,e){r.forEach(function(n,r){o[t][n]=a[e][r]})}),o},d.diagonal=function(n){var t=d.zeros(n.length,n.length);return n.forEach(function(n,r){t[r][r]=n}),t},d.copy=function(n){return n.map(function(n){return m(n)?n:n.map(function(n){return n})})};var p=d.prototype;return p.length=0,p.push=Array.prototype.push,p.sort=Array.prototype.sort,p.splice=Array.prototype.splice,p.slice=Array.prototype.slice,p.toArray=function(){return 1<this.length?n.call(this):n.call(this)[0]},p.map=function(n,r){return d(d.map(this,n,r))},p.cumreduce=function(n,r){return d(d.cumreduce(this,n,r))},p.alter=function(n){return d.alter(this,n),this},function(n){for(var r=0;r<n.length;r++)!function(e){p[e]=function(n){var r,t=this;return n?(setTimeout(function(){n.call(t,p[e].call(t))}),this):(r=d[e](this),l(r)?d(r):r)}}(n[r])}("transpose clear symmetric rows cols dimensions diag antidiag".split(" ")),function(n){for(var r=0;r<n.length;r++)!function(e){p[e]=function(n,r){var t=this;return r?(setTimeout(function(){r.call(t,p[e].call(t,n))}),this):d(d[e](this,n))}}(n[r])}("row col".split(" ")),function(n){for(var r=0;r<n.length;r++)!function(n){p[n]=function(){return d(d[n].apply(null,arguments))}}(n[r])}("create zeros ones rand identity".split(" ")),d}(Math);function d(n,r,t,e){for(var o,a=0,u=1,i=1,f=1,c=0,l=0;A.abs((i-l)/i)>e;)u=f+(o=-(r+c)*(r+t+c)*n/(r+2*c)/(r+2*c+1))*u,i=(a=(l=i)+o*a)+(o=(c+=1)*(t-c)*n/(r+2*c-1)/(r+2*c))*i,a/=f=u+o*f,u/=f,i/=f,f=1;return i/r}function w(n,r,t){var e=[.9815606342467192,.9041172563704749,.7699026741943047,.5873179542866175,.3678314989981802,.1252334085114689],o=[.04717533638651183,.10693932599531843,.16007832854334622,.20316742672306592,.2334925365383548,.24914704581340277],a=.5*n;if(8<=a)return 1;for(var u=(u=2*_.normal.cdf(a,0,1,1,0)-1)>=A.exp(-50/t)?A.pow(u,t):0,i=3<n?2:3,f=a,c=(8-a)/i,l=f+c,s=0,m=t-1,d=1;d<=i;d++){for(var p=0,g=.5*(l+f),h=.5*(l-f),v=1;v<=12;v++){var y,w=6<v?e[(y=12-v+1)-1]:-e[(y=v)-1],b=g+h*w,x=b*b;if(60<x)break;var q=.5*(2*_.normal.cdf(b,0,1,1,0))-.5*(2*_.normal.cdf(b,n,1,1,0));q>=A.exp(-30/m)&&(p+=o[y-1]*A.exp(-.5*x)*A.pow(q,m))}s+=p*=2*h*t/A.sqrt(2*A.PI),f=l,l+=c}return(u+=s)<=A.exp(-30/r)?0:1<=(u=A.pow(u,r))?1:u}function p(n){return r(n)||n instanceof y}function a(n,r,t,e){if(1<n||1<t||n<=0||t<=0)throw new Error("Proportions should be greater than 0 and less than 1");var o=(n*r+t*e)/(r+e);return(n-t)/l.sqrt(o*(1-o)*(1/r+1/e))}function b(n,r){var t=n.length,e=r[0].length-1,o=t-e-1,a=m.lstsq(r,n),u=m.multiply(r,a.map(function(n){return[n]})).map(function(n){return n[0]}),i=m.subtract(n,u),f=m.mean(n),c=m.sum(u.map(function(n){return Math.pow(n-f,2)})),l=m.sum(n.map(function(n,r){return Math.pow(n-u[r],2)})),s=c+l;return{exog:r,endog:n,nobs:t,df_model:e,df_resid:o,coef:a,predict:u,resid:i,ybar:f,SST:s,SSE:c,SSR:l,R2:c/s}}function x(t){var e,o,n=(e=t.exog,o=e[0].length,m.arange(o).map(function(r){var n=m.arange(o).filter(function(n){return n!==r});return b(m.col(e,r).map(function(n){return n[0]}),m.col(e,n))})),a=Math.sqrt(t.SSR/t.df_resid),u=n.map(function(n){var r=n.SST,t=n.R2;return a/Math.sqrt(r*(1-t))}),r=t.coef.map(function(n,r){return n/u[r]}),i=r.map(function(n){var r=m.studentt.cdf(n,t.df_resid);return 2*(.5<r?1-r:r)}),f=m.studentt.inv(.975,t.df_resid),c=t.coef.map(function(n,r){var t=f*u[r];return[n-t,n+t]});return{se:u,t:r,p:i,sigmaHat:a,interval95:c}}return function(f,m){var c=f.utils.isFunction;function d(n,r){return n-r}function p(n,r,t){return m.max(r,m.min(n,t))}f.sum=function(n){for(var r=0,t=n.length;0<=--t;)r+=n[t];return r},f.sumsqrd=function(n){for(var r=0,t=n.length;0<=--t;)r+=n[t]*n[t];return r},f.sumsqerr=function(n){for(var r,t=f.mean(n),e=0,o=n.length;0<=--o;)e+=(r=n[o]-t)*r;return e},f.sumrow=function(n){for(var r=0,t=n.length;0<=--t;)r+=n[t];return r},f.product=function(n){for(var r=1,t=n.length;0<=--t;)r*=n[t];return r},f.min=function(n){for(var r=n[0],t=0;++t<n.length;)n[t]<r&&(r=n[t]);return r},f.max=function(n){for(var r=n[0],t=0;++t<n.length;)n[t]>r&&(r=n[t]);return r},f.unique=function(n){for(var r={},t=[],e=0;e<n.length;e++)r[n[e]]||(r[n[e]]=!0,t.push(n[e]));return t},f.mean=function(n){return f.sum(n)/n.length},f.meansqerr=function(n){return f.sumsqerr(n)/n.length},f.geomean=function(n){return m.pow(f.product(n),1/n.length)},f.median=function(n){var r=n.length,t=n.slice().sort(d);return 1&r?t[r/2|0]:(t[r/2-1]+t[r/2])/2},f.cumsum=function(n){return f.cumreduce(n,function(n,r){return n+r})},f.cumprod=function(n){return f.cumreduce(n,function(n,r){return n*r})},f.diff=function(n){for(var r=[],t=n.length,e=1;e<t;e++)r.push(n[e]-n[e-1]);return r},f.rank=function(n){for(var r=[],t={},e=0;e<n.length;e++){t[i=n[e]]?t[i]++:(t[i]=1,r.push(i))}var o=r.sort(d),a={},u=1;for(e=0;e<o.length;e++){var i,f=t[i=o[e]],c=(u+(u+f-1))/2;a[i]=c,u+=f}return n.map(function(n){return a[n]})},f.mode=function(n){for(var r=n.length,t=n.slice().sort(d),e=1,o=0,a=0,u=[],i=0;i<r;i++)t[i]===t[i+1]?e++:(o<e?(u=[t[i]],o=e,a=0):e===o&&(u.push(t[i]),a++),e=1);return 0===a?u[0]:u},f.range=function(n){return f.max(n)-f.min(n)},f.variance=function(n,r){return f.sumsqerr(n)/(n.length-(r?1:0))},f.pooledvariance=function(n){return n.reduce(function(n,r){return n+f.sumsqerr(r)},0)/(n.reduce(function(n,r){return n+r.length},0)-n.length)},f.deviation=function(n){for(var r=f.mean(n),t=n.length,e=new Array(t),o=0;o<t;o++)e[o]=n[o]-r;return e},f.stdev=function(n,r){return m.sqrt(f.variance(n,r))},f.pooledstdev=function(n){return m.sqrt(f.pooledvariance(n))},f.meandev=function(n){for(var r=f.mean(n),t=[],e=n.length-1;0<=e;e--)t.push(m.abs(n[e]-r));return f.mean(t)},f.meddev=function(n){for(var r=f.median(n),t=[],e=n.length-1;0<=e;e--)t.push(m.abs(n[e]-r));return f.median(t)},f.coeffvar=function(n){return f.stdev(n)/f.mean(n)},f.quartiles=function(n){var r=n.length,t=n.slice().sort(d);return[t[m.round(r/4)-1],t[m.round(r/2)-1],t[m.round(3*r/4)-1]]},f.quantiles=function(n,r,t,e){var o,a,u,i,f,c=n.slice().sort(d),l=[r.length],s=n.length;for(void 0===t&&(t=3/8),void 0===e&&(e=3/8),o=0;o<r.length;o++)u=s*(a=r[o])+(t+a*(1-t-e)),i=m.floor(p(u,1,s-1)),f=p(u-i,0,1),l[o]=(1-f)*c[i-1]+f*c[i];return l},f.percentile=function(n,r,t){var e=n.slice().sort(d),o=r*(e.length+(t?1:-1))+(t?0:1),a=parseInt(o),u=o-a;return a+1<e.length?e[a-1]+u*(e[a]-e[a-1]):e[a-1]},f.percentileOfScore=function(n,r,t){for(var e,o=0,a=n.length,u="strict"===t?!0:!1,i=0;i<a;i++)e=n[i],(u&&e<r||!u&&e<=r)&&o++;return o/a},f.histogram=function(n,r){r=r||4;for(var t=f.min(n),e=(f.max(n)-t)/r,o=n.length,a=[],u=0;u<r;u++)a[u]=0;for(u=0;u<o;u++)a[m.min(m.floor((n[u]-t)/e),r-1)]+=1;return a},f.covariance=function(n,r){for(var t=f.mean(n),e=f.mean(r),o=n.length,a=new Array(o),u=0;u<o;u++)a[u]=(n[u]-t)*(r[u]-e);return f.sum(a)/(o-1)},f.corrcoeff=function(n,r){return f.covariance(n,r)/f.stdev(n,1)/f.stdev(r,1)},f.spearmancoeff=function(n,r){return n=f.rank(n),r=f.rank(r),f.corrcoeff(n,r)},f.stanMoment=function(n,r){for(var t=f.mean(n),e=f.stdev(n),o=n.length,a=0,u=0;u<o;u++)a+=m.pow((n[u]-t)/e,r);return a/n.length},f.skewness=function(n){return f.stanMoment(n,3)},f.kurtosis=function(n){return f.stanMoment(n,4)-3};var l=f.prototype;!function(n){for(var r=0;r<n.length;r++)!function(a){l[a]=function(n,r){var t=[],e=0,o=this;if(c(n)&&(r=n,n=!1),r)return setTimeout(function(){r.call(o,l[a].call(o,n))}),this;if(1<this.length){for(o=!0===n?this:this.transpose();e<o.length;e++)t[e]=f[a](o[e]);return t}return f[a](this[0],n)}}(n[r])}("cumsum cumprod".split(" ")),function(n){for(var r=0;r<n.length;r++)!function(a){l[a]=function(n,r){var t=[],e=0,o=this;if(c(n)&&(r=n,n=!1),r)return setTimeout(function(){r.call(o,l[a].call(o,n))}),this;if(1<this.length){for("sumrow"!==a&&(o=!0===n?this:this.transpose());e<o.length;e++)t[e]=f[a](o[e]);return!0===n?f[a](f.utils.toVector(t)):t}return f[a](this[0],n)}}(n[r])}("sum sumsqrd sumsqerr sumrow product min max unique mean meansqerr geomean median diff rank mode range variance deviation stdev meandev meddev coeffvar quartiles histogram skewness kurtosis".split(" ")),function(n){for(var r=0;r<n.length;r++)!function(i){l[i]=function(){var n,r=[],t=0,e=this,o=Array.prototype.slice.call(arguments);if(c(o[o.length-1])){n=o[o.length-1];var a=o.slice(0,o.length-1);return setTimeout(function(){n.call(e,l[i].apply(e,a))}),this}n=void 0;var u=function(n){return f[i].apply(e,[n].concat(o))};if(1<this.length){for(e=e.transpose();t<e.length;t++)r[t]=u(e[t]);return r}return u(this[0])}}(n[r])}("quantiles percentileOfScore".split(" "))}(m,Math),h=m,v=Math,h.gammaln=function(n){var r,t,e=0,o=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],a=1.000000000190015,u=(t=r=n)+5.5;for(u-=(r+.5)*v.log(u);e<6;e++)a+=o[e]/++t;return v.log(2.5066282746310007*a/r)-u},h.loggam=function(n){var r,t,e,o,a,u=[.08333333333333333,-.002777777777777778,.0007936507936507937,-.0005952380952380952,.0008417508417508418,-.001917526917526918,.00641025641025641,-.02955065359477124,.1796443723688307,-1.3924322169059],i=n,f=0;if(1==n||2==n)return 0;for(n<=7&&(i=n+(f=v.floor(7-n))),r=1/(i*i),t=2*v.PI,o=u[9],a=8;0<=a;a--)o*=r,o+=u[a];if(e=o/i+.5*v.log(t)+(i-.5)*v.log(i)-i,n<=7)for(a=1;a<=f;a++)e-=v.log(i-1),--i;return e},h.gammafn=function(n){var r,t,e,o,a=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],u=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535],i=!1,f=0,c=0,l=0,s=n;if(171.6243769536076<n)return 1/0;if(s<=0){if(!(o=s%1+36e-17))return 1/0;i=(1&s?-1:1)*v.PI/v.sin(v.PI*o),s=1-s}for(t=(e=s)<1?s++:(s-=f=(0|s)-1)-1,r=0;r<8;++r)l=(l+a[r])*t,c=c*t+u[r];if(o=l/c+1,e<s)o/=e;else if(s<e)for(r=0;r<f;++r)o*=s,s++;return i&&(o=i/o),o},h.gammap=function(n,r){return h.lowRegGamma(n,r)*h.gammafn(n)},h.lowRegGamma=function(n,r){var t,e=h.gammaln(n),o=n,a=1/n,u=a,i=r+1-n,f=1/1e-30,c=1/i,l=c,s=1,m=-~(8.5*v.log(1<=n?n:1/n)+.4*n+17);if(r<0||n<=0)return NaN;if(r<n+1){for(;s<=m;s++)a+=u*=r/++o;return a*v.exp(-r+n*v.log(r)-e)}for(;s<=m;s++)l*=(c=1/(c=(t=-s*(s-n))*c+(i+=2)))*(f=i+t/f);return 1-l*v.exp(-r+n*v.log(r)-e)},h.factorialln=function(n){return n<0?NaN:h.gammaln(n+1)},h.factorial=function(n){return n<0?NaN:h.gammafn(n+1)},h.combination=function(n,r){return 170<n||170<r?v.exp(h.combinationln(n,r)):h.factorial(n)/h.factorial(r)/h.factorial(n-r)},h.combinationln=function(n,r){return h.factorialln(n)-h.factorialln(r)-h.factorialln(n-r)},h.permutation=function(n,r){return h.factorial(n)/h.factorial(n-r)},h.betafn=function(n,r){if(!(n<=0||r<=0))return 170<n+r?v.exp(h.betaln(n,r)):h.gammafn(n)*h.gammafn(r)/h.gammafn(n+r)},h.betaln=function(n,r){return h.gammaln(n)+h.gammaln(r)-h.gammaln(n+r)},h.betacf=function(n,r,t){var e,o,a,u,i=1e-30,f=1,c=r+t,l=r+1,s=r-1,m=1,d=1-c*n/l;for(v.abs(d)<i&&(d=i),u=d=1/d;f<=100&&(d=1+(o=f*(t-f)*n/((s+(e=2*f))*(r+e)))*d,v.abs(d)<i&&(d=i),m=1+o/m,v.abs(m)<i&&(m=i),u*=(d=1/d)*m,d=1+(o=-(r+f)*(c+f)*n/((r+e)*(l+e)))*d,v.abs(d)<i&&(d=i),m=1+o/m,v.abs(m)<i&&(m=i),u*=a=(d=1/d)*m,!(v.abs(a-1)<3e-7));f++);return u},h.gammapinv=function(n,r){var t,e,o,a,u,i,f=0,c=r-1,l=h.gammaln(r);if(1<=n)return v.max(100,r+100*v.sqrt(r));if(n<=0)return 0;for(t=1<r?(u=v.log(c),i=v.exp(c*(u-1)-l),a=n<.5?n:1-n,t=(2.30753+.27061*(e=v.sqrt(-2*v.log(a))))/(1+e*(.99229+.04481*e))-e,n<.5&&(t=-t),v.max(.001,r*v.pow(1-1/(9*r)-t/(3*v.sqrt(r)),3))):n<(e=1-r*(.253+.12*r))?v.pow(n/e,1/r):1-v.log(1-(n-e)/(1-e));f<12;f++){if(t<=0)return 0;if((t-=e=(o=(h.lowRegGamma(r,t)-n)/(e=1<r?i*v.exp(-(t-c)+c*(v.log(t)-u)):v.exp(-t+c*v.log(t)-l)))/(1-.5*v.min(1,o*((r-1)/t-1))))<=0&&(t=.5*(t+e)),v.abs(e)<1e-8*t)break}return t},h.erf=function(n){var r,t,e,o,a=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,1.5626441722e-8,-8.5238095915e-8,6.529054439e-9,5.059343495e-9,-9.91364156e-10,-2.27365122e-10,96467911e-18,2394038e-18,-6886027e-18,894487e-18,313092e-18,-112708e-18,381e-18,7106e-18,-1523e-18,-94e-18,121e-18,-28e-18],u=a.length-1,i=!1,f=0,c=0;for(n<0&&(n=-n,i=!0),t=4*(r=2/(2+n))-2;0<u;u--)f=t*(e=f)-c+a[u],c=e;return o=r*v.exp(-n*n+.5*(a[0]+t*f)-c),i?o-1:1-o},h.erfc=function(n){return 1-h.erf(n)},h.erfcinv=function(n){var r,t,e,o,a=0;if(2<=n)return-100;if(n<=0)return 100;for(o=n<1?n:2-n,r=-.70711*((2.30753+.27061*(e=v.sqrt(-2*v.log(o/2))))/(1+e*(.99229+.04481*e))-e);a<2;a++)r+=(t=h.erfc(r)-o)/(1.1283791670955126*v.exp(-r*r)-r*t);return n<1?r:-r},h.ibetainv=function(n,r,t){var e,o,a,u,i,f,c,l,s,m,d=r-1,p=t-1,g=0;if(n<=0)return 0;if(1<=n)return 1;for(f=1<=r&&1<=t?(a=n<.5?n:1-n,f=(2.30753+.27061*(u=v.sqrt(-2*v.log(a))))/(1+u*(.99229+.04481*u))-u,n<.5&&(f=-f),c=(f*f-3)/6,l=2/(1/(2*r-1)+1/(2*t-1)),s=f*v.sqrt(c+l)/l-(1/(2*t-1)-1/(2*r-1))*(c+5/6-2/(3*l)),r/(r+t*v.exp(2*s))):(e=v.log(r/(r+t)),o=v.log(t/(r+t)),n<(u=v.exp(r*e)/r)/(s=u+(i=v.exp(t*o)/t))?v.pow(r*s*n,1/r):1-v.pow(t*s*(1-n),1/t)),m=-h.gammaln(r)-h.gammaln(t)+h.gammaln(r+t);g<10;g++){if(0===f||1===f)return f;if((f-=u=(i=(h.ibeta(f,r,t)-n)/(u=v.exp(d*v.log(f)+p*v.log(1-f)+m)))/(1-.5*v.min(1,i*(d/f-p/(1-f)))))<=0&&(f=.5*(f+u)),1<=f&&(f=.5*(f+u+1)),v.abs(u)<1e-8*f&&0<g)break}return f},h.ibeta=function(n,r,t){var e=0===n||1===n?0:v.exp(h.gammaln(r+t)-h.gammaln(r)-h.gammaln(t)+r*v.log(n)+t*v.log(1-n));return!(n<0||1<n)&&(n<(r+1)/(r+t+2)?e*h.betacf(n,r,t)/r:1-e*h.betacf(1-n,t,r)/t)},h.randn=function(n,r){var t,e,o,a,u;if(r=r||n,n)return h.create(n,r,function(){return h.randn()});for(;t=h._random_fn(),e=1.7156*(h._random_fn()-.5),.27597<(u=(o=t-.449871)*o+(a=v.abs(e)+.386595)*(.196*a-.25472*o))&&(.27846<u||e*e>-4*v.log(t)*t*t););return e/t},h.randg=function(n,r,t){var e,o,a,u,i,f,c=n;if(t=t||r,n=n||1,r)return(f=h.zeros(r,t)).alter(function(){return h.randg(n)}),f;n<1&&(n+=1),e=n-1/3,o=1/v.sqrt(9*e);do{for(;(u=1+o*(i=h.randn()))<=0;);u*=u*u,a=h._random_fn()}while(a>1-.331*v.pow(i,4)&&v.log(a)>.5*i*i+e*(1-u+v.log(u)));if(n==c)return e*u;for(;0===(a=h._random_fn()););return v.pow(a,1/c)*e*u},function(n){for(var r=0;r<n.length;r++)!function(r){h.fn[r]=function(){return h(h.map(this,function(n){return h[r](n)}))}}(n[r])}("gammaln gammafn factorial factorialln".split(" ")),function(n){for(var r=0;r<n.length;r++)!function(n){h.fn[n]=function(){return h(h[n].apply(null,arguments))}}(n[r])}("randn".split(" ")),_=m,A=Math,function(n){for(var r=0;r<n.length;r++)!function(a){_[a]=function(n,r,t){return this instanceof arguments.callee?(this._a=n,this._b=r,this._c=t,this):new arguments.callee(n,r,t)},_.fn[a]=function(n,r,t){var e=_[a](n,r,t);return e.data=this,e},_[a].prototype.sample=function(n){var r=this._a,t=this._b,e=this._c;return n?_.alter(n,function(){return _[a].sample(r,t,e)}):_[a].sample(r,t,e)},function(n){for(var r=0;r<n.length;r++)!function(o){_[a].prototype[o]=function(n){var r=this._a,t=this._b,e=this._c;return n||0===n||(n=this.data),"number"!=typeof n?_.fn.map.call(n,function(n){return _[a][o](n,r,t,e)}):_[a][o](n,r,t,e)}}(n[r])}("pdf cdf inv".split(" ")),function(n){for(var r=0;r<n.length;r++)!function(n){_[a].prototype[n]=function(){return _[a][n](this._a,this._b,this._c)}}(n[r])}("mean median mode variance".split(" "))}(n[r])}("beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy laplace lognormal noncentralt normal pareto studentt weibull uniform binomial negbin hypgeom poisson triangular tukey arcsine".split(" ")),_.extend(_.beta,{pdf:function(n,r,t){return 1<n||n<0?0:1==r&&1==t?1:r<512&&t<512?A.pow(n,r-1)*A.pow(1-n,t-1)/_.betafn(r,t):A.exp((r-1)*A.log(n)+(t-1)*A.log(1-n)-_.betaln(r,t))},cdf:function(n,r,t){return 1<n||n<0?+(1<n):_.ibeta(n,r,t)},inv:function(n,r,t){return _.ibetainv(n,r,t)},mean:function(n,r){return n/(n+r)},median:function(n,r){return _.ibetainv(.5,n,r)},mode:function(n,r){return(n-1)/(n+r-2)},sample:function(n,r){var t=_.randg(n);return t/(t+_.randg(r))},variance:function(n,r){return n*r/(A.pow(n+r,2)*(n+r+1))}}),_.extend(_.centralF,{pdf:function(n,r,t){var e;return n<0?0:r<=2?0===n&&r<2?1/0:0===n&&2===r?1:1/_.betafn(r/2,t/2)*A.pow(r/t,r/2)*A.pow(n,r/2-1)*A.pow(1+r/t*n,-(r+t)/2):(e=r*n/(t+n*r),r*(t/(t+n*r))/2*_.binomial.pdf((r-2)/2,(r+t-2)/2,e))},cdf:function(n,r,t){return n<0?0:_.ibeta(r*n/(r*n+t),r/2,t/2)},inv:function(n,r,t){return t/(r*(1/_.ibetainv(n,r/2,t/2)-1))},mean:function(n,r){return 2<r?r/(r-2):void 0},mode:function(n,r){return 2<n?r*(n-2)/(n*(r+2)):void 0},sample:function(n,r){return 2*_.randg(n/2)/n/(2*_.randg(r/2)/r)},variance:function(n,r){if(!(r<=4))return 2*r*r*(n+r-2)/(n*(r-2)*(r-2)*(r-4))}}),_.extend(_.cauchy,{pdf:function(n,r,t){return t<0?0:t/(A.pow(n-r,2)+A.pow(t,2))/A.PI},cdf:function(n,r,t){return A.atan((n-r)/t)/A.PI+.5},inv:function(n,r,t){return r+t*A.tan(A.PI*(n-.5))},median:function(n){return n},mode:function(n){return n},sample:function(n,r){return _.randn()*A.sqrt(1/(2*_.randg(.5)))*r+n}}),_.extend(_.chisquare,{pdf:function(n,r){return n<0?0:0===n&&2===r?.5:A.exp((r/2-1)*A.log(n)-n/2-r/2*A.log(2)-_.gammaln(r/2))},cdf:function(n,r){return n<0?0:_.lowRegGamma(r/2,n/2)},inv:function(n,r){return 2*_.gammapinv(n,.5*r)},mean:function(n){return n},median:function(n){return n*A.pow(1-2/(9*n),3)},mode:function(n){return 0<n-2?n-2:0},sample:function(n){return 2*_.randg(n/2)},variance:function(n){return 2*n}}),_.extend(_.exponential,{pdf:function(n,r){return n<0?0:r*A.exp(-r*n)},cdf:function(n,r){return n<0?0:1-A.exp(-r*n)},inv:function(n,r){return-A.log(1-n)/r},mean:function(n){return 1/n},median:function(n){return 1/n*A.log(2)},mode:function(){return 0},sample:function(n){return-1/n*A.log(_._random_fn())},variance:function(n){return A.pow(n,-2)}}),_.extend(_.gamma,{pdf:function(n,r,t){return n<0?0:0===n&&1===r?1/t:A.exp((r-1)*A.log(n)-n/t-_.gammaln(r)-r*A.log(t))},cdf:function(n,r,t){return n<0?0:_.lowRegGamma(r,n/t)},inv:function(n,r,t){return _.gammapinv(n,r)*t},mean:function(n,r){return n*r},mode:function(n,r){if(1<n)return(n-1)*r},sample:function(n,r){return _.randg(n)*r},variance:function(n,r){return n*r*r}}),_.extend(_.invgamma,{pdf:function(n,r,t){return n<=0?0:A.exp(-(r+1)*A.log(n)-t/n-_.gammaln(r)+r*A.log(t))},cdf:function(n,r,t){return n<=0?0:1-_.lowRegGamma(r,t/n)},inv:function(n,r,t){return t/_.gammapinv(1-n,r)},mean:function(n,r){return 1<n?r/(n-1):void 0},mode:function(n,r){return r/(n+1)},sample:function(n,r){return r/_.randg(n)},variance:function(n,r){if(!(n<=2))return r*r/((n-1)*(n-1)*(n-2))}}),_.extend(_.kumaraswamy,{pdf:function(n,r,t){return 0===n&&1===r?t:1===n&&1===t?r:A.exp(A.log(r)+A.log(t)+(r-1)*A.log(n)+(t-1)*A.log(1-A.pow(n,r)))},cdf:function(n,r,t){return n<0?0:1<n?1:1-A.pow(1-A.pow(n,r),t)},inv:function(n,r,t){return A.pow(1-A.pow(1-n,1/t),1/r)},mean:function(n,r){return r*_.gammafn(1+1/n)*_.gammafn(r)/_.gammafn(1+1/n+r)},median:function(n,r){return A.pow(1-A.pow(2,-1/r),1/n)},mode:function(n,r){if(1<=n&&1<=r&&1!==n&&1!==r)return A.pow((n-1)/(n*r-1),1/n)},variance:function(){throw new Error("variance not yet implemented")}}),_.extend(_.lognormal,{pdf:function(n,r,t){return n<=0?0:A.exp(-A.log(n)-.5*A.log(2*A.PI)-A.log(t)-A.pow(A.log(n)-r,2)/(2*t*t))},cdf:function(n,r,t){return n<0?0:.5+.5*_.erf((A.log(n)-r)/A.sqrt(2*t*t))},inv:function(n,r,t){return A.exp(-1.4142135623730951*t*_.erfcinv(2*n)+r)},mean:function(n,r){return A.exp(n+r*r/2)},median:function(n){return A.exp(n)},mode:function(n,r){return A.exp(n-r*r)},sample:function(n,r){return A.exp(_.randn()*r+n)},variance:function(n,r){return(A.exp(r*r)-1)*A.exp(2*n+r*r)}}),_.extend(_.noncentralt,{pdf:function(n,r,t){return A.abs(t)<1e-14?_.studentt.pdf(n,r):A.abs(n)<1e-14?A.exp(_.gammaln((r+1)/2)-t*t/2-.5*A.log(A.PI*r)-_.gammaln(r/2)):r/n*(_.noncentralt.cdf(n*A.sqrt(1+2/r),r+2,t)-_.noncentralt.cdf(n,r,t))},cdf:function(n,r,t){var e=1e-14;if(A.abs(t)<e)return _.studentt.cdf(n,r);var o=!1;n<0&&(o=!0,t=-t);for(var a=_.normal.cdf(-t,0,1),u=1+e,i=u,f=n*n/(n*n+r),c=0,l=A.exp(-t*t/2),s=A.exp(-t*t/2-.5*A.log(2)-_.gammaln(1.5))*t;c<200||e<i||e<u;)i=u,0<c&&(l*=t*t/(2*c),s*=t*t/(2*(c+.5))),a+=.5*(u=l*_.beta.cdf(f,c+.5,r/2)+s*_.beta.cdf(f,c+1,r/2)),c++;return o?1-a:a}}),_.extend(_.normal,{pdf:function(n,r,t){return A.exp(-.5*A.log(2*A.PI)-A.log(t)-A.pow(n-r,2)/(2*t*t))},cdf:function(n,r,t){return.5*(1+_.erf((n-r)/A.sqrt(2*t*t)))},inv:function(n,r,t){return-1.4142135623730951*t*_.erfcinv(2*n)+r},mean:function(n){return n},median:function(n){return n},mode:function(n){return n},sample:function(n,r){return _.randn()*r+n},variance:function(n,r){return r*r}}),_.extend(_.pareto,{pdf:function(n,r,t){return n<r?0:t*A.pow(r,t)/A.pow(n,t+1)},cdf:function(n,r,t){return n<r?0:1-A.pow(r/n,t)},inv:function(n,r,t){return r/A.pow(1-n,1/t)},mean:function(n,r){if(!(r<=1))return r*A.pow(n,r)/(r-1)},median:function(n,r){return n*(r*A.SQRT2)},mode:function(n){return n},variance:function(n,r){if(!(r<=2))return n*n*r/(A.pow(r-1,2)*(r-2))}}),_.extend(_.studentt,{pdf:function(n,r){return r=1e100<r?1e100:r,1/(A.sqrt(r)*_.betafn(.5,r/2))*A.pow(1+n*n/r,-(r+1)/2)},cdf:function(n,r){var t=r/2;return _.ibeta((n+A.sqrt(n*n+r))/(2*A.sqrt(n*n+r)),t,t)},inv:function(n,r){var t=_.ibetainv(2*A.min(n,1-n),.5*r,.5),t=A.sqrt(r*(1-t)/t);return.5<n?t:-t},mean:function(n){return 1<n?0:void 0},median:function(){return 0},mode:function(){return 0},sample:function(n){return _.randn()*A.sqrt(n/(2*_.randg(n/2)))},variance:function(n){return 2<n?n/(n-2):1<n?1/0:void 0}}),_.extend(_.weibull,{pdf:function(n,r,t){return n<0||r<0||t<0?0:t/r*A.pow(n/r,t-1)*A.exp(-A.pow(n/r,t))},cdf:function(n,r,t){return n<0?0:1-A.exp(-A.pow(n/r,t))},inv:function(n,r,t){return r*A.pow(-A.log(1-n),1/t)},mean:function(n,r){return n*_.gammafn(1+1/r)},median:function(n,r){return n*A.pow(A.log(2),1/r)},mode:function(n,r){return r<=1?0:n*A.pow((r-1)/r,1/r)},sample:function(n,r){return n*A.pow(-A.log(_._random_fn()),1/r)},variance:function(n,r){return n*n*_.gammafn(1+2/r)-A.pow(_.weibull.mean(n,r),2)}}),_.extend(_.uniform,{pdf:function(n,r,t){return n<r||t<n?0:1/(t-r)},cdf:function(n,r,t){return n<r?0:n<t?(n-r)/(t-r):1},inv:function(n,r,t){return r+n*(t-r)},mean:function(n,r){return.5*(n+r)},median:function(n,r){return _.mean(n,r)},mode:function(){throw new Error("mode is not yet implemented")},sample:function(n,r){return n/2+r/2+(r/2-n/2)*(2*_._random_fn()-1)},variance:function(n,r){return A.pow(r-n,2)/12}}),_.extend(_.binomial,{pdf:function(n,r,t){return 0===t||1===t?r*t===n?1:0:_.combination(r,n)*A.pow(t,n)*A.pow(1-t,r-n)},cdf:function(n,r,t){var e=1e-10;if(n<0)return 0;if(r<=n)return 1;if(t<0||1<t||r<=0)return NaN;var o=t,a=(n=A.floor(n))+1,u=r-n,i=a+u,f=A.exp(_.gammaln(i)-_.gammaln(u)-_.gammaln(a)+a*A.log(o)+u*A.log(1-o)),c=o<(a+1)/(i+2)?f*d(o,a,u,e):1-f*d(1-o,u,a,e);return A.round(1e10*(1-c))/1e10}}),_.extend(_.negbin,{pdf:function(n,r,t){return n===n>>>0&&(n<0?0:_.combination(n+r-1,r-1)*A.pow(1-t,n)*A.pow(t,r))},cdf:function(n,r,t){var e=0,o=0;if(n<0)return 0;for(;o<=n;o++)e+=_.negbin.pdf(o,r,t);return e}}),_.extend(_.hypgeom,{pdf:function(n,r,t,e){if(n!=n|0)return!1;if(n<0||n<t-(r-e))return 0;if(e<n||t<n)return 0;if(r<2*t)return r<2*e?_.hypgeom.pdf(r-t-e+n,r,r-t,r-e):_.hypgeom.pdf(e-n,r,r-t,e);if(r<2*e)return _.hypgeom.pdf(t-n,r,t,r-e);if(t<e)return _.hypgeom.pdf(n,r,e,t);for(var o=1,a=0,u=0;u<n;u++){for(;1<o&&a<e;)o*=1-t/(r-a),a++;o*=(e-u)*(t-u)/((u+1)*(r-t-e+u+1))}for(;a<e;a++)o*=1-t/(r-a);return A.min(1,A.max(0,o))},cdf:function(n,r,t,e){if(n<0||n<t-(r-e))return 0;if(e<=n||t<=n)return 1;if(r<2*t)return r<2*e?_.hypgeom.cdf(r-t-e+n,r,r-t,r-e):1-_.hypgeom.cdf(e-n-1,r,r-t,e);if(r<2*e)return 1-_.hypgeom.cdf(t-n-1,r,t,r-e);if(t<e)return _.hypgeom.cdf(n,r,e,t);for(var o=1,a=1,u=0,i=0;i<n;i++){for(;1<o&&u<e;){var f=1-t/(r-u);a*=f,o*=f,u++}o+=a*=(e-i)*(t-i)/((i+1)*(r-t-e+i+1))}for(;u<e;u++)o*=1-t/(r-u);return A.min(1,A.max(0,o))}}),_.extend(_.poisson,{pdf:function(n,r){return r<0||n%1!=0||n<0?0:A.pow(r,n)*A.exp(-r)/_.factorial(n)},cdf:function(n,r){var t=[],e=0;if(n<0)return 0;for(;e<=n;e++)t.push(_.poisson.pdf(e,r));return _.sum(t)},mean:function(n){return n},variance:function(n){return n},sampleSmall:function(n){for(var r=1,t=0,e=A.exp(-n);t++,e<(r*=_._random_fn()););return t-1},sampleLarge:function(n){for(var r,t,e,o,a=n,u=A.sqrt(a),i=A.log(a),f=.931+2.53*u,c=.02483*f-.059,l=1.1239+1.1328/(f-3.4),s=.9277-3.6224/(f-2);;){if(t=A.random()-.5,e=A.random(),o=.5-A.abs(t),r=A.floor((2*c/o+f)*t+a+.43),.07<=o&&e<=s)return r;if(!(r<0||o<.013&&o<e)&&A.log(e)+A.log(l)-A.log(c/(o*o)+f)<=r*i-a-_.loggam(r+1))return r}},sample:function(n){return n<10?this.sampleSmall(n):this.sampleLarge(n)}}),_.extend(_.triangular,{pdf:function(n,r,t,e){return t<=r||e<r||t<e?NaN:n<r||t<n?0:n<e?2*(n-r)/((t-r)*(e-r)):n===e?2/(t-r):2*(t-n)/((t-r)*(t-e))},cdf:function(n,r,t,e){return t<=r||e<r||t<e?NaN:n<=r?0:t<=n?1:n<=e?A.pow(n-r,2)/((t-r)*(e-r)):1-A.pow(t-n,2)/((t-r)*(t-e))},inv:function(n,r,t,e){return t<=r||e<r||t<e?NaN:n<=(e-r)/(t-r)?r+(t-r)*A.sqrt(n*((e-r)/(t-r))):r+(t-r)*(1-A.sqrt((1-n)*(1-(e-r)/(t-r))))},mean:function(n,r,t){return(n+r+t)/3},median:function(n,r,t){return t<=(n+r)/2?r-A.sqrt((r-n)*(r-t))/A.sqrt(2):(n+r)/2<t?n+A.sqrt((r-n)*(t-n))/A.sqrt(2):void 0},mode:function(n,r,t){return t},sample:function(n,r,t){var e=_._random_fn();return e<(t-n)/(r-n)?n+A.sqrt(e*(r-n)*(t-n)):r-A.sqrt((1-e)*(r-n)*(r-t))},variance:function(n,r,t){return(n*n+r*r+t*t-n*r-n*t-r*t)/18}}),_.extend(_.arcsine,{pdf:function(n,r,t){return t<=r?NaN:n<=r||t<=n?0:2/A.PI*A.pow(A.pow(t-r,2)-A.pow(2*n-r-t,2),-.5)},cdf:function(n,r,t){return n<r?0:n<t?2/A.PI*A.asin(A.sqrt((n-r)/(t-r))):1},inv:function(n,r,t){return r+(.5-.5*A.cos(A.PI*n))*(t-r)},mean:function(n,r){return r<=n?NaN:(n+r)/2},median:function(n,r){return r<=n?NaN:(n+r)/2},mode:function(){throw new Error("mode is not yet implemented")},sample:function(n,r){return(n+r)/2+(r-n)/2*A.sin(2*A.PI*_.uniform.sample(0,1))},variance:function(n,r){return r<=n?NaN:A.pow(r-n,2)/8}}),_.extend(_.laplace,{pdf:function(n,r,t){return t<=0?0:A.exp(-A.abs(n-r)/t)/(2*t)},cdf:function(n,r,t){return t<=0?0:n<r?.5*A.exp((n-r)/t):1-.5*A.exp(-(n-r)/t)},mean:function(n){return n},median:function(n){return n},mode:function(n){return n},variance:function(n,r){return 2*r*r},sample:function(n,r){var t,e=_._random_fn()-.5;return n-r*((t=e)/A.abs(t))*A.log(1-2*A.abs(e))}}),_.extend(_.tukey,{cdf:function(n,r,t){var e=r,o=[.9894009349916499,.9445750230732326,.8656312023878318,.755404408355003,.6178762444026438,.45801677765722737,.2816035507792589,.09501250983763744],a=[.027152459411754096,.062253523938647894,.09515851168249279,.12462897125553388,.14959598881657674,.16915651939500254,.18260341504492358,.1894506104550685];if(n<=0)return 0;if(t<2||e<2)return NaN;if(!Number.isFinite(n))return 1;if(25e3<t)return w(n,1,e);var u=.5*t,i=u*A.log(t)-t*A.log(2)-_.gammaln(u),f=u-1,c=.25*t,l=t<=100?1:t<=800?.5:t<=5e3?.25:.125;i+=A.log(l);for(var s=0,m=1;m<=50;m++){for(var d=0,p=(2*m-1)*l,g=1;g<=16;g++){var h,v=8<g?(h=g-8-1,i+f*A.log(p+o[h]*l)-(o[h]*l+p)*c):(h=g-1,i+f*A.log(p-o[h]*l)+(o[h]*l-p)*c);-30<=v&&(d+=w(8<g?n*A.sqrt(.5*(o[h]*l+p)):n*A.sqrt(.5*(-o[h]*l+p)),1,e)*a[h]*A.exp(v))}if(1<=m*l&&d<=1e-14)break;s+=d}if(1e-14<d)throw new Error("tukey.cdf failed to converge");return 1<s&&(s=1),s},inv:function(n,r,t){if(t<2||r<2)return NaN;if(n<0||1<n)return NaN;if(0===n)return 0;if(1===n)return 1/0;for(var e=function(n,r,t){var e=.5-.5*n,o=A.sqrt(A.log(1/(e*e))),a=o+((((-453642210148e-16*o-.204231210125)*o-.342242088547)*o-1)*o+.322232421088)/((((.0038560700634*o+.10353775285)*o+.531103462366)*o+.588581570495)*o+.099348462606);t<120&&(a+=(a*a*a+a)/t/4);var u=.8832-.2368*a;return t<120&&(u+=-1.214/t+1.208*a/t),a*(u*A.log(r-1)+1.4142)}(n,r,t),o=0<(f=_.tukey.cdf(e,r,t)-n)?A.max(0,e-1):e+1,a=_.tukey.cdf(o,r,t)-n,u=1;u<50;u++){var i=o-a*(o-e)/(a-f),f=a,e=o;if(i<0&&(i=0,a=-n),a=_.tukey.cdf(i,r,t)-n,o=i,A.abs(o-e)<1e-4)return i}throw new Error("tukey.inv failed to converge")}}),y=m,g=Math,o=Array.prototype.push,r=y.utils.isArray,y.extend({add:function(n,e){return p(e)?(p(e[0])||(e=[e]),y.map(n,function(n,r,t){return n+e[r][t]})):y.map(n,function(n){return n+e})},subtract:function(n,e){return p(e)?(p(e[0])||(e=[e]),y.map(n,function(n,r,t){return n-e[r][t]||0})):y.map(n,function(n){return n-e})},divide:function(n,r){return p(r)?(p(r[0])||(r=[r]),y.multiply(n,y.inv(r))):y.map(n,function(n){return n/r})},multiply:function(n,r){var t,e,o,a,u,i,f,c;if(void 0===n.length&&void 0===r.length)return n*r;if(u=n.length,i=n[0].length,f=y.zeros(u,o=p(r)?r[0].length:i),c=0,p(r)){for(;c<o;c++)for(t=0;t<u;t++){for(e=a=0;e<i;e++)a+=n[t][e]*r[e][c];f[t][c]=a}return 1===u&&1===c?f[0][0]:f}return y.map(n,function(n){return n*r})},outer:function(n,r){return y.multiply(n.map(function(n){return[n]}),[r])},dot:function(n,r){p(n[0])||(n=[n]),p(r[0])||(r=[r]);for(var t,e,o=1===n[0].length&&1!==n.length?y.transpose(n):n,a=1===r[0].length&&1!==r.length?y.transpose(r):r,u=[],i=0,f=o.length,c=o[0].length;i<f;i++){for(u[i]=[],e=t=0;e<c;e++)t+=o[i][e]*a[i][e];u[i]=t}return 1===u.length?u[0]:u},pow:function(n,r){return y.map(n,function(n){return g.pow(n,r)})},exp:function(n){return y.map(n,function(n){return g.exp(n)})},log:function(n){return y.map(n,function(n){return g.log(n)})},abs:function(n){return y.map(n,function(n){return g.abs(n)})},norm:function(n,r){var t=0,e=0;for(isNaN(r)&&(r=2),p(n[0])&&(n=n[0]);e<n.length;e++)t+=g.pow(g.abs(n[e]),r);return g.pow(t,1/r)},angle:function(n,r){return g.acos(y.dot(n,r)/(y.norm(n)*y.norm(r)))},aug:function(n,r){for(var t=[],e=0;e<n.length;e++)t.push(n[e].slice());for(e=0;e<t.length;e++)o.apply(t[e],r[e]);return t},inv:function(n){for(var r,t=n.length,e=n[0].length,o=y.identity(t,e),a=y.gauss_jordan(n,o),u=[],i=0;i<t;i++)for(u[i]=[],r=e;r<a[0].length;r++)u[i][r-e]=a[i][r];return u},det:function(n){var r,t=n.length,e=2*t,o=new Array(e),a=t-1,u=e-1,i=a-t+1,f=u,c=0,l=0;if(2===t)return n[0][0]*n[1][1]-n[0][1]*n[1][0];for(;c<e;c++)o[c]=1;for(c=0;c<t;c++){for(r=0;r<t;r++)o[i<0?i+t:i]*=n[c][r],o[f<t?f+t:f]*=n[c][r],i++,f--;i=--a-t+1,f=--u}for(c=0;c<t;c++)l+=o[c];for(;c<e;c++)l-=o[c];return l},gauss_elimination:function(n,r){for(var t,e,o,a,u=0,i=0,f=n.length,c=n[0].length,l=0,s=[],m=(n=y.aug(n,r))[0].length,u=0;u<f;u++){for(e=n[u][u],a=(i=u)+1;a<c;a++)e<g.abs(n[a][u])&&(e=n[a][u],i=a);if(i!=u)for(a=0;a<m;a++)o=n[u][a],n[u][a]=n[i][a],n[i][a]=o;for(i=u+1;i<f;i++)for(t=n[i][u]/n[u][u],a=u;a<m;a++)n[i][a]=n[i][a]-t*n[u][a]}for(u=f-1;0<=u;u--){for(l=0,i=u+1;i<=f-1;i++)l+=s[i]*n[u][i];s[u]=(n[u][m-1]-l)/n[u][u]}return s},gauss_jordan:function(n,r){for(var t,e=y.aug(n,r),o=e.length,a=e[0].length,u=0,i=0;i<o;i++){for(var f=i,c=i+1;c<o;c++)g.abs(e[c][i])>g.abs(e[f][i])&&(f=c);var l=e[i];for(e[i]=e[f],e[f]=l,c=i+1;c<o;c++)for(u=e[c][i]/e[i][i],t=i;t<a;t++)e[c][t]-=e[i][t]*u}for(i=o-1;0<=i;i--){for(u=e[i][i],c=0;c<i;c++)for(t=a-1;i-1<t;t--)e[c][t]-=e[i][t]*e[c][i]/u;for(e[i][i]/=u,t=o;t<a;t++)e[i][t]/=u}return e},triaUpSolve:function(t,n){var e,o=t[0].length,a=y.zeros(1,o)[0],r=!1;return null!=n[0].length&&(n=n.map(function(n){return n[0]}),r=!0),y.arange(o-1,-1,-1).forEach(function(r){e=y.arange(r+1,o).map(function(n){return a[n]*t[r][n]}),a[r]=(n[r]-y.sum(e))/t[r][r]}),r?a.map(function(n){return[n]}):a},triaLowSolve:function(t,n){var e,r=t[0].length,o=y.zeros(1,r)[0],a=!1;return null!=n[0].length&&(n=n.map(function(n){return n[0]}),a=!0),y.arange(r).forEach(function(r){e=y.arange(r).map(function(n){return t[r][n]*o[n]}),o[r]=(n[r]-y.sum(e))/t[r][r]}),a?o.map(function(n){return[n]}):o},lu:function(e){var n,r=e.length,o=y.identity(r),a=y.zeros(e.length,e[0].length);return y.arange(r).forEach(function(n){a[0][n]=e[0][n]}),y.arange(1,r).forEach(function(t){y.arange(t).forEach(function(r){n=y.arange(r).map(function(n){return o[t][n]*a[n][r]}),o[t][r]=(e[t][r]-y.sum(n))/a[r][r]}),y.arange(t,r).forEach(function(r){n=y.arange(t).map(function(n){return o[t][n]*a[n][r]}),a[t][r]=e[n.length][r]-y.sum(n)})}),[o,a]},cholesky:function(n){var e,r=n.length,o=y.zeros(n.length,n[0].length);return y.arange(r).forEach(function(t){e=y.arange(t).map(function(n){return g.pow(o[t][n],2)}),o[t][t]=g.sqrt(n[t][t]-y.sum(e)),y.arange(t+1,r).forEach(function(r){e=y.arange(t).map(function(n){return o[t][n]*o[r][n]}),o[r][t]=(n[t][r]-y.sum(e))/o[t][t]})}),o},gauss_jacobi:function(n,r,t,e){for(var o,a,u,i,f=0,c=0,l=n.length,s=[],m=[],d=[];f<l;f++)for(s[f]=[],m[f]=[],d[f]=[],c=0;c<l;c++)c<f?(s[f][c]=n[f][c],m[f][c]=d[f][c]=0):f<c?(m[f][c]=n[f][c],s[f][c]=d[f][c]=0):(d[f][c]=n[f][c],s[f][c]=m[f][c]=0);for(u=y.multiply(y.multiply(y.inv(d),y.add(s,m)),-1),a=y.multiply(y.inv(d),r),o=t,i=y.add(y.multiply(u,t),a),f=2;g.abs(y.norm(y.subtract(i,o)))>e;)o=i,i=y.add(y.multiply(u,o),a),f++;return i},gauss_seidel:function(n,r,t,e){for(var o,a,u,i,f,c=0,l=n.length,s=[],m=[],d=[];c<l;c++)for(s[c]=[],m[c]=[],d[c]=[],o=0;o<l;o++)o<c?(s[c][o]=n[c][o],m[c][o]=d[c][o]=0):c<o?(m[c][o]=n[c][o],s[c][o]=d[c][o]=0):(d[c][o]=n[c][o],s[c][o]=m[c][o]=0);for(i=y.multiply(y.multiply(y.inv(y.add(d,s)),m),-1),u=y.multiply(y.inv(y.add(d,s)),r),a=t,f=y.add(y.multiply(i,t),u),c=2;g.abs(y.norm(y.subtract(f,a)))>e;)a=f,f=y.add(y.multiply(i,a),u),c+=1;return f},SOR:function(n,r,t,e,o){for(var a,u,i,f,c,l=0,s=n.length,m=[],d=[],p=[];l<s;l++)for(m[l]=[],d[l]=[],p[l]=[],a=0;a<s;a++)a<l?(m[l][a]=n[l][a],d[l][a]=p[l][a]=0):l<a?(d[l][a]=n[l][a],m[l][a]=p[l][a]=0):(p[l][a]=n[l][a],m[l][a]=d[l][a]=0);for(f=y.multiply(y.inv(y.add(p,y.multiply(m,o))),y.subtract(y.multiply(p,1-o),y.multiply(d,o))),i=y.multiply(y.multiply(y.inv(y.add(p,y.multiply(m,o))),r),o),u=t,c=y.add(y.multiply(f,t),i),l=2;g.abs(y.norm(y.subtract(c,u)))>e;)u=c,c=y.add(y.multiply(f,u),i),l++;return c},householder:function(n){for(var r,t,e,o,a,u=n.length,i=n[0].length,f=0,c=[];f<u-1;f++){for(t=0,a=f+1;a<i;a++)t+=n[a][f]*n[a][f];for(t=(0<n[f+1][f]?-1:1)*g.sqrt(t),e=g.sqrt((t*t-n[f+1][f]*t)/2),(c=y.zeros(u,1))[f+1][0]=(n[f+1][f]-t)/(2*e),o=f+2;o<u;o++)c[o][0]=n[o][f]/(2*e);r=y.subtract(y.identity(u,i),y.multiply(y.multiply(c,y.transpose(c)),2)),n=y.multiply(r,y.multiply(n,r))}return n},QR:(i=y.sum,f=y.arange,function(r){var n,t,e,o=r.length,a=r[0].length,u=y.zeros(a,a);for(r=y.copy(r),t=0;t<a;t++){for(u[t][t]=g.sqrt(i(f(o).map(function(n){return r[n][t]*r[n][t]}))),n=0;n<o;n++)r[n][t]=r[n][t]/u[t][t];for(e=t+1;e<a;e++)for(u[t][e]=i(f(o).map(function(n){return r[n][t]*r[n][e]})),n=0;n<o;n++)r[n][e]=r[n][e]-r[n][t]*u[t][e]}return[r,u]}),lstsq:function(n,r){var t=!1;void 0===r[0].length&&(r=r.map(function(n){return[n]}),t=!0);var i,e,f,o=y.QR(n),a=o[0],u=o[1],c=n[0].length,l=y.slice(a,{col:{end:c}}),s=y.slice(u,{row:{end:c}}),m=(i=s,e=(i=y.copy(i)).length,f=y.identity(e),y.arange(e-1,-1,-1).forEach(function(u){y.sliceAssign(f,{row:u},y.divide(y.slice(f,{row:u}),i[u][u])),y.sliceAssign(i,{row:u},y.divide(y.slice(i,{row:u}),i[u][u])),y.arange(u).forEach(function(n){var r=y.multiply(i[n][u],-1),t=y.slice(i,{row:n}),e=y.multiply(y.slice(i,{row:u}),r);y.sliceAssign(i,{row:n},y.add(t,e));var o=y.slice(f,{row:n}),a=y.multiply(y.slice(f,{row:u}),r);y.sliceAssign(f,{row:n},y.add(o,a))})}),f),d=y.transpose(l);void 0===d[0].length&&(d=[d]);var p=y.multiply(y.multiply(m,d),r);return void 0===p.length&&(p=[[p]]),t?p.map(function(n){return n[0]}):p},jacobi:function(n){for(var r,t,e,o,a,u,i,f=1,c=n.length,l=y.identity(c,c),s=[];1===f;){for(a=n[0][1],o=1,r=e=0;r<c;r++)for(t=0;t<c;t++)r!=t&&a<g.abs(n[r][t])&&(a=g.abs(n[r][t]),e=r,o=t);for(u=n[e][e]===n[o][o]?0<n[e][o]?g.PI/4:-g.PI/4:g.atan(2*n[e][o]/(n[e][e]-n[o][o]))/2,(i=y.identity(c,c))[e][e]=g.cos(u),i[e][o]=-g.sin(u),i[o][e]=g.sin(u),i[o][o]=g.cos(u),l=y.multiply(l,i),n=y.multiply(y.multiply(y.inv(i),n),i),f=0,r=1;r<c;r++)for(t=1;t<c;t++)r!=t&&.001<g.abs(n[r][t])&&(f=1)}for(r=0;r<c;r++)s.push(n[r][r]);return[l,s]},rungekutta:function(n,r,t,e,o,a){var u,i,f;if(2===a)for(;e<=t;)o=o+((u=r*n(e,o))+(i=r*n(e+r,o+u)))/2,e+=r;if(4===a)for(;e<=t;)o=o+((u=r*n(e,o))+2*(i=r*n(e+r/2,o+u/2))+2*(f=r*n(e+r/2,o+i/2))+r*n(e+r,o+f))/6,e+=r;return o},romberg:function(n,r,t,e){for(var o,a,u,i,f,c=0,l=(t-r)/2,s=[],m=[],d=[];c<e/2;){for(f=n(r),u=r,i=0;u<=t;u+=l,i++)s[i]=u;for(o=s.length,u=1;u<o-1;u++)f+=(u%2!=0?4:2)*n(s[u]);f=l/3*(f+n(t)),d[c]=f,l/=2,c++}for(a=d.length,o=1;1!==a;){for(u=0;u<a-1;u++)m[u]=(g.pow(4,o)*d[u+1]-d[u])/(g.pow(4,o)-1);a=m.length,d=m,m=[],o++}return d},richardson:function(n,r,t,e){function o(n,r){for(var t,e=0,o=n.length;e<o;e++)n[e]===r&&(t=e);return t}for(var a,u,i,f,c,l=g.abs(t-n[o(n,t)+1]),s=0,m=[],d=[];l<=e;)a=o(n,t+e),u=o(n,t),m[s]=(r[a]-2*r[u]+r[2*u-a])/(e*e),e/=2,s++;for(f=m.length,i=1;1!=f;){for(c=0;c<f-1;c++)d[c]=(g.pow(4,i)*m[c+1]-m[c])/(g.pow(4,i)-1);f=d.length,m=d,d=[],i++}return m},simpson:function(n,r,t,e){for(var o,a=(t-r)/e,u=n(r),i=[],f=r,c=0,l=1;f<=t;f+=a,c++)i[c]=f;for(o=i.length;l<o-1;l++)u+=(l%2!=0?4:2)*n(i[l]);return a/3*(u+n(t))},hermite:function(n,r,t,e){for(var o,a=n.length,u=0,i=0,f=[],c=[],l=[],s=[];i<a;i++){for(f[i]=1,o=0;o<a;o++)i!=o&&(f[i]*=(e-n[o])/(n[i]-n[o]));for(o=c[i]=0;o<a;o++)i!=o&&(c[i]+=1/(n[i]-n[o]));l[i]=(1-2*(e-n[i])*c[i])*(f[i]*f[i]),s[i]=(e-n[i])*(f[i]*f[i]),u+=l[i]*r[i]+s[i]*t[i]}return u},lagrange:function(n,r,t){for(var e,o,a=0,u=0,i=n.length;u<i;u++){for(o=r[u],e=0;e<i;e++)u!=e&&(o*=(t-n[e])/(n[u]-n[e]));a+=o}return a},cubic_spline:function(n,r,t){for(var e,o,a=n.length,u=0,i=[],f=[],c=[],l=[],s=[],m=[];u<a-1;u++)l[u]=n[u+1]-n[u];for(c[0]=0,u=1;u<a-1;u++)c[u]=3/l[u]*(r[u+1]-r[u])-3/l[u-1]*(r[u]-r[u-1]);for(u=1;u<a-1;u++)i[u]=[],f[u]=[],i[u][u-1]=l[u-1],i[u][u]=2*(l[u-1]+l[u]),i[u][u+1]=l[u],f[u][0]=c[u];for(o=y.multiply(y.inv(i),f),e=0;e<a-1;e++)s[e]=(r[e+1]-r[e])/l[e]-l[e]*(o[e+1][0]+2*o[e][0])/3,m[e]=(o[e+1][0]-o[e][0])/(3*l[e]);for(e=0;e<a&&!(n[e]>t);e++);return r[--e]+(t-n[e])*s[e]+y.sq(t-n[e])*o[e]+(t-n[e])*y.sq(t-n[e])*m[e]},gauss_quadrature:function(){throw new Error("gauss_quadrature not yet implemented")},PCA:function(n){for(var r,t,e,o,a,u,i=n.length,f=n[0].length,c=0,l=[],s=[],m=[],d=[],p=[],g=[],c=0;c<i;c++)l[c]=y.sum(n[c])/f;for(c=0;c<f;c++)for(d[c]=[],r=0;r<i;r++)d[c][r]=n[r][c]-l[r];for(d=y.transpose(d),c=0;c<i;c++)for(p[c]=[],r=0;r<i;r++)p[c][r]=y.dot([d[c]],[d[r]])/(f-1);for(u=(e=y.jacobi(p))[0],s=e[1],g=y.transpose(u),c=0;c<s.length;c++)for(r=c;r<s.length;r++)s[c]<s[r]&&(t=s[c],s[c]=s[r],s[r]=t,o=g[c],g[c]=g[r],g[r]=o);for(a=y.transpose(d),c=0;c<i;c++)for(m[c]=[],r=0;r<a.length;r++)m[c][r]=y.dot([g[c]],[a[r]]);return[n,s,g,m]}}),function(n){for(var r=0;r<n.length;r++)!function(e){y.fn[e]=function(n,r){var t=this;return r?(setTimeout(function(){r.call(t,y.fn[e].call(t,n))},15),this):"number"==typeof y[e](this,n)?y[e](this,n):y(y[e](this,n))}}(n[r])}("add divide multiply subtract dot pow exp log abs norm angle".split(" ")),c=m,l=Math,s=[].slice,u=c.utils.isNumber,t=c.utils.isArray,c.extend({zscore:function(){var n=s.call(arguments);return u(n[1])?(n[0]-n[1])/n[2]:(n[0]-c.mean(n[1]))/c.stdev(n[1],n[2])},ztest:function(){var n,r=s.call(arguments);return t(r[1])?(n=c.zscore(r[0],r[1],r[3]),1===r[2]?c.normal.cdf(-l.abs(n),0,1):2*c.normal.cdf(-l.abs(n),0,1)):2<r.length?(n=c.zscore(r[0],r[1],r[2]),1===r[3]?c.normal.cdf(-l.abs(n),0,1):2*c.normal.cdf(-l.abs(n),0,1)):(n=r[0],1===r[1]?c.normal.cdf(-l.abs(n),0,1):2*c.normal.cdf(-l.abs(n),0,1))}}),c.extend(c.fn,{zscore:function(n,r){return(n-this.mean())/this.stdev(r)},ztest:function(n,r,t){var e=l.abs(this.zscore(n,t));return 1===r?c.normal.cdf(-e,0,1):2*c.normal.cdf(-e,0,1)}}),c.extend({tscore:function(){var n=s.call(arguments);return 4===n.length?(n[0]-n[1])/(n[2]/l.sqrt(n[3])):(n[0]-c.mean(n[1]))/(c.stdev(n[1],!0)/l.sqrt(n[1].length))},ttest:function(){var n,r=s.call(arguments);return 5===r.length?(n=l.abs(c.tscore(r[0],r[1],r[2],r[3])),1===r[4]?c.studentt.cdf(-n,r[3]-1):2*c.studentt.cdf(-n,r[3]-1)):u(r[1])?(n=l.abs(r[0]),1==r[2]?c.studentt.cdf(-n,r[1]-1):2*c.studentt.cdf(-n,r[1]-1)):(n=l.abs(c.tscore(r[0],r[1])),1==r[2]?c.studentt.cdf(-n,r[1].length-1):2*c.studentt.cdf(-n,r[1].length-1))}}),c.extend(c.fn,{tscore:function(n){return(n-this.mean())/(this.stdev(!0)/l.sqrt(this.cols()))},ttest:function(n,r){return 1===r?1-c.studentt.cdf(l.abs(this.tscore(n)),this.cols()-1):2*c.studentt.cdf(-l.abs(this.tscore(n)),this.cols()-1)}}),c.extend({anovafscore:function(){var n,r,t,e,o,a,u,i,f=s.call(arguments);if(1===f.length){for(o=new Array(f[0].length),u=0;u<f[0].length;u++)o[u]=f[0][u];f=o}for(r=new Array,u=0;u<f.length;u++)r=r.concat(f[u]);for(t=c.mean(r),u=n=0;u<f.length;u++)n+=f[u].length*l.pow(c.mean(f[u])-t,2);for(n/=f.length-1,u=a=0;u<f.length;u++)for(e=c.mean(f[u]),i=0;i<f[u].length;i++)a+=l.pow(f[u][i]-e,2);return n/(a/=r.length-f.length)},anovaftest:function(){var n,r=s.call(arguments);if(u(r[0]))return 1-c.centralF.cdf(r[0],r[1],r[2]);for(var t=c.anovafscore(r),e=r.length-1,o=0,a=0;a<r.length;a++)o+=r[a].length;return n=o-e-1,1-c.centralF.cdf(t,e,n)},ftest:function(n,r,t){return 1-c.centralF.cdf(n,r,t)}}),c.extend(c.fn,{anovafscore:function(){return c.anovafscore(this.toArray())},anovaftes:function(){for(var n=0,r=0;r<this.length;r++)n+=this[r].length;return c.ftest(this.anovafscore(),this.length-1,n-this.length)}}),c.extend({qscore:function(){var n,r,t,e,o=s.call(arguments),a=u(o[0])?(n=o[0],r=o[1],t=o[2],e=o[3],o[4]):(n=c.mean(o[0]),r=c.mean(o[1]),t=o[0].length,e=o[1].length,o[2]);return l.abs(n-r)/(a*l.sqrt((1/t+1/e)/2))},qtest:function(){var n,r=s.call(arguments),t=(r=3===r.length?(n=r[0],r.slice(1)):7===r.length?(n=c.qscore(r[0],r[1],r[2],r[3],r[4]),r.slice(5)):(n=c.qscore(r[0],r[1],r[2]),r.slice(3)))[0],e=r[1];return 1-c.tukey.cdf(n,e,t-e)},tukeyhsd:function(n){for(var r=c.pooledstdev(n),t=n.map(function(n){return c.mean(n)}),e=n.reduce(function(n,r){return n+r.length},0),o=[],a=0;a<n.length;++a)for(var u=a+1;u<n.length;++u){var i=c.qtest(t[a],t[u],n[a].length,n[u].length,r,e,n.length);o.push([[a,u],i])}return o}}),c.extend({normalci:function(){var n=s.call(arguments),r=new Array(2),t=4===n.length?l.abs(c.normal.inv(n[1]/2,0,1)*n[2]/l.sqrt(n[3])):l.abs(c.normal.inv(n[1]/2,0,1)*c.stdev(n[2])/l.sqrt(n[2].length));return r[0]=n[0]-t,r[1]=n[0]+t,r},tci:function(){var n=s.call(arguments),r=new Array(2),t=4===n.length?l.abs(c.studentt.inv(n[1]/2,n[3]-1)*n[2]/l.sqrt(n[3])):l.abs(c.studentt.inv(n[1]/2,n[2].length-1)*c.stdev(n[2],!0)/l.sqrt(n[2].length));return r[0]=n[0]-t,r[1]=n[0]+t,r},significant:function(n,r){return n<r}}),c.extend(c.fn,{normalci:function(n,r){return c.normalci(n,r,this.toArray())},tci:function(n,r){return c.tci(n,r,this.toArray())}}),c.extend(c.fn,{oneSidedDifferenceOfProportions:function(n,r,t,e){var o=a(n,r,t,e);return c.ztest(o,1)},twoSidedDifferenceOfProportions:function(n,r,t,e){var o=a(n,r,t,e);return c.ztest(o,2)}}),m.models={ols:function(n,r){var t,e,o,a,u,i=b(n,r),f=x(i),c={F_statistic:u=(t=i).R2/t.df_model/((1-t.R2)/t.df_resid),pvalue:1-(e=u,o=t.df_model,a=t.df_resid,m.beta.cdf(e/(a/o+e),o/2,a/2))},l=1-(1-i.R2)*((i.nobs-1)/i.df_resid);return i.t=f,i.f=c,i.adjust_R2=l,i}},m.extend({buildxmatrix:function(){for(var n=new Array(arguments.length),r=0;r<arguments.length;r++){n[r]=[1].concat(arguments[r])}return m(n)},builddxmatrix:function(n){for(var r=new Array(n.length),t=0;t<n.length;t++){r[t]=[1].concat(n[t])}return m(r)},buildjxmatrix:function(n){for(var r=new Array(n.length),t=0;t<n.length;t++)r[t]=n[t];return m.builddxmatrix(r)},buildymatrix:function(n){return m(n).transpose()},buildjymatrix:function(n){return n.transpose()},matrixmult:function(n,r){var t,e,o,a,u;if(n.cols()==r.rows()){if(1<r.rows()){for(a=[],t=0;t<n.rows();t++)for(a[t]=[],e=0;e<r.cols();e++){for(o=u=0;o<n.cols();o++)u+=n.toArray()[t][o]*r.toArray()[o][e];a[t][e]=u}return m(a)}for(a=[],t=0;t<n.rows();t++)for(a[t]=[],e=0;e<r.cols();e++){for(o=u=0;o<n.cols();o++)u+=n.toArray()[t][o]*r.toArray()[e];a[t][e]=u}return m(a)}},regress:function(n,r){var t=m.xtranspxinv(n),e=n.transpose(),o=m.matrixmult(m(t),e);return m.matrixmult(o,r)},regresst:function(n,r,t){var e=m.regress(n,r),o={anova:{}},a=m.jMatYBar(n,e);o.yBar=a;var u=r.mean();o.anova.residuals=m.residuals(r,a),o.anova.ssr=m.ssr(a,u),o.anova.msr=o.anova.ssr/(n[0].length-1),o.anova.sse=m.sse(r,a),o.anova.mse=o.anova.sse/(r.length-(n[0].length-1)-1),o.anova.sst=m.sst(r,u),o.anova.mst=o.anova.sst/(r.length-1),o.anova.r2=1-o.anova.sse/o.anova.sst,o.anova.r2<0&&(o.anova.r2=0),o.anova.fratio=o.anova.msr/o.anova.mse,o.anova.pvalue=m.anovaftest(o.anova.fratio,n[0].length-1,r.length-(n[0].length-1)-1),o.anova.rmse=Math.sqrt(o.anova.mse),o.anova.r2adj=1-o.anova.mse/o.anova.mst,o.anova.r2adj<0&&(o.anova.r2adj=0),o.stats=new Array(n[0].length);for(var i,f,c,l=m.xtranspxinv(n),s=0;s<e.length;s++)i=Math.sqrt(o.anova.mse*Math.abs(l[s][s])),f=Math.abs(e[s]/i),c=m.ttest(f,r.length-n[0].length-1,t),o.stats[s]=[e[s],i,f,c];return o.regress=e,o},xtranspx:function(n){return m.matrixmult(n.transpose(),n)},xtranspxinv:function(n){var r=m.matrixmult(n.transpose(),n);return m.inv(r)},jMatYBar:function(n,r){var t=m.matrixmult(n,r);return new m(t)},residuals:function(n,r){return m.matrixsubtract(n,r)},ssr:function(n,r){for(var t=0,e=0;e<n.length;e++)t+=Math.pow(n[e]-r,2);return t},sse:function(n,r){for(var t=0,e=0;e<n.length;e++)t+=Math.pow(n[e]-r[e],2);return t},sst:function(n,r){for(var t=0,e=0;e<n.length;e++)t+=Math.pow(n[e]-r,2);return t},matrixsubtract:function(n,r){for(var t=new Array(n.length),e=0;e<n.length;e++){t[e]=new Array(n[e].length);for(var o=0;o<n[e].length;o++)t[e][o]=n[e][o]-r[e][o]}return m(t)}}),m.jStat=m},"object"===(void 0===t?"undefined":e(t))?r.exports=o():(void 0).jStat=o()},{}],2:[function(n,r,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return o.default}});var e,o=(e=n("./sdt-math"))&&e.__esModule?e:{default:e}},{"./sdt-math":3}],3:[function(n,r,t){"use strict";function u(n){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n})(n)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=function(n){if(n&&n.__esModule)return n;if(null===n||"object"!==u(n)&&"function"!=typeof n)return{default:n};var r=i();if(r&&r.has(n))return r.get(n);var t={},e=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in n){var a;Object.prototype.hasOwnProperty.call(n,o)&&((a=e?Object.getOwnPropertyDescriptor(n,o):null)&&(a.get||a.set)?Object.defineProperty(t,o,a):t[o]=n[o])}t.default=n,r&&r.set(n,t);return t}(n("jstat"));function i(){if("function"!=typeof WeakMap)return null;var n=new WeakMap;return i=function(){return n},n}function a(n,r){for(var t=0;t<r.length;t++){var e=r[t];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(n,e.key,e)}}var e=function(){function n(){!function(n,r){if(!(n instanceof r))throw new TypeError("Cannot call a class as a function")}(this,n)}var r,t,e;return r=n,e=[{key:"hM2Hr",value:function(n,r){return 0===n&&0===r?0:n/(n+r)}},{key:"faCr2Far",value:function(n,r){return 0===n&&0===r?0:n/(n+r)}},{key:"hMFaCr2Acc",value:function(n,r,t,e){return 0===n&&0===r&&0===t&&0===e?0:(n+e)/(n+r+t+e)}},{key:"hrFar2Acc",value:function(n,r){return(n+(1-r))/2}},{key:"hFa2Ppv",value:function(n,r){return 0===n&&0===r?0:n/(n+r)}},{key:"mCr2Fomr",value:function(n,r){return 0===n&&0===r?0:n/(n+r)}},{key:"hrFar2D",value:function(n,r,t){var e=2<arguments.length&&void 0!==t?t:1;return 1===e?o.normal.inv(n,0,1)-o.normal.inv(r,0,1):Math.sqrt(2/(e*e+1))*(e*o.normal.inv(n,0,1)-o.normal.inv(r,0,1))}},{key:"hrFar2C",value:function(n,r,t){var e=2<arguments.length&&void 0!==t?t:1;return 1===e?-(o.normal.inv(n,0,1)+o.normal.inv(r,0,1))/2:Math.sqrt(2/(e*e+1))*(e/(e+1))*-(o.normal.inv(n,0,1)+o.normal.inv(r,0,1))}},{key:"dC2Hr",value:function(n,r,t){var e=2<arguments.length&&void 0!==t?t:1;return 1===e?o.normal.cdf(n/2-r,0,1):o.normal.cdf(Math.sqrt((e*e+1)/2)*(n/(1+e)-r/e),0,1)}},{key:"dC2Far",value:function(n,r,t){var e=2<arguments.length&&void 0!==t?t:1;return 1===e?o.normal.cdf(-(n/2+r),0,1):o.normal.cdf(Math.sqrt((e*e+1)/2)*-(n/(1+e)+r),0,1)}},{key:"dFar2Hr",value:function(n,r,t){var e=2<arguments.length&&void 0!==t?t:1;return 1===e?o.normal.cdf(n+o.normal.inv(r,0,1),0,1):o.normal.cdf((Math.sqrt((e*e+1)/2)*n+o.normal.inv(r,0,1))/e,0,1)}},{key:"cFar2Hr",value:function(n,r,t){var e=2<arguments.length&&void 0!==t?t:1;return 1===e?o.normal.cdf(-2*n-o.normal.inv(r,0,1),0,1):o.normal.cdf(-Math.sqrt((e*e+1)/2)*((e+1)/e)*n-o.normal.inv(r,0,1),0,1)}},{key:"d2MuN",value:function(n,r){var t=1<arguments.length&&void 0!==r?r:1;return 1===t?-n/2:-Math.sqrt((t*t+1)/2)*(1/(t+1))*n}},{key:"muN2D",value:function(n,r){var t=1<arguments.length&&void 0!==r?r:1;return 1===t?-2*n:-Math.sqrt(2/(t*t+1))*(t+1)*n}},{key:"d2MuS",value:function(n,r){var t=1<arguments.length&&void 0!==r?r:1;return 1===t?n/2:Math.sqrt((t*t+1)/2)*(t/(t+1))*n}},{key:"muS2D",value:function(n,r){var t=1<arguments.length&&void 0!==r?r:1;return 1===t?2*n:Math.sqrt(2/(t*t+1))*((t+1)/t)*n}},{key:"c2L",value:function(n,r){var t=1<arguments.length&&void 0!==r?r:1;return 1===t?n:Math.sqrt((t*t+1)/2)*n}},{key:"l2C",value:function(n,r){var t=1<arguments.length&&void 0!==r?r:1;return 1===t?n:Math.sqrt(2/(t*t+1))*n}},{key:"s2H",value:function(n){return 1/((0<arguments.length&&void 0!==n?n:1)*Math.sqrt(2*Math.PI))}},{key:"h2S",value:function(n){return 1/(n*Math.sqrt(2*Math.PI))}},{key:"hr2Zhr",value:function(n){return o.normal.inv(n,0,1)}},{key:"far2Zfar",value:function(n){return o.normal.inv(n,0,1)}},{key:"zhr2Hr",value:function(n){return o.normal.cdf(n,0,1)}},{key:"zfar2Far",value:function(n){return o.normal.cdf(n,0,1)}}],(t=null)&&a(r.prototype,t),e&&a(r,e),n}();t.default=e},{jstat:1}]},{},[2])(2)});
//# sourceMappingURL=index.js.map
